{
  "section_index": 520,
  "section_id": "5.2.26.1.23",
  "title": "5.2.26.1.23 Controller Data Queue (Feature Identifier 21h)",
  "level": 5,
  "pages": {
    "start": 445,
    "end": 446,
    "count": 2
  },
  "content": {
    "text": "This Feature allows a host to update the status of the head pointer of a Controller Data Queue (CDQ) and\nspecify the configuration of a Controller Data Queue Tail event. The CDQ is specified by the Controller\nData Queue Identifier (CDQID) field in Command Dword 11 (refer to Figure 443).\nThe Head Pointer field specifies the current slot of the head pointer in the queue (refer to section 8.1.7)\nThe controller uses this value to determine if CDQ entries have been freed by the host.\nIf the Enable Tail Pointer Trigger (ETPT) bit is set to ‘1’, then when the slot specified by the Tail Pointer\nTrigger (TPT) field for the specified CDQ is posted with an entry, the controller shall generate a Controller\nData Queue Tail Pointer event to the host (refer to section 8.1.7).\nIf the Set Features command is successful and there is a pending Controller Data Queue Tail Pointer event\nfor the specified Controller Data Queue specified by the CDQID field, then the controller shall clear that\npending event.\nA controller should report Controller Data Queue Tail Pointer events in the order of occurrence to avoid\nreporting the same Controller Data Queue when a Controller Data Queue Tail Pointer event for that\nController Data Queue is being repeatedly triggered.\nIf the Enable Tail Pointer Trigger (ETPT) bit is set to ‘1’ in the current value of this Feature (refer to section\n4.4) and the controller processes a Set Features command for this Feature that specifies:\n•\nthe Enable Tail Pointer Trigger (ETPT) bit set to ‘1’; and\n•\na slot in the Tail Pointer Trigger (TPT) field,\nthen prior to posting the completion for that Set Features command, the controller may post an entry into\nthe specified CDQ in the slot specified by the value of the TPT field that had been set prior to processing\nthat Set Features command. To detect this condition, after receiving the completion of that Set Features\ncommand, a host should examine the CDQ to determine if the requested tail pointer trigger has already\noccurred. If the requested tail pointer trigger has occurred, then a subsequent Set Features command\nshould be submitted by the host to disable the Tail Pointer Trigger event or request a different tail pointer\ntrigger.\nIf a Get Features command is submitted for this Feature, the attributes described in Figure 443 are returned\nin Dword 0 of the completion queue entry and the attributes described in Figure 447 are returned in the\ndata buffer for that command.\nIf the CDQ is empty (refer to section 3.3.1.4) and the Head Pointer field specifies a value that is not the\nsame value as the current value, then the controller shall abort the command with a status code of Invalid\nField in Command.\nIf the CDQ is not empty and the Head Pointer field specifies a slot not associated with an entry that was\nposted by the controller within the specified CDQ, then the controller shall abort the command with a status\ncode of Invalid Field in Command.\nIf the Enable Tail Pointer Trigger bit is set to ‘1’ and the Tail Pointer Trigger field specifies a slot not\nassociated with an entry within the specified CDQ, then the controller shall abort the command with a\nstatus code of Invalid Field in Command.\nIf the value in the Controller Data Queue Identifier field specifies a CDQ that does not exist in the controller\nprocessing the command, then the controller shall abort the command with a status code of Invalid\nController Data Queue.",
    "tables": [
      {
        "id": "table_445_737",
        "page": 445,
        "bbox": [
          115.0,
          737.0,
          881.0,
          905.0
        ],
        "table_md": "| Personality Identifier | Definition | Uses the data buffer¹ | Reference Section |\n| :--- | :--- | :--- | :--- |\n| 00h | Manufacturing Default Personality | N | 5.2.26.1.24.2 |"
      },
      {
        "id": "table_446_128",
        "page": 446,
        "bbox": [
          115.0,
          128.0,
          881.0,
          159.0
        ],
        "table_md": "(Continuation of Untitled Table - see first part)"
      },
      {
        "id": "table_446_204",
        "page": 446,
        "bbox": [
          115.0,
          204.0,
          881.0,
          234.0
        ],
        "table_md": "(Continuation of Untitled Table - see first part)"
      },
      {
        "id": "table_446_280",
        "page": 446,
        "bbox": [
          115.0,
          280.0,
          881.0,
          365.0
        ],
        "table_md": "(Continuation of Untitled Table - see first part)"
      },
      {
        "id": "table_446_614",
        "page": 446,
        "bbox": [
          115.0,
          614.0,
          881.0,
          707.0
        ],
        "table_md": "(Continuation of Untitled Table - see first part)"
      }
    ],
    "figures": []
  },
  "statistics": {
    "table_count": 5,
    "figure_count": 0
  }
}