{
  "section_index": 908,
  "section_id": "8.3.5.5.2",
  "title": "8.3.5.5.2 DH-HMAC-CHAP Authentication Protocol Descriptor",
  "level": 5,
  "pages": {
    "start": 748,
    "end": 750,
    "count": 3
  },
  "content": {
    "text": "The authentication protocol descriptor for DH-HMAC-CHAP (refer to section 8.3.5.4.1) is shown in Figure\n797.\nThe one-way hash functions used by DH-HMAC-CHAP are shown in Figure 798.\nThe SHA-256 hash function shall be supported. Use of the SHA-256 hash function may be prohibited by\nthe requirements of security policies that are not defined by NVM Express (e.g., CNSA 1.0 requires use of\nSHA-384).\nUpon receiving an AUTH_Negotiate message, if the HashIDList proposed by the host does not satisfy the\nsecurity requirements of the controller (e.g., the host proposed SHA-256, but the controller’s security policy\nrequires a SHA-384 hash), then the controller shall:\n•\nreply to the AUTH_Negotiate message with an AUTH_Failure1 message having reason code\n‘Authentication failure’ and reason code explanation ‘Hash function not usable’; and\n•\ndisconnect the NVMe over Fabrics connection upon transmitting the AUTH_Failure1 message.\nThe Diffie-Hellman (DH) groups used by DH-HMAC-CHAP are shown in Figure 799.\nThe 00h identifier indicates that no Diffie-Hellman exchange is performed, which reduces the DH-HMAC-\nCHAP protocol to the HMAC-CHAP protocol. The 00h identifier shall not be proposed in an\nAUTH_Negotiate message that requests secure channel concatenation (i.e., with the SC_C field set to a\nnon-zero value).\nThe 2048-bit DH group and the 3072-bit DH group shall be supported. A mechanism shall be provided to\ndisable (i.e., prohibit) use of the 2048-bit DH group. Use of the 2048-bit DH group may be prohibited by the\nrequirements of security policies that are not defined by NVM Express (e.g., CNSA 1.0 requires use of a\n3072-bit or larger DH group).\nUpon receiving an AUTH_Negotiate message, if the DHgIDList proposed by the host:\n•\ndoes not satisfy the security requirements of the controller (e.g., the host proposed only the NULL\nDH group, but the controller’s security policy requires a DH group whose size is 3072-bit or larger);\nor\n•\ncontains the NULL DH group (i.e., identifier 00h) and the AUTH_Negotiate message is requesting\nsecure channel concatenation (i.e., with the SC_C field set to a non-zero value),\nthen the controller shall:\n•\nreply to the AUTH_Negotiate message with an AUTH_Failure1 message having reason code\n‘Authentication failure’ and reason code explanation ‘DH group not usable’; and\n•\ndisconnect the NVMe over Fabrics connection upon transmitting the AUTH_Failure1 message.",
    "tables": [
      {
        "id": "table_749_128",
        "page": 749,
        "bbox": [
          114.0,
          128.0,
          883.0,
          285.0
        ],
        "table_md": "| Identifier | Hash Function | Hash Length (bytes) | Hash Block Size¹ (bytes) | Reference |\n| :--- | :--- | :--- | :--- | :--- |\n| FEh | Vendor specific | | | |\n| h | Reserved | | | |\n| | | | | |\n| | | | | |\n| | | | | |\n| | | | | |\n| | |"
      },
      {
        "id": "table_749_349",
        "page": 749,
        "bbox": [
          114.0,
          349.0,
          883.0,
          494.0
        ],
        "table_md": "(Continuation of Untitled Table - see first part)"
      },
      {
        "id": "table_749_714",
        "page": 749,
        "bbox": [
          209.0,
          714.0,
          787.0,
          856.0
        ],
        "table_md": "(Continuation of Untitled Table - see first part)"
      }
    ],
    "figures": []
  },
  "statistics": {
    "table_count": 3,
    "figure_count": 0
  }
}