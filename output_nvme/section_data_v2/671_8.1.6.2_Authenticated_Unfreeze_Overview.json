{
  "section_index": 671,
  "section_id": "8.1.6.2",
  "title": "8.1.6.2 Authenticated Unfreeze Overview",
  "level": 4,
  "pages": {
    "start": 562,
    "end": 564,
    "count": 3
  },
  "content": {
    "text": "Security Send and Security Receive commands, that specify CDP Authentication, are used to submit\nauthenticated unfreeze operations to the controller and to retrieve the result of that request.\nSecurity Send and Security Receive commands populate the command data buffer with the data frames as\ndefined in this section.\nA controller that supports version N of the data frames defined in Figure 630 and Figure 631:\na) shall not generate an error for any value in the Request Data Frame Version field as a result of\nparsing a data frame with a different version than the version of the Request Data Frame data\nstructure supported by the NVM subsystem (e.g., the controller shall not fail a command due to a\nversion mismatch);\nb) shall process the data frames as defined by version N of these data frames regardless of the value\nin the Request Data Frame Version field;\nc) shall ignore non-zero values in fields that are reserved in version N of these data frames; and\nd) shall not perform any functionality related to these data frames that are not defined by version N of\nthese data frames.\nFor example, a controller, supporting version N of any request data frames that receives version N-1 of\nthese data frames from the host, processes the data frames provided for version N as described in this\nsection. A controller, supporting version N of the CDP Request Data Frame and CDP Response Data\nFrame that receives version N+1 of these data frames from the host, processes the provided data frames\nfor version N as described in this section.\nA host is able to unfreeze a single personality (refer to section 8.1.6.2.2) that supports an authenticated\nunfreeze method (refer to the Authenticated Unfreeze Support (AUS) field in Figure 285) by submitting a\nSecurity Send command requesting to unfreeze that personality (i.e., by setting the PERID field in the\nRequest Data (REQD) field in the CDP Request Data Frame data structure (refer to Figure 630) to a\nsupported PERID (refer to Figure 447)).\nA host is able to unfreeze all personalities that support a given authenticated unfreeze method by submitting\na Security Send command requesting to unfreeze all personalities that support that authentication method\nby setting the PERID field in the REQD field in the CDP Request Data Frame data structure to FFh and\nsetting the CDP Authentication Algorithm Method Identifier (CDPAMI) field in the CDP Unfreeze Request\nData Frame to the value of that authentication method (refer to 8.1.6.2.1).\nAn authentication command sequence consists of one or more Security Send and Security Receive\ncommands specifying the NVMe Security Protocol and using CDP Authentication (refer to section 5.2.24.3).\nThe concurrent processing of an independent authentication command sequence shall be supported for\neach Admin Submission Queue and Management Endpoint (refer to the NVM Express Management\nInterface Specification).\nIf a Security Send command is processed requesting to unfreeze a personality that specifies an\nauthentication method that is not supported by that personality (refer to the CDPALG field in Figure 328),\nthen the controller returns a successful completion for that Security Send command, and the personality\nremains frozen. A controller processing a Security Receive command following that Security Send\ncommand in this sequence shall return a:\n•\nsuccessful completion for the most recent successfully processed Security Receive command; and\n•\nCDP Response Data Frame, as defined in Figure 631, containing a Response Message Type with\na value of 04h (i.e., Authentication Method Not Supported) and the corresponding Response Data.\nIt is not an error to attempt to unfreeze a personality:\n•\nthat is unfrozen; or\n•\nfor an unsupported Personality Identifier.\nSecurity Send and Security Receive commands specifying CDP Authentication (i.e., a SPSP value of\n0002h) do not use the NSID field and the NSID field shall be ignored by the controller.\nA host is able to retrieve the random nonce by issuing a Security Send command that contains a CDP\nRequest Data Frame as described in section 8.1.6.3.2 and subsequently submitting a Security Receive\ncommand. The random nonce data returned by the controller is described in Figure 639.\nFigure 630 defines all common fields for all request operations. The Request Data for each CDP Request\nand Response Message Type (refer to Figure 629) is defined in section 8.1.6.2.1.\nFigure 631 defines all common fields for responses to all request operations. Specific response data is\ndefined in section 8.1.6.2.1.",
    "tables": [
      {
        "id": "table_563_598",
        "page": 563,
        "bbox": [
          115.0,
          598.0,
          883.0,
          804.0
        ],
        "table_md": "| | | |\n| :--- | :--- | :--- |\n| | **Response Data Frame Version (RESPDFV):** This field indicates the version of this data frame that includes the header and the payload. This field shall be cleared to 0h. | |\n| | **Data Frame Header Length (DFHL):** This field indicates the length in bytes of this header. This field shall be set to 4h. | |\n| | **Response Data Frame Size (RESPDFS):** This field indicates the size of this data frame structure in bytes including the header and common payload. This field shall be set to 07h. | |\n| | **Request Common Payload** | |\n| | **CDP Response Message Type (CDPRMT):** This field indicates the CDP response message type. This field shall be set to the Response Message Type value corresponding to this operation (refer to Figure 629). | |\n| | **Result Code (RC):** This field indicates the result code. This field shall be set to the Result Code value of the most recent Security Send command that returned a successful completion since the last Controller Level Reset of the controller that processed the corresponding request. | |\n| | | **Bits** | **Description** |\n| | | | **Result Code:** This field indicates the operation status. Valid operation status values are listed below. |\n| | | | **Value** | **Definition** |\n| | | | 00h | Operation Successful |\n| | | | 01h | General Failure |\n| | | | 02h | Authentication Failure (e.g., credential comparison not matching) |\n| | | | 03h | DHK Not Programmed |\n| | | | 04h | Authentication Method Not Supported |\n| | | | 05h to FFh | Reserved |\n| | **Response Data Size (RESPDS):** This field indicates the length in bytes of the Response Data (RESPD) field. | |\n| | **CDP Request Data** | |\n| | **Response Data (RESPD):** This field contains CDP Response Data, if any (refer to section 8.1.6.2.1). | |\n| | **CDP Request and Response Data** | |\n| | This section specifies the contents of the Request Data field for CDP Request Message Types. | |\n| | **8.1.1 CDP Programmable Key Authentication Unfreeze Data** | |\n| | **8.1.1.1 CDP Programmable Key Authentication Unfreeze Request Data** | |\n| | Section 8.1.1.1.32 specifies the Request Data for a Personality Unfreeze Request operation using Programmable Authentication (refer to the AUS field in Figure 285). | |"
      },
      {
        "id": "table_564_127",
        "page": 564,
        "bbox": [
          114.0,
          127.0,
          881.0,
          552.0
        ],
        "table_md": "(Continuation of Untitled Table - see first part)"
      }
    ],
    "figures": []
  },
  "statistics": {
    "table_count": 2,
    "figure_count": 0
  }
}