{
  "section_index": 920,
  "section_id": "8.3.5.6.2",
  "title": "8.3.5.6.2 AVE Connections",
  "level": 5,
  "pages": {
    "start": 763,
    "end": 763,
    "count": 1
  },
  "content": {
    "text": "An NVMe entity (i.e., a host or a controller) connection with a DH-HMAC-CHAP AVE shall use TLS version\n1.3 (refer to RFC 8446) with pre-shared key (PSK) authentication, as specified for NVMe/TCP (refer to the\nNVMe over TCP Transport Specification).\nIn order to establish a TLS connection with an AVE, an NVMe entity requires a PSK shared between that\nentity and the AVE (i.e., PSKea) for authentication of the TLS connection. PSKea shall be either derived from\nthe DH-HMAC-CHAP secret, if the DH-HMAC-CHAP secret representation specifies a hash function (refer\nto section 8.3.5.5.8), or provisioned on the NVMe entity through a configured PSK, as specified for\nNVMe/TCP.\nDerivation of PSKea from a DH-HMAC-CHAP secret shall use the HKDF-Extract and HKDF-Expand-Label\noperations (refer to RFC 5869 and RFC 8446) in the following order:\n1.\nPRK = HKDF-Extract(0, DH-HMAC-CHAP secret); and\n2.\nPSKea = HKDF-Expand-Label(PRK, “A-V-Entity” || NQNAVE, NQNe, Length(DH-HMAC-CHAP\nsecret)),\nwhere NQNAVE is the NQN of the AVE and NQNe is the NQN of the NVMe entity. The hash function used\nwith HKDF shall be the one specified in the DH-HMAC-CHAP secret representation (refer to section\n8.3.5.5.8). This transform requires that the NVMe entity knows NQNAVE.\nDerivation of PSKea from a DH-HMAC-CHAP secret is not possible if the DH-HMAC-CHAP secret\nrepresentation does not specify a hash function. In this case PSKea shall be provisioned on the NVMe entity\nthrough a configured PSK, as specified for NVMe/TCP, and that configured PSK should be different than\nthe DH-HMAC-CHAP secret for that entity.\nDerivation of PSKea from a configured PSK shall use the HKDF-Extract and HKDF-Expand-Label operations\nin the following order:\n1.\nPRK = HKDF-Extract(0, Configured PSK); and\n2.\nPSKea = HKDF-Expand-Label(PRK, “A-V-Entity” || NQNAVE, NQNe, Length(Configured PSK)),\nwhere NQNAVE is the NQN of the AVE and NQNe is the NQN of the NVMe entity. The hash function used\nwith HKDF shall be the one specified in the PSK interchange format (refer to the NVMe over TCP Transport\nSpecification). If no hash function is specified in the PSK interchange format, then the configured PSK shall\nbe used as PSKea. This transform requires that the NVMe entity knows NQNAVE.\nThe TLS connection with the AVE shall be performed as specified in the TLS PSK and PSK Identity\nDerivation section of the NVMe over TCP Transport Specification, with PSKea used as the Retained PSK,\nNQNe used as the host NQN, and NQNAVE used as the controller NQN. Mandatory and recommended\ncipher suites for this TLS connection are specified in the Mandatory and Recommended Cipher Suites\nsection of the NVMe over TCP Transport Specification. This TLS connection may be used for multiple\nauthentication verifications. An NVMe entity may terminate this TLS connection and re-establish it as\nrequired. An AVE may terminate this TLS connection after some period of inactivity (e.g., 10 minutes). An\nNVMe entity may avoid termination of this TLS connection by using the TLS heartbeat extension (refer to\nRFC 6520).",
    "tables": [],
    "figures": []
  },
  "statistics": {
    "table_count": 0,
    "figure_count": 0
  }
}