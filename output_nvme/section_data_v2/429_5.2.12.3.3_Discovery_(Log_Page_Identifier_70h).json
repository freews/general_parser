{
  "section_index": 429,
  "section_id": "5.2.12.3.3",
  "title": "5.2.12.3.3 Discovery (Log Page Identifier 70h)",
  "level": 5,
  "pages": {
    "start": 330,
    "end": 336,
    "count": 7
  },
  "content": {
    "text": "The Discovery log page shall only be supported by Discovery controllers. The Discovery log page shall not\nbe supported by controllers that expose namespaces for NVMe over PCIe or NVMe over Fabrics. The\nDiscovery log page provides an inventory of NVM subsystems with which a host may attempt to form an\nassociation. Depending on the parameters specified in a Get Log Page command, the Discovery log page\nmay contain entries for:\n•\nall known NVM subsystems; or\n•\na subset of entries specific to the host or Discovery controller requesting the log page.\nThe Discovery log page is persistent across power cycles.\nFigure 308 specifies the format for the LID Specific Parameter field in the Supported Log Pages log page\n(refer to section 5.2.12.1.1) for the Discovery log page.\nIf a Discovery controller supports returning Extended Discovery Log Page Entries (i.e., the Extended\nDiscovery Log Page Entries Supported (EXTDLPES) bit is set to ‘1’ in the LID Specific Parameter field as\ndefined in Figure 308) and that Discovery controller processes a Get Log Page command for this log page\nwith the Extended Discovery Log Page Entries (EXTDLPE) bit set to ‘1’ in the Log Specific Parameter (LSP)\nfield (refer to Figure 309), then each entry returned by that Discovery controller may be either a Discovery\nLog Page Entry or an Extended Discovery Log Page Entry. Extended Discovery Log Page Entries may\ncontain zero or more extended attributes. If a Discovery controller returns records that include Extended\nDiscovery Log Page Entries, then that Discovery controller shall set the Extended (EXTEND) bit to ‘1’ in\nthe Discovery Log Page Flags (DLPF) field. A Centralized Discovery controller (CDC) shall support\nreturning Extended Discovery Log Page Entries.\nIf a Discovery controller supports returning only port local Discovery Log Page Entries or port local Extended\nDiscovery Log Page Entries (i.e., the Port Local Entries Only Supported (PLEOS) bit is set to ‘1’ in the LID\nSpecific Parameter field as defined in Figure 308) and that Discovery controller processes a Get Log Page\ncommand for this log page with the Port Local Entries Only (PLEO) bit set to ‘1’ in the LSP field (refer to\nFigure 309), then that Discovery controller shall return records for only NVM subsystem ports that are\npresented through the same NVM subsystem port that received the Get Log Page command. If a Discovery\ncontroller returns records for only NVM subsystem ports that are presented through the same NVM\nsubsystem port that received the Get Log Page command, then that Discovery controller shall set the Port\nLocal (PORTLCL) bit to ‘1’ in the DLPF field. Only a Direct Discovery controller (DDC) may support returning\nonly port local Discovery Log Page Entries or port local Extended Discovery Log Page Entries.\nIf a Discovery controller supports returning records for all NVM subsystem ports that are registered (i.e.,\nthe All NVM Subsystems Entries Supported (ALLSUBES) bit is set to ‘1’ in the LID Specific Parameter field\nas defined in Figure 308) and that Discovery controller processes a Get Log Page command for this log\npage with the All NVM Subsystem Entries (ALLSUBE) bit set to ‘1’ in the LSP field (refer to Figure 309),\nthen that Discovery controller shall return records for all NVM subsystem ports that are registered. The list\nof records returned by that Discovery controller shall not be filtered based upon the requesting HOSTNQN.\nIf a Discovery controller returns records for all NVM subsystem ports that are registered, then that Discovery\ncontroller shall set the All Subsystems (ALLSUB) bit to ‘1’ in the DLPF field. A Discovery controller may\nrequire authentication before reporting the ALLSUBES bit being set to ‘1’ or may require configuration\noutside the scope of this specification.\nThe Log Page Offset may be used to retrieve specific records. If the Discovery controller supports an index\noffset for this log page (i.e., the Index Offset Supported (IOS) bit is set to ‘1’ in the Supported Log Pages\nlog page (refer to section 5.2.12.1.1) for this log page) and the OT bit is set to ‘1’ in a Get Log Page\ncommand, then the index values specified in the Log Page Offset Lower (LPOL) field (refer to Figure 203)\nand Log Page Offset Upper (LPOU) field (refer to Figure 204) in that Get Log Page command shall be used\nto index into the header and list of entries within this log page (e.g., specifying an index offset of 0 returns\nthis log page starting at the header, specifying an index offset of 1 returns this log page starting at the offset\nof Entry 0, etc.).\nThe number of records (i.e., the number of Discovery Log Page Entries) is returned in the header of the log\npage. The format for a Discovery Log Page Entry is defined in Figure 310. The format for an Extended\nDiscovery Log Page Entry is defined in Figure 311. The format for an extended attribute is defined in Figure\n533. The format for the Discovery log page is defined in Figure 312.\nA single Get Log Page command used to read the Discovery log page shall be atomic. If the Discovery log\npage is read using multiple Get Log Page commands, then the reader should validate the Generation\nCounter field to ensure that there has not been a change in the contents of the data. The Discovery log\npage contents should be processed in the following sequence:\n1. read the Discovery log page contents in order (i.e., with increasing Log Page Offset values);\n2. re-read the Generation Counter field after the entire log page is transferred; and\n3. if the Generation Counter field does not match the original value read, then discard the log page\nread, as the entries may be inconsistent, and restart the sequence.; or\n4. if the Generation Counter field does match the original value read, then process the returned data.\nIf the log page contents change during this command sequence, then the controller may return a status\ncode of Discover Restart.\nEvery record indicates via the SUBTYPE field if that record is describing the current Discovery Service,\nreferring to another Discovery Service, or if the record indicates an NVM subsystem composed of\ncontrollers that may expose namespaces. A referral to another Discovery Service (i.e., SUBTYPE field set\nto 01h) is a mechanism to find additional Discovery subsystems. An NVM subsystem entry (i.e., SUBTYPE\nfield set to 02h) is a mechanism to find NVM subsystems that contain controllers that may expose\nnamespaces. An entry that describes the current Discovery Service (i.e., SUBTYPE field set to 03h) is a\nmechanism to find additional access information (e.g., other NVM subsystem ports) for the current\nDiscovery service. Hosts or Discovery controllers are not required to process referral entries deeper than\neight levels.\nFor entries that describe the current Discovery Service, the DUPRETINFO bit set to ‘1’ in the Entry Flags\nfield indicates those ports that return duplicate information. A host need not retrieve the Discovery Log Page\nfrom all NVM subsystem ports described by a Discovery Log Page Entry that contains the DUPRETINFO\nbit set to ‘1’ (refer to Figure 310), as each of those ports return the same information. A host may retrieve\nthe Discovery Log Page from multiple ports with the DUPRETINFO bit set to ‘1’ to act as redundant access\nto the same information. A host may choose to enable the Discovery Log Page Change AEN on one of the\nconnections associated with an entry with the DUPRETINFO bit set to ‘1’. If the Discovery Log Page Change\nAEN is enabled on multiple ports represented by entries with the DUPRETINFO bit set to ‘1’, then the host\nmay process a Discovery Log Page Change AEN for one connection as applying to all ports represented\nby entries that also have the DUPRETINFO bit set to ‘1’.\nIf an NVM subsystem supports the dynamic controller model, then all entries for that NVM subsystem shall\nhave the Controller ID field set to FFFFh. For a particular NVM subsystem port and NVMe Transport\naddress in an NVM subsystem, there shall be no more than one entry with the Controller ID field set to:\n•\nFFFFh if that NVM subsystem supports the dynamic controller model; or\n•\nFFFEh if that NVM subsystem supports the static controller model.",
    "tables": [
      {
        "id": "table_330_375",
        "page": 330,
        "bbox": [
          115.0,
          375.0,
          881.0,
          577.0
        ],
        "table_md": "| | Description |\n|---|---|\n| | **Transport Type (TRTTYPE):** Specifies the NVMe Transport type. |\n| | <table><tbody><tr><th>Value</th><th>Definition</th></tr><tr><td>00</td><td>TCP Transport (refer to the NVMe over TCP Transport Specification)</td></tr><tr><td>04 to 253</td><td>Reserved</td></tr><tr><td>254</td><td>Intra-host Transport (i.e., loopback) (NOTE: This is a reserved value for use by a host.)</td></tr><tr><td>255</td><td>Reserved</td></tr></tbody></table> |\n| | **Address Family (ADRFAM):** Specifies the address family. |\n| | <table><tbody><tr><th>Value</th><th>Definition</th></tr><tr><td>00</td><td>Reserved</td></tr><tr><td>01</td><td>AF_INET: IPv4 address family. IPv4 address format syntax specified in section 3.2.2 of IETF RFC 3986.</td></tr><tr><td>02</td><td>AF_INET6: IPv6 address family. IPv6 address format syntax specified in section 3.2.2 of IETF RFC 3986.</td></tr><tr><td>03</td><td>AF_IB: InfiniBand address family.</td></tr><tr><td>04</td><td>Fibre Channel address family.</td></tr><tr><td>05 to 253</td><td>Reserved</td></tr><tr><td>254</td><td>Intra-host Transport (i.e., loopback) (NOTE: This is a reserved value for use by a host.)</td></tr><tr><td>255</td><td>Reserved</td></tr></tbody></table> |\n| Value | Definition |\n|:---|:---|\n| 00 | Reserved |\n| 01 | **Referral:** The entry describes a referral to another Discovery Service composed of Discovery controllers that provide additional discovery records. Multiple Referral entries may be reported for each Discovery Service (e.g., if that Discovery Service has multiple NVM subsystem ports or supports multiple protocols). |\n| 02 | **NVM Subsystem:** The entry describes an NVM subsystem whose controllers may have attached namespaces (i.e., an NVM subsystem that is not composed of Discovery controllers). Multiple NVM Subsystem entries may be reported for each NVM subsystem if that NVM subsystem has multiple NVM subsystem ports. |\n| 03 | **Current Discovery Subsystem:** The entry describes this Discovery subsystem (i.e., the Discovery Service that contains the controller processing the Get Log Page command). Multiple Current Discovery Subsystem entries may be reported for this Discovery subsystem if the current Discovery subsystem has multiple NVM subsystem ports. |\n| 04 to 255 | Reserved |\n\n| Bits | Description |\n|:---|:---|\n| 7:6 | Reserved |\n| 5:4 | **Transport Authentication and Secure Channel (TASC):** Indicates whether an authentication transaction (refer to section 8.3.5.2) or an authentication transaction concatenated to a secure channel establishment (refer to section 8.3.5.3) is required upon completion of the Connect command. These bits do not override the AUTHREQ bits in the Connect response; these bits apply only when the AUTHREQ bits specify no requirements (refer to Figure 582). |\n| | | | Value | Definition |\n| | | | 00b | Not specified |\n| | | | 01b | Authentication required |\n| | | | 10b | Authentication concatenated to secure channel establishment required |\n| | | | 11b | Reserved |\n| 3 | **Zero Host ID Support (ZHIDS):** If this bit is set to '1', then the controller supports a Host Identifier value of 0h in a Connect command. If this bit is cleared to '0', then the controller does not support a Host Identifier value of 0h in a Connect command. |\n| 2 | **SQ Flow Control Disable (SQFCD):** If this bit is set to '1', then the controller is capable of disabling SQ flow control. A controller that is capable of disabling SQ flow control may accept or reject a host request to disable SQ flow control. If this bit is cleared to '0', then the controller requires use of SQ flow control. |\n| 1:0 | **Transport Secure Channel (TSC):** Indicates whether connections shall be made over a fabric secure channel (refer to section 8.3.5.1). |\n| | | | Value | Definition |\n| | | | 00b | Not specified |\n| | | | 01b | Required |\n| | | | 10b | Not required (i.e., not supported or supported but not required) |\n| | | | 11b | Reserved |\n| :04 | **Port ID (PORTID):** Specifies a particular NVM subsystem port. Different NVMe Transports or address families may utilize the same Port ID value (e.g., a Port ID may support both iWARP and RoCE). |\n| | | |\n| :--- | :--- | :--- |\n| :06 | Controller ID (CNTLID): Specifies the controller ID. If the NVM subsystem uses a dynamic controller model, then this field shall be set to FFFFh. If the NVM subsystem uses a static controller model, then this field may be set to a specific controller ID (values 0h to FFEFh are valid). If the NVM subsystem uses a static controller model and the value indicated is FFFEh, then the host should remember the Controller ID returned as part of the Fabrics Connect command in order to re-establish an association in the future with the same controller. | |\n| :08 | Admin Max SQ Size (ASQSZ): Specifies the maximum size of an Admin Submission Queue. This applies to all controllers in the NVM subsystem. The value shall be a minimum of 32 entries. | |\n| | **Entry Flags (EFLAGS):** This field Indicates additional information related to the current entry. | |\n| | **Bits** | **Description** |\n| | 15:3 | Reserved |\n| | 2 | **No CDC Connectivity (NCC):** If this bit is set to ‘1’, then no DDC that describes this entry is currently connected to the CDC. If this bit is cleared to ‘0’, then at least one DDC that describes this entry is currently connected to the CDC. If the Discovery controller returning this log page is not a CDC, then this bit shall be cleared to ‘0’ and should be ignored by the host. |\n| | 1 | **Explicit Persistent Connection Support for Discovery (EPCSD):** If this bit is set to ‘1’, then Explicit Persistent Connections are supported for the Discovery controller described by this entry. If this bit is cleared to ‘0’, then support for Explicit Persistent Connections is not reported. <br> For entries with the SUBTYPE field set to 2h, this bit shall be cleared to ‘0’. |\n| | 0 | **Duplicate Returned Information (DUPRETINFO):** If this bit is set to ‘1’, then using the content of this entry to access this Discovery Service returns the same information that is returned by using the content of other entries in this log page that also have this bit set to ‘1’. If this bit is cleared to ‘0’, then using the content of this entry to access this Discovery Service may or may not return different information than is returned by using the content of any other entry in this log page. <br> For entries with the SUBTYPE field set to a value other than 3h, this bit shall be cleared to ‘0’. |\n| :12 | Reserved | |\n| :32 | **Transport Service Identifier (TRSVCID):** Specifies the NVMe Transport service identifier as an ASCII string. The NVMe Transport service identifier is specified by the associated NVMe Transport binding specification. | |\n| :64 | Reserved | |\n| :256 | **NVM Subsystem Qualified Name (SUBNQN):** NVMe Qualified Name (NQN) that uniquely identifies the NVM subsystem. Refer to section 4.7. <br> For a Discovery subsystem, if that Discovery subsystem has a unique Discovery Service NQN (i.e., the NVM Subsystem NVMe Qualified Name (SUBNQN) field in that Discovery subsystem’s Identify Controller data structure contains a unique Discovery Service NQN value), then the value returned shall be that unique Discovery Service NQN. If the Discovery subsystem does not have a unique Discovery Service NQN, then the value returned shall be the well-known Discovery Service NQN (i.e., nqn.2014-08.org.nvmexpress.discovery). | |\n| :512 | **Transport Address (TRADDR):** Specifies the address of the NVM subsystem that may be used for a Connect command as an ASCII string. The Address Family field describes the reference for parsing this field. Refer to section 1.4.2 for ASCII string requirements. For the definition of this field, refer to the appropriate NVMe Transport binding specification. | |\n| :768 | **Transport Specific Address Subtype (TSAS):** Specifies NVMe Transport specific information about the address. For the definition of this field, refer to the appropriate NVMe Transport binding specification. | |\n| Bytes | Description |\n| :--- | :--- |\n| 00 | **Transport Type (TRTYPE)**: This field indicates the transport type as defined in the Transport Type (TRTYPE) field in Figure 310. |\n| 01 | **Address Family (ADRFAM)**: This field indicates the address family as defined in the Address Family (ADRFAM) field in Figure 310. |\n| 02 | **Subsystem Type (SUBTYPE)**: This field indicates the type of the NVM subsystem that is indicated in this entry as defined in the Subsystem Type (SUBTYPE) field in Figure 310. |\n| 03 | **Transport Requirements (TREQ)**: This field indicates requirements for the NVMe Transport as defined in the Transport Requirements (TREQ) field in Figure 310. |\n| 05:04 | **Port ID (PORTID)**: This field indicates a particular NVM subsystem port as defined in the Port ID (PORTID) field in Figure 310. |\n| 07:06 | **Controller ID (CNTLID)**: This field indicates the controller ID as defined in the Controller ID (CNTLID) field in Figure 310. |\n| 09:08 | **Admin Max SQ Size (ASQSZ)**: This field indicates the maximum size of an Admin Submission Queue as defined in the Admin Max SQ Size (ASQSZ) field in Figure 310. |\n| 11:10 | **Entry Flags (EFLAGS)**: This field indicates additional information related to the current entry as defined in the Entry Flags (EFLAGS) field in Figure 310. |\n| 31:12 | Reserved |\n| 63:32 | **Transport Service Identifier (TRSVCID)**: This field indicates the NVMe Transport service identifier as an ASCII string as defined in the Transport Service Identifier (TRSVCID) field in Figure 310. |\n| 255:64 | Reserved |\n| 511:256 | **NVM Subsystem Qualified Name (NQN)**: This field indicates the NVMe Qualified Name (NQN) that uniquely identifies the NVM subsystem as defined in the NVM Subsystem Qualified Name (SUBNQN) field in Figure 310. |\n| 767:512 | **Transport Address (TRADDR)**: This field indicates the address of the NVM subsystem that may be used for a Connect command as an ASCII string as defined in the Transport Address (TRADDR) field in Figure 310. |\n| 1023:768 | **Transport Specific Address Subtype (TSAS)**: This field indicates NVMe Transport specific information about the address as defined in the Transport Specific Address Subtype (TSAS) field in Figure 310. |\n| 1027:1024 | **Total Entry Length (TEL)**: This field indicates the length in bytes of the entire Extended Discovery Log Page Entry. |\n| 1029:1028 | **Number of Extended Attributes (NUMEXAT)**: This field indicates the number of extended attributes contained in the Extended Discovery Log Page Entry. |\n| 1031:1030 | Reserved |\n| | **Extended Attribute List** |\n| _LEN - 1) + 4) + 1032: 1032 | **Extended Attribute 0**: This field contains the first extended attribute as defined in Figure 533 (if present), where EXATLEN is the size specified in the Extended Attribute Length (EXATLEN) field of the extended attribute. |\n| ... | ... |\n| TEL - 1: -(EXATLEN + 4) | **Extended Attribute N**: This field contains the Nth extended attribute as defined in Figure 533 (if present), where EXATLEN is the size specified in the Extended Attribute Length (EXATLEN) field of the extended attribute and TEL is the size specified in the Total Entry Length (TEL) field. |\n| | |\n| | **Figure 312: Discovery Log Page** |\n| Bytes | Description |\n| :--- | :--- |\n| | **Header** |\n| 07:00 | **Generation Counter (GENCTR)**: Indicates the version of the discovery information, starting at a value of 0h. For each change in the Discovery log page, this counter is incremented by one. If the value of this field is FFFFFFFF_FFFFFFFFh, then the field shall be cleared to 0h when incremented (i.e., rolls over to 0h). |\n| | | |\n| :--- | :--- | :--- |\n| 15:08 | | Number of Records (NORL): Indicates the number of records contained in the log page. |\n| 17:16 | | **Record Format (RECFMT):** Specifies the format of the Discovery log page. If a new format is defined, this value is incremented by one. The format of the record specified in this definition shall be 0h. |\n| | | **Discovery Log Page Flags (DLPF):** This field indicates additional information related to the Discovery log page. |\n| | | <table><tbody><tr><th>Bits</th><th>Description</th></tr><tr><td>7:3</td><td>Reserved</td></tr><tr><td>2</td><td><b>All Subsystems (ALLSUB):</b> If this bit is set to '1', then the records contained in the log page are for all NVM subsystem ports. If this bit is cleared to '0', then the records contained in the log page may or may not be for all NVM subsystem ports.</td></tr><tr><td>1</td><td><b>Port Local (PORTLCL):</b> If this bit is set to '1', then the records contained in the log page are only for NVM subsystem ports that are presented through the same NVM subsystem port that is returning this log. If this bit is cleared to '0', then the records contained in the log page may be for NVM subsystem ports that are presented through any NVM subsystem port on that NVM subsystem.</td></tr><tr><td>0</td><td><b>Extended (EXTEND):</b> If this bit is set to '1', then the records contained in the log page may include Extended Discovery Log Page Entries. If this bit is cleared to '0', then the records contained in the log page do not include Extended Discovery Log Page Entries.</td></tr></tbody></table> |\n| 18 | | |\n| 19 | | Reserved |\n| 23:20 | | **Total Discovery Log Page Length (TDLPL):** This field indicates the length in bytes of the entire Discovery log page. If the value in this field is cleared to 0h, then this field is not reported. |\n| 023:24 | | Reserved |\n| | | **Discovery Log Page Entry List** |\n| | | **Entry 0:** Contains either the first Discovery Log Page Entry as defined in Figure 310 or the first Extended Discovery Log Page Entry as defined in Figure 311. TEL is the size indicated in the Total Entry Length (TEL) field of the Extended Discovery Log Page Entry. For Discovery Log Page Entries, TEL shall be 1,024 bytes. |\n| | | ... |\n| | | **Entry N:** Contains either the Nth Discovery Log Page Entry as defined in Figure 310 (if present) or the Nth Extended Discovery Log Page Entry as defined in Figure 311 (if present). TEL is the size indicated in the Total Entry Length (TEL) field of the Extended Discovery Log Page Entry and TDLPL is the size indicated in the Total Discovery Log Page Length (TDLPL) field. For Discovery Log Page Entries, TEL shall be 1,024 bytes. If the TDLPL field is reserved (i.e., this log page does not contain any Extended Discovery Log Page Entries), then the byte position of the Nth Discovery Log Page Entry shall be: ((N + 1) * 1024) - 1):((N + 1) * 1024). |\n| | | |\n| | | |\n| | | |\n| | | |\n| | | |\n| | | |\n| | | |\n| |"
      },
      {
        "id": "table_332_208",
        "page": 332,
        "bbox": [
          114.0,
          208.0,
          881.0,
          360.0
        ],
        "table_md": "(Continuation of Untitled Table - see first part)"
      },
      {
        "id": "table_332_405",
        "page": 332,
        "bbox": [
          114.0,
          405.0,
          881.0,
          750.0
        ],
        "table_md": "(Continuation of Untitled Table - see first part)"
      },
      {
        "id": "table_333_124",
        "page": 333,
        "bbox": [
          114.0,
          124.0,
          879.0,
          860.0
        ],
        "table_md": "(Continuation of Untitled Table - see first part)"
      },
      {
        "id": "table_334_124",
        "page": 334,
        "bbox": [
          114.0,
          124.0,
          881.0,
          827.0
        ],
        "table_md": "(Continuation of Untitled Table - see first part)"
      },
      {
        "id": "table_335_124",
        "page": 335,
        "bbox": [
          114.0,
          124.0,
          881.0,
          777.0
        ],
        "table_md": "(Continuation of Untitled Table - see first part)"
      },
      {
        "id": "table_335_818",
        "page": 335,
        "bbox": [
          114.0,
          818.0,
          881.0,
          904.0
        ],
        "table_md": "(Continuation of Untitled Table - see first part)"
      },
      {
        "id": "table_336_127",
        "page": 336,
        "bbox": [
          114.0,
          127.0,
          881.0,
          700.0
        ],
        "table_md": "(Continuation of Untitled Table - see first part)"
      }
    ],
    "figures": []
  },
  "statistics": {
    "table_count": 8,
    "figure_count": 0
  }
}