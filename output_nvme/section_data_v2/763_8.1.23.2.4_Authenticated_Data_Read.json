{
  "section_index": 763,
  "section_id": "8.1.23.2.4",
  "title": "8.1.23.2.4 Authenticated Data Read",
  "level": 5,
  "pages": {
    "start": 641,
    "end": 642,
    "count": 2
  },
  "content": {
    "text": "The Authenticated Data Read sequence is initiated by a Security Send command. The RPMB data frame\ndelivered from the host to the controller includes the Request Message Type = 0004h, Nonce, Address,\nand the Sector Count.\nWhen the controller receives this RPMB Data Frame, that controller first checks the Address. If there is an\nerror in the Address, then the result is set to 0004h (address failure) and the data read is not valid.\nWhen the host receives a successful completion of the Security Send command from the controller, that\nhost should send a Security Receive command to the controller to retrieve the data. The controller returns\nan RPMB Data Frame with Response Message Type (0400h), the Sector Count, a copy of the Nonce\nreceived in the request, the Address, the Data, the controller calculated MAC, and the Result. Note: It is\nthe responsibility of the host to verify the MAC returned on an Authenticated Data Read Request.\nIf the data transfer from the addressed location in the controller fails, the returned Result is 0006h (read\nfailure). If the Address provided in the Security Send command is not valid, then the returned Result is\n0004h (address failure). If another error occurs during the read procedure, then the returned Result is 0001h\n(general failure).",
    "tables": [
      {
        "id": "table_642_128",
        "page": 642,
        "bbox": [
          114.0,
          128.0,
          881.0,
          473.0
        ],
        "table_md": "| 222-N:00 | Stuff Bytes | 0...00h |\n|---|---|---|\n| 222:222-(N-1) | MAC/Key | 0...00h |\n| 223 | RPMB Target | RPMB target to access |\n| 239:224 | Nonce | Nonce generated by the host |\n| 243:240 | Write Counter | 00000000h |\n| 247:244 | Address | Address in RPMB |\n| 251:248 | Sector Count | Number of 512B blocks |\n| 253:252 | Result | 0000h |\n| 255:254 | Request/Response | 0004h (Request) |\n| | | |\n| **Data populated by the controller and returned to the host** | | |\n| 222-N:00 | Stuff Bytes | 0...00h |\n| 222:222-(N-1) | MAC/Key | MAC generated by the controller |\n| 223 | RPMB Target | RPMB target response was sent from |\n| 239:224 | Nonce | Copy of the Nonce generated by the host |\n| 243:240 | Write Counter | 0000h |\n| 247:244 | Address | Address in RPMB |\n| 251:248 | Sector Count | Number of 512B blocks |\n| 253:252 | Result | Result Code |\n| 255:254 | Request/Response | 0400h (Response) |\n| (M-1)+256:256 | Data | Data read from RPMB target |\n| | | |\n| | | |\n| **Authenticated Device Configuration Block Write** | | |\n| Authenticated Device Configuration Block Write is initiated by a Security Send command. The RPMB | | |\n| frame delivered from the host to the controller includes the Request Message Type = 0006h, Sector | | |\n| : 01h, MAC, Write Counter set to the current Write Counter value, and the RPMB Device | | |\n| ation Block data structure (refer to Figure 699). All other fields are cleared to 0h. | | |\n| Write Counter has expired, then that controller sets the result to 0005h (write failure, write counter | | |\n| and no data is written to the Device Configuration Block. | | |"
      }
    ],
    "figures": []
  },
  "statistics": {
    "table_count": 1,
    "figure_count": 0
  }
}