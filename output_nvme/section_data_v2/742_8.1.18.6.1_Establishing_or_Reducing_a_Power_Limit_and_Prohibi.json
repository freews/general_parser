{
  "section_index": 742,
  "section_id": "8.1.18.6.1",
  "title": "8.1.18.6.1 Establishing or Reducing a Power Limit and Prohibiting Power States from Use",
  "level": 5,
  "pages": {
    "start": 617,
    "end": 618,
    "count": 2
  },
  "content": {
    "text": "If controller processing of the Power Limit feature (e.g., processing of a Set Features command for this\nfeature or processing of a Controller Level Reset) causes at least one enabled power state to become\nprohibited from use (i.e., results in a power limit that is less than the current value of the Maximum Power\n(MP) field in the Power State 0 Descriptor (PSD0) field in the Identify Controller data structure (refer to\nFigure 328)), then the controller shall perform the following steps in order:\n1. if there is no current power limit in force (i.e., the current value of the PLV attribute of the Power\nLimit feature is cleared to 0h, refer to section 5.2.26.1.25) or the controller has removed a power\nlimit as part of the power limit processing specified in section 8.1.18.6.2, then retain the following\ndata for use as specified in section 8.1.18.6.2:\na. the entire set of PSD data structures;\nb. the entire set of entries in the Autonomous Power State Transition (APST) data structure\n(refer to Figure 411);\nc. the Number of Power States Support (NPSS) value in the Identify Controller data structure;\nand\nd. the two or three values (refer to section 4.4) of the power state attribute of the Power\nManagement feature;\n2. prohibit the use of all power states whose maximum power (indicated by the MP field in the PSD\nfor that power state) is greater than the specified power limit;\np\n)\ng\np\np\n3. for each power state prohibited in step 2, remove:\na. the PSD data structure from the Identify Controller data structure; and\nb. the APST data structure entry (refer to Figure 412) for that power state;\n4. shift the remaining set of PSD data structures (in step 3a) to lower byte offsets in the Identify\nController data structure so that the PSD0 field contains the PSD for the lowest numbered power\nstate whose MP field value is less than or equal to that new power limit, and adjust the value of the\nNumber of Power States Support (NPSS) field to match the number of remaining PSD data\nstructures;\n;\n5. shift the remaining set of entries in the APST data structure (in step 3b) to match the shift of the\nPSD data structures in step 4, so that the first entry aligns with the new PS0 after the power limit is\napplied;\npp\n6. clear to zero the:\na. PSD data structures in the Identify Controller data structure that no longer contain a usable\nPSD as a result of the changes made in step 3(a); and\nb. entries in the APST data structure that no longer contain usable contents as a result of the\nchanges made in step 3(b);\n7. for each of the current, default, and saved (if any) values of the Power State attribute of the Power\nManagement feature:\na. if the power state indicated by that value has not been prohibited by step 2, then change\nthat value to match the new location of the PSD data structure for that power state (i.e.,\nthe resulting value matches the location that resulted from the data structure shift in step\n4); and\nb. if the power state indicated by that value has been prohibited by step 2, then clear that\nvalue to 0h;\nand\n8. for the value of the Idle Transition Power State field in each entry in each of the current, default and\nsaved (if any) values of the APST feature:\na. if the power state indicated by that value has not been prohibited by step 2, then change\nthat value to match the new location of the APST data structure for that power state (i.e.,\nthe resulting value matches the location that resulted from the data structure shift in step\n5); and\nb. if the power state indicated by that value has been prohibited by step 2, then clear that\nvalue to 0h.\nEach PSD data structure that is retained in step 1 and removed in step 3 is referred to as a Removed Power\nState Descriptor (RPSD) data structure.",
    "tables": [],
    "figures": []
  },
  "statistics": {
    "table_count": 0,
    "figure_count": 0
  }
}