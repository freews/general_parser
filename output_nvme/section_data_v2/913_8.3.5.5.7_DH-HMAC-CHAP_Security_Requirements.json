{
  "section_index": 913,
  "section_id": "8.3.5.5.7",
  "title": "8.3.5.5.7 DH-HMAC-CHAP Security Requirements",
  "level": 5,
  "pages": {
    "start": 755,
    "end": 755,
    "count": 1
  },
  "content": {
    "text": "In order to authenticate with the DH-HMAC-CHAP protocol, each host or controller uses a DH-HMAC-\nCHAP key that is associated with the entity’s NQN. A DH-HMAC-CHAP key is unidirectional (i.e., used only\nfor one direction of an authentication transaction). A DH-HMAC-CHAP key should not be associated with\nmore than one NQN as this opens security vulnerabilities. All DH-HMAC-CHAP implementations should\ncheck for use of the same key with more than one NQN and should generate an administrative warning if\nthis situation occurs (e.g., as a result of configuring a DH-HMAC-CHAP key to verify authentication of\nanother entity).\nThe DH-HMAC-CHAP key is derived from an administratively configured secret (refer to section 8.3.5.5.8)\nEach host and NVM subsystem shall support:\n•\ntransforming the provided secret into a key applying the HMAC function using the hash function\nspecified in the secret representation (refer to section 8.3.5.5.8) with the secret as HMAC key to\nthe concatenation of its own NQN not including the null terminator and the seventeen ASCII\ncharacters “NVMe-over-Fabrics” (i.e., key = HMAC(secret, NQN || ”NVMe-over-Fabrics”)). This\ntransformation ensures the resulting key is uniquely associated with the entity identified by the\nNQN; and\n•\nusing the provided secret as a key. This is intended for use with key management solutions able to\nensure that key is uniquely associated with the entity identified by the NQN.\nNVM subsystems should support the ability to use a different NVM subsystem key with each host. Hosts\nshould support the ability to use a different host key with each NVM subsystem. NVM subsystems should\nsupport the ability to use a different NVM subsystem secret with each host. Hosts should support the ability\nto use a different host secret with each NVM subsystem.\nIf an implementation of NVMe over Fabrics is capable of functioning as both a host and an NVM subsystem\nthen that implementation shall use either:\n•\none NQN for the host functionality and a different NQN for the NVM subsystem functionality; or\n•\none NQN for both host functionality and NVM subsystem functionality.\nDH-HMAC-CHAP implementations may reuse a DH exponential (e.g., gx mod p or gy mod p). The primary\nrisk in allowing reuse of a DH exponential is replay of a prior authentication sequence based on the attacker\nreusing the other exponential. For DH-HMAC-CHAP, replay is prevented with extremely high probability by\nthe requirement that all challenges be randomly generated. Refer to section 2.12 of RFC 7296 for guidance\non DH exponential reuse.\nThe security of the DH-HMAC-CHAP protocol requires secrets, challenges, and DH exponents (i.e., x and\ny) to be generated from actual randomness. For a discussion of randomness and sources of randomness,\nrefer to RFC 4086.\nImplementations shall use a cryptographic random number generator that should be seeded with at least\n256 bits of entropy to generate random numbers for this protocol. The secret provisioning mechanism for\neach host and controller is outside of scope of this specification. For instance, secrets could be provisioned\nvia an encrypted HTTPS-based connection.",
    "tables": [],
    "figures": []
  },
  "statistics": {
    "table_count": 0,
    "figure_count": 0
  }
}