##### 8.2.6.1 VQ Resource Definition

> **Section ID**: 8.2.6.1 | **Page**: 695-695

A Virtual Queue Resource (VQ Resource) is a type of controller resource that manages one CQ and one
SQ. For a VQ Resource that is assigned to a controller, its resource identifier is equivalent to its Queue
Identifier.
The Controller Resource Types field of the Primary Controller Capabilities Structure indicates whether VQ
Resources are supported. If VQ Resources are unsupported, a primary controller and its associated
secondary controllers have all queues as Private Resources. The rest of this section assumes that VQ
Resources are supported.
The secondary controller is assigned VQ Resources using the Virtualization Management command. The
number of VQ Resources assigned is discoverable in the Secondary Controller List entry for the associated
secondary controller. The number of VQ Resources assigned may also be discovered using the Get
Features command with the Number of Queues Feature identifier (refer to section 5.2.26.2.1).
If a secondary controller has no assigned VQ Resources, then that controller remains in the Offline state.
A secondary controller is not able to transition to the Online state until VQ Resources for an Admin Queue
and one or more I/O Queues have been assigned to that controller (i.e., the minimum number of VQ
Resources that may be assigned is two).
A primary controller that supports VQ Resources shall have at least two queue pairs that are Private
Resources to ensure there is a minimum of an Admin Queue pair and one I/O queue pair for the primary
controller at all times. A primary controller may be allocated VQ Resources using the Primary Controller
Flexible Allocation action of the Virtualization Management command. The VQ resources allocated take
effect after a Controller Level Reset and are persistent across power cycles and resets. The number of VQ
Resources currently allocated is discoverable in the Primary Controller Capabilities Structure. The number
of VQ Resources currently allocated may also be discovered using the Get Features command with the
Number of Queues Feature identifier (refer to section 5.2.26.2.1).
