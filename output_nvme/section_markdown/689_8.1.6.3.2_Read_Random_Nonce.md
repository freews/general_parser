###### 8.1.6.3.2 Read Random Nonce

> **Section ID**: 8.1.6.3.2 | **Page**: 571-571

The random nonce is a random byte string that:
•
shall be generated by the controller; and
•
shall be stored for later use with Programmable Key Authentication (refer to section
5.2.26.1.24.1.2).
The size of the random nonce is vendor specific.
A host is able to obtain the random nonce by submitting a Security Send command, that is subsequently
followed by the host submitting a Security Receive command. The Security Send command specifies a
CDP Request Data Frame (refer to Figure 630) that specifies:
•
a Request Message Type value of 05h (i.e., Random Nonce Request); and
•
CDP Random Nonce Request Data (refer to Figure 638).
Once the controller returns a successful completion of the Security Send command, then the host should
check the result of the read random nonce request by submitting a Security Receive command. The
controller returns a successful completion of the Security Receive command and returns a CDP Nonce
Read Data Frame (refer to Figure 639) indicating the random nonce generated by the controller.
If an error occurs during the processing of the Security Send command to retrieve the random nonce, then
the controller sets the Result Code field to 01h (i.e., General Failure).
The controller shall purge the random nonce to prevent random nonce reuse by the host.:
•
during a Controller Level Reset; and
•
during the processing of the Security Send command for a Personality Unfreeze Request operation
(refer to section 8.1.6.2.2).
