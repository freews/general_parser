##### 8.1.26.3 Sanitize Operation Types and Support

> **Section ID**: 8.1.26.3 | **Page**: 657-660

The Sanitize Capabilities (SANICAP) field of the Identify Controller data structure (refer to Figure 328)
indicates the sanitize operation types supported and controller attributes specific to sanitize operations.
The sanitize operation types are:
â€¢
the Block Erase sanitize operation, which alters user data with a low-level block erase method that
is specific to the media for all locations on the media within the sanitization target in which user
data may be stored;
â€¢
the Crypto Erase sanitize operation, which alters user data by changing the media encryption keys
for all locations on the media within the sanitization target in which user data may be stored; and
â€¢
the Overwrite sanitize operation, which alters user data by writing a fixed data pattern or related
patterns one or more times to all locations on the media within the sanitization target in which user
data may be stored. Figure 705 defines the data pattern or patterns that are written.
Controller attributes that affect the processing of sanitize operations include:
â€¢
the No-Deallocate Modifies Media After Sanitize (NODMMAS) field, which indicates whether media
is modified by the controller as part of sanitize processing for an NVM subsystem sanitize operation
and that had been requested with the No-Deallocate After Sanitize (NDAS) bit set to â€˜1â€™ in the
Sanitize command that started the NVM subsystem sanitize operation;
â€¢
the No-Deallocate Inhibited (NDI) bit, which indicates if the controller supports the No-Deallocate
After Sanitize bit in the Sanitize command;
â€¢
the Verification Support (VERS) bit, which indicates if the controller supports the Media Verification
state and the Post-Verification Deallocation state for NVM subsystem sanitize operations that
perform block erase or crypto erase; and
â€¢
the Namespace Verification Support (NVERS) bit, which indicates if the controller supports the
Media Verification state and the Post-Verification Deallocation state for namespace sanitize
operations.
If the NODMMAS field indicates a value of 10b in the Identify Controller data structure (refer to Figure 328)
and a Sanitize command that starts an NVM subsystem sanitize operation specifies the No-Deallocate After
Sanitize (NDAS) bit set to â€˜1â€™, then sanitize processing includes additional media modification. Refer to
Annex A.3 for further information about sanitize operations and interactions with integrity circuits.
The Overwrite sanitize operation is media specific and may not be appropriate for all media types. For
example, if the media is NAND, multiple pass overwrite operations may have an adverse effect on media
endurance.
If the NVM subsystem supports the Key Per I/O capability (refer to section 8.1.14), then a sanitize operation
shall alter all user data such that recovery of any previous user data using the KEYTAG values specified
when that previous user data was written (i.e., original KEYTAG values) is infeasible for a given level of
effort (refer to ISO/IEC 27040).
To start a sanitize operation, the host:
â€¢
submits a Sanitize command specifying the SANACT field set to:
o
010b (i.e., start a Block Erase type NVM subsystem sanitize operation);
o
011b (i.e., start an Overwrite type NVM subsystem sanitize operation); or
o
100b (i.e., start a Crypto Erase type NVM subsystem sanitize operation).
or
â€¢
submits a Sanitize Namespace command specifying the SANACT field set to 100b (i.e.
Crypto Erase type namespace sanitize operation).
Following a successful sanitize operation, the values of user data (including protection information (PI), if
any, and non-PI metadata, if any) that result from an audit (refer to section 1.5.11) of the sanitization target
are defined in the NVM Express I/O Command Set specifications.
The Sanitize Status log page (refer to section 5.2.12.1.36) indicates estimated times for sanitize operations
and a consistent snapshot of information about the most recently started sanitize operation for the
sanitization target specified in the Get Log Page command, including whether a sanitize operation is in
progress, the sanitize operation parameters and the status of the most recent sanitize operation. The
controller shall report that a sanitize operation is in progress if:
â€¢
sanitize processing is in progress (including additional media modification, if required);
â€¢
the sanitization target is in the Media Verification state; or
â€¢
the sanitization target is in the Post-Verification Deallocation state.
If an NVM subsystem sanitize operation is not in progress, then the Global Data Erased (GDE) bit in the
log page indicates whether the NVM subsystem contains any user data (i.e., whether the NVM subsystem
has been written to since the most recent successful NVM subsystem sanitize operation).
If a namespace sanitize operation is not in progress on the namespace associated with a Sanitize Status
log page, then the Namespace Data Erased (NDE) bit in that log page indicates whether the namespace
may contain any user data (i.e., whether the namespace has been written to since the most recent
successful namespace sanitize operation).
The Sanitize Status log page shall be:
â€¢
initialized before any controller in the NVM subsystem is ready as described in sections 3.5.3 and
3.5.4;
â€¢
updated when a namespace is created (i.e., the Sanitize Status log page for that namespace is
created); and
â€¢
updated when any state transition occurs (refer to section 8.1.26.4).
The Sanitize Status log page is updated periodically during a sanitize operation to make progress
information available to hosts.
During a sanitize operation, the host may periodically examine the Sanitize Status log page to check for
progress, however, the host should limit this polling (e.g., to at most once every several minutes) to avoid
interfering with the progress of the sanitize operation itself.
The Sanitize Progress (SPROG) field in the Sanitize Status log page indicates progress during states that
may take long times to complete (i.e., the Restricted Processing state, the Unrestricted Processing state,
and the Post-Verification Deallocation state). The SPROG field is cleared to 0h upon entry to any of those
states, and while in any of those states is updated as described in Figure 302. The SPROG field shall not
be modified under any conditions not explicitly permitted by this specification.
A sanitize operation completes when the sanitization target enters any of the following states (refer to
section 8.1.26.4):
â€¢
the Idle state;
â€¢
the Restricted Failure state; or
â€¢
the Unrestricted Failure state.
Upon completion of a sanitize operation or upon entry to the Media Verification state, the host should read
the Sanitize Status log page, specifying the NSID indicating the sanitization target (i.e., cleared to 0h or set
to FFFFFFFFh for the NVM subsystem or set to the NSID of the namespace), and with the Retain
Asynchronous Event bit cleared to â€˜0â€™ (which clears the asynchronous event, if one was generated).
If a command that requests sanitize operations (i.e., the Sanitize command or the Sanitize Namespace
command) is supported, then all controllers in the NVM subsystem shall:
â€¢
support the Sanitize Status log page;
â€¢
support the Sanitize Operation Completed asynchronous event;
â€¢
support the Sanitize Operation Completed With Unexpected Deallocation asynchronous event, if
the Sanitize Config feature is supported;
â€¢
support the Exit Failure Mode action for that command;
â€¢
support at least one of the following sanitize operation types: Block Erase, Overwrite, or Crypto
Erase;
â€¢
support the same set of sanitize operation types for that command;
â€¢
indicate the supported sanitize operation types in the Sanitize Capabilities field in the Identify
Controller data structure; and
â€¢
if the Verification Support (VERS) bit is set to â€˜1â€™ or the Namespace Verification Support (NVERS)
bit is set to â€˜1â€™ in the Identify Controller data structure (refer to Figure 328), support:
o
the FAILS field in the Sanitize Status log page (refer to section 5.2.12.1.36);
o
the SANS field in the Sanitize Status log page;
o
the Media Verification state;
o
the Post-Verification Deallocation state; and
o
the Sanitize Operation Entered Media Verification State asynchronous event.
The Sanitize Config Feature Identifier (refer to section 5.2.26.1.15) contains the No-Deallocate Response
Mode (NODRM) bit that specifies the response of the controller to a Sanitize command specifying the No-
Deallocate After Sanitize (NDAS) bit (refer to Figure 388) set to â€˜1â€™ if the No-Deallocate Inhibited bit is set
to â€˜1â€™ in the Sanitize Capabilities field of the Identify Controller data structure (refer to Figure 328). In the
No-Deallocate Error Response Mode, the controller aborts such Sanitize commands with a status code of
Invalid Field in Command. In the No-Deallocate Warning Response Mode, the controller processes such
Sanitize commands, and if a resulting NVM subsystem sanitize operation is completed successfully, then
the SOS field is set to 100b (i.e., Sanitized Unexpected Deallocate) in the Sanitize Status log page (refer
to Figure 302).


---
### ðŸ“Š Tables (2)

#### Table 1: Untitled Table
![Untitled Table](../section_images/table_658_636.png)

| | Pass Count | Pass Number | | |
| :--- | :--- | :--- | :--- | :--- |
| | | First | Overwrite PatternÂ¹ | Each byte set to FFh |
| | Odd | | | |
| | | Subsequent | Inversion of Overwrite PatternÂ¹ from previous pass (i.e., each bit XORed with '1') | |


#### Table 2: Untitled Table
![Untitled Table](../section_images/table_659_128.png)

(Continuation of Untitled Table - see first part)

