###### 8.1.23.2.4 Authenticated Data Read

> **Section ID**: 8.1.23.2.4 | **Page**: 641-642

The Authenticated Data Read sequence is initiated by a Security Send command. The RPMB data frame
delivered from the host to the controller includes the Request Message Type = 0004h, Nonce, Address,
and the Sector Count.
When the controller receives this RPMB Data Frame, that controller first checks the Address. If there is an
error in the Address, then the result is set to 0004h (address failure) and the data read is not valid.
When the host receives a successful completion of the Security Send command from the controller, that
host should send a Security Receive command to the controller to retrieve the data. The controller returns
an RPMB Data Frame with Response Message Type (0400h), the Sector Count, a copy of the Nonce
received in the request, the Address, the Data, the controller calculated MAC, and the Result. Note: It is
the responsibility of the host to verify the MAC returned on an Authenticated Data Read Request.
If the data transfer from the addressed location in the controller fails, the returned Result is 0006h (read
failure). If the Address provided in the Security Send command is not valid, then the returned Result is
0004h (address failure). If another error occurs during the read procedure, then the returned Result is 0001h
(general failure).


---
### ðŸ“Š Tables (1)

#### Table 1: Untitled Table
![Untitled Table](../section_images/table_642_128.png)

| 222-N:00 | Stuff Bytes | 0...00h |
|---|---|---|
| 222:222-(N-1) | MAC/Key | 0...00h |
| 223 | RPMB Target | RPMB target to access |
| 239:224 | Nonce | Nonce generated by the host |
| 243:240 | Write Counter | 00000000h |
| 247:244 | Address | Address in RPMB |
| 251:248 | Sector Count | Number of 512B blocks |
| 253:252 | Result | 0000h |
| 255:254 | Request/Response | 0004h (Request) |
| | | |
| **Data populated by the controller and returned to the host** | | |
| 222-N:00 | Stuff Bytes | 0...00h |
| 222:222-(N-1) | MAC/Key | MAC generated by the controller |
| 223 | RPMB Target | RPMB target response was sent from |
| 239:224 | Nonce | Copy of the Nonce generated by the host |
| 243:240 | Write Counter | 0000h |
| 247:244 | Address | Address in RPMB |
| 251:248 | Sector Count | Number of 512B blocks |
| 253:252 | Result | Result Code |
| 255:254 | Request/Response | 0400h (Response) |
| (M-1)+256:256 | Data | Data read from RPMB target |
| | | |
| | | |
| **Authenticated Device Configuration Block Write** | | |
| Authenticated Device Configuration Block Write is initiated by a Security Send command. The RPMB | | |
| frame delivered from the host to the controller includes the Request Message Type = 0006h, Sector | | |
| : 01h, MAC, Write Counter set to the current Write Counter value, and the RPMB Device | | |
| ation Block data structure (refer to Figure 699). All other fields are cleared to 0h. | | |
| Write Counter has expired, then that controller sets the result to 0005h (write failure, write counter | | |
| and no data is written to the Device Configuration Block. | | |

