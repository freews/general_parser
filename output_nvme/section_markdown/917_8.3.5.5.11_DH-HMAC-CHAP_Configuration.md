###### 8.3.5.5.11 DH-HMAC-CHAP Configuration

> **Section ID**: 8.3.5.5.11 | **Page**: 757-761

DH-HMAC-CHAP implementations that do not use an AVE (refer to section 8.3.5.6 for AVE information)
shall be able to be provisioned with their own DH-HMAC-CHAP secret and with a verification secret per
each remote entity that is able to be authenticated. DH-HMAC-CHAP implementations that use an AVE
shall be able to be provisioned with their own DH-HMAC-CHAP secret and the parameters for accessing
the AVE (refer to section 8.3.5.6.2).
This section uses the term configuration to indicate an NVMe internal state that controls the use of DH-
HMAC-CHAP. That internal state may or may not be externally configurable for a host or NVM subsystem.
For an NVMe/TCP implementation that supports DH-HMAC-CHAP, a DH-HMAC-CHAP configuration may
apply to:
â€¢
a single connection;
â€¢
a group of connections; or
â€¢
all connections.
DH-HMAC-CHAP implementations that do not support secure channel concatenation with the TLS protocol
shall support configuring use of DH-HMAC-CHAP using one or more of the configurations shown in Figure
804.
NVM subsystems that do not support secure channel concatenation with the TLS protocol shall set the ATR
and ASCR bits in the AUTHREQ field in the response of a successful Connect command (refer to Figure
582) as defined in Figure 805.
Hosts that do not support secure channel concatenation with the TLS protocol shall behave as defined in
Figure 806, according to the ATR and ASCR bits in the AUTHREQ field received in the response of a
successful Connect command (refer to Figure 582).
NVM subsystems that do not support secure channel concatenation with the TLS protocol shall behave as
defined in Figure 807, according to the SC_C field in a received AUTH_Negotiate message (refer to section
8.3.5.4.1).
For example, consider a host that supports DH-HMAC-CHAP without secure channel concatenation with
the TLS protocol configured with Authentication Permitted and an NVM subsystem that supports DH-
HMAC-CHAP without secure channel concatenation with the TLS protocol configured with Authentication
Required. As defined in Figure 805, the NVM subsystem clears the ASCR bit to â€˜0â€™ and sets the ATR bit to
â€˜1â€™ in the Connect response. As defined in Figure 806, upon receiving the Connect response the host begins
an authentication transaction with the SC_C field set to NOSC. As defined in Figure 807, the NVM
subsystem participates in the authentication transaction.
DH-HMAC-CHAP implementations that support secure channel concatenation with the TLS protocol shall
support configuring use of DH-HMAC-CHAP with secure channel concatenation with the TLS protocol using
one or more of the configurations shown in Figure 808.
NVM subsystems that support secure channel concatenation with the TLS protocol shall set the ATR and
ASCR bits in the AUTHREQ field in the response of a successful Connect command on an Admin Queue
over a TCP channel without TLS (refer to Figure 582) as defined in Figure 809.
Hosts that support secure channel concatenation with the TLS protocol shall behave as defined Figure 810,
according to the ATR and ASCR bits in the AUTHREQ field received in the response of a successful
Connect command on an Admin Queue over a TCP channel without TLS (refer to Figure 582).
NVM subsystems that support secure channel concatenation with the TLS protocol shall behave as defined
in Figure 811, according to the SC_C field in a received AUTH_Negotiate message on an Admin Queue
over a TCP channel without TLS (refer to section 8.3.5.4.1).
As an example, consider a host that supports DH-HMAC-CHAP with secure channel concatenation with
the TLS protocol configured with Authentication Permitted, TLS Permitted and an NVM subsystem that
supports DH-HMAC-CHAP with secure channel concatenation with the TLS protocol configured with
Authentication Required, TLS Required. As defined in Figure 809, the NVM subsystem sets the ASCR bit
to â€˜1â€™ and clears the ATR bit to â€˜0â€™ in the Connect response. As defined in Figure 810, upon receiving the
Connect response the host begins an authentication transaction with the SC_C field set to NEWTLSPSK.
As defined in Figure 811, the NVM subsystem participates in the authentication transaction and establishes
a TLS channel.


---
### ðŸ“Š Tables (12)

#### Table 1: Untitled Table
![Untitled Table](../section_images/table_757_488.png)

| | | | |
| :--- | :--- | :--- | :--- |
| | TLS Disabled | | |
| | | | If the TASC field in the Discovery Log Page Entry for the remote entity is cleared to 00b or set to 11b or if no Discovery Log Page Entry for the remote entity has been retrieved, then do not begin an authentication transaction. |
| | | 0 | 1 |
| | | | Begin an authentication transaction with the SC_C field set to NOSC |
| | | 1 | any |
| | | | Disconnect from the NVM subsystem |
| | | | |
| | | | |
| | | | |
| | | | |
| | | | |
| | | | |
| | | | |
| :--- | :--- | :--- | :--- |
| | | NOSC | Participate in the authentication transaction |
| TLS Disabled | NEWTLSPSK or REPLACETLSPSK | | Disconnect from the host |
| | NOSC | | Participate in the authentication transaction |
| TLS Permitted | NEWTLSPSK | | Participate in the authentication transaction and establish a TLS channel as described in section 8.3.5.3 |
| | REPLACETLSPSK | | Disconnect from the host |
| | NOSC or REPLACETLSPSK | | Disconnect from the host |
| TLS Required | NEWTLSPSK | | Participate in the authentication transaction and establish a TLS channel as described in section 8.3.5.3 |


#### Table 2: Untitled Table
![Untitled Table](../section_images/table_757_643.png)

(Continuation of Untitled Table - see first part)


#### Table 3: Untitled Table
![Untitled Table](../section_images/table_757_799.png)

(Continuation of Untitled Table - see first part)


#### Table 4: Untitled Table
![Untitled Table](../section_images/table_758_128.png)

(Continuation of Untitled Table - see first part)


#### Table 5: Untitled Table
![Untitled Table](../section_images/table_758_421.png)

(Continuation of Untitled Table - see first part)


#### Table 6: Untitled Table
![Untitled Table](../section_images/table_758_740.png)

(Continuation of Untitled Table - see first part)


#### Table 7: Untitled Table
![Untitled Table](../section_images/table_759_128.png)

(Continuation of Untitled Table - see first part)


#### Table 8: Untitled Table
![Untitled Table](../section_images/table_759_321.png)

(Continuation of Untitled Table - see first part)


#### Table 9: Untitled Table
![Untitled Table](../section_images/table_759_518.png)

(Continuation of Untitled Table - see first part)


#### Table 10: Untitled Table
![Untitled Table](../section_images/table_760_128.png)

(Continuation of Untitled Table - see first part)


#### Table 11: Untitled Table
![Untitled Table](../section_images/table_760_600.png)

(Continuation of Untitled Table - see first part)


#### Table 12: Untitled Table
![Untitled Table](../section_images/table_761_128.png)

(Continuation of Untitled Table - see first part)

