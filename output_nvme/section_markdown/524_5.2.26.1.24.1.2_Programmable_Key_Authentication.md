###### 5.2.26.1.24.1.2 Programmable Key Authentication

> **Section ID**: 5.2.26.1.24.1.2 | **Page**: 449-449

Programmable Key Authentication (refer to the PKAS bit in Figure 285) provides the means to unfreeze a
currently frozen personality using an HMAC that is calculated using a key that is derived from a host-
programmable key (i.e., Derived HMAC Key (DHK)) as described in section 8.1.6.3.1. The DHK is only able
to be programmed in the NVM subsystem if there is no DHK programmed. If there is a DHK programmed,
then that DHK is able to be purged by submitting a Set Features command that specifies the Manufacturing
Default Personality (refer to section 5.2.26.1.24.2). If a personality supports Programmable Key
Authentication and:
•
a DHK has not been programmed, then that personality is able to be frozen, but not unfrozen; or
•
a DHK has been programmed, then that personality is able to be frozen and unfrozen.
Protecting a frozen personality from being unfrozen, unless authenticated by the DHK, is enabled by
programming a DHK. The programming of the DHK (refer to section 8.1.6.3) should be done in a secure
environment (e.g., as part of the manufacturing process).
The DHK is utilized to sign security personality authenticated requests (refer to section 8.1.6.2.2) sent to
the controller using a Hash-based Message Authentication Code (HMAC) generated according to the CDP
Authentication Algorithm specified by the host and supported by the controller (refer to the CDPALG field
in Figure 328).
Use of a random number (i.e., random nonce) provides additional protection against replay of authenticated
requests where authenticated requests are recorded and played back later by an attacker (refer to section
8.1.1.1).
