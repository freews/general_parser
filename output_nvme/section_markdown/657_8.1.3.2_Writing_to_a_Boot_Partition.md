##### 8.1.3.2 Writing to a Boot Partition

> **Section ID**: 8.1.3.2 | **Page**: 548-549

Boot Partition contents may be modified by the host using the Firmware Image Download and Firmware
Commit commands while the controller is enabled (CC.EN set to ‘1’).
The process for updating a Boot Partition is:
1. The host issues a Firmware Image Download command to download the contents of the Boot
Partition to a controller. There may be multiple portions of the Boot Partition to download, thus the
offset for each portion of the Boot Partition being downloaded is specified in the Firmware Image
Download command. A host shall send the Boot Partition image in order starting with the beginning
of the Boot Partition;
2. The host transitions the Boot Partition that is to be updated to the Write Unlocked State (refer to
section 8.1.3.3);
3. The host submits a Firmware Commit command (refer to section 5.2.8) on that controller with a
Commit Action of 110b which specifies that the downloaded image replaces the contents of the
Boot Partition specified in the Boot Partition ID field;
4. The controller completes the Firmware Commit command. The following actions are taken in
certain error scenarios:
a. If the firmware activation was not successful because the Boot Partition could not be written,
then the controller reports an error of Boot Partition Write Prohibited;
5. (Optional) The host reads the contents of the Boot Partition to verify they are correct (refer to section
8.1.3.1). A host updates the active Boot Partition ID by issuing a Firmware Commit command with
a Commit Action of 111b; and
6. The host transitions the Boot Partition to either the Write Locked State or Write Locked Until Power
Cycle State to prevent further modification (refer to section 8.1.3.3).
If an internal error, reset, or power loss condition occurs while committing the downloaded image to a Boot
Partition, the contents of the Boot Partition may contain the old contents, new contents, or a mixture of both.
A host should verify the contents of a Boot Partition before marking that Boot Partition active to ensure the
active Boot Partition is stable.
A host should not read the contents of a Boot Partition while writing to the Boot Partition. The controller
may return a combination of new and old data if the host attempts to perform a Boot Partition read operation
while overwriting the contents.
A host should not overlap firmware/boot partition image update command sequences (refer to section
1.5.42). During a boot partition image update command sequence, if a Firmware Image Download
command or a Firmware Commit command is submitted for another firmware/boot partition image update
command sequence, the results of both that command and the in-progress firmware image update are
undefined.
A host should use the same controller or Management Endpoint (refer to the NVM Express Management
Interface Specification) for all commands that are part of a boot partition image update command sequence.
If the commands for a single firmware/boot partition image update command sequence are submitted to
more than one controller and/or Management Endpoint, the controller may abort the Firmware Commit
command with Invalid Firmware Image status.
