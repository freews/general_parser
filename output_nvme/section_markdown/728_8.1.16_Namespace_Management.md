#### 8.1.16 Namespace Management

> **Section ID**: 8.1.16 | **Page**: 605-606

The Namespace Management capability consists of the Namespace Management command (refer to
section 5.2.21) and the Namespace Attachment command (refer to section 5.2.20). The Namespace
Management command is used to create a namespace or delete a namespace. The Namespace
Attachment command is used to attach and detach controllers from a namespace. The Namespace
Management capability is intended for use during manufacturing or by a system administrator.
In addition to the Namespace Management capability, there are other events and capabilities that are able
to affect the number of namespaces that exist within an NVM subsystem (e.g., the Capacity Management
capability as described in section 8.1.4).
If the Namespace Management capability is supported, then the controller:
a) shall support the Namespace Management command and the Namespace Attachment
command;
b) shall set the NMS bit to ‘1’ in the OACS field (refer to Figure 328);
c) shall support the Attached Namespace Attribute Changed asynchronous event (refer to Figure
154 and section 5.2.26.1.5);
d) should support the Allocated Namespace Attribute Changed asynchronous event (refer to
Figure 154 and section 5.2.26.1.5); and
e) may support Namespace Granularity (refer to the NVM Express NVM Command Set
Specification).
A controller may support the Namespace Attachment command without supporting the Namespace
Management command. Such a controller:
a) shall not set the Namespace Management Supported (NMS) bit to ‘1’ in the OACS field (refer
to Figure 328); and
b) should support the Namespace Attribute Change asynchronous event.
If a namespace is detached from a controller, then the NSID that referred to that namespace becomes an
inactive NSID (refer to section 3.2.1.4) on that controller. If a namespace is deleted from the NVM
subsystem, then the NSID that referred to that namespace becomes an unallocated NSID (refer to section
3.2.1.3) in the NVM subsystem. Previously submitted but uncompleted or subsequently submitted
commands to the affected NSID are handled by the controller as if they were issued to an inactive NSID
(refer to Figure 92).
The size of a namespace that contains formatted storage is based on the size requested in a create
operation, the format of the namespace, and any characteristics (e.g., endurance). The controller
determines the NVM capacity allocated for that namespace. Namespaces may be created with different
usage characteristics (e.g., endurance) that utilize differing amounts of NVM capacity. Namespace
characteristics and the mapping of these characteristics to NVM capacity usage are outside the scope of
this specification.
Reporting of capacity information for the NVM subsystem, Domain, Endurance Group, and NVM Set are
described in section 3.8. For each namespace that contains formatted storage, the NVM Set and the
Endurance Group that contain the namespace are reported in the Identify Namespace data structure. The
NVM Set to be used for a namespace that contains formatted storage is based on the value in the NVM
Set Identifier field in a create operation. If the NVM Set Identifier field is cleared to 0h in a create operation
for a namespace that contains formatted storage, then the controller shall choose the NVM Set from which
to allocate capacity to create that namespace.
If the NVM Set Identifier field and the Endurance Group Identifier field are both cleared to 0h in a create
operation for a namespace that contains formatted storage, then the controller shall choose the Endurance
Group and the NVM Set from which to allocate capacity to create that namespace.
If the NVM Set Identifier field is cleared to 0h and the Endurance Group Identifier field is set to a non-zero
value in a create operation for a namespace that contains formatted storage, then the controller shall
choose the NVM Set in the specified Endurance Group from which to allocate capacity to create that
namespace.
If the NVM Set Identifier field is set to a non-zero value and the Endurance Group Identifier field is cleared
to 0h in a create operation for a namespace that contains formatted storage, then the controller shall abort
the command with a status code of Invalid Field in Command.
If the NVM Set Identifier field and the Endurance Group Identifier field are both set to non-zero values in a
create operation for a namespace that contains formatted storage and the specified NVM Set exists in the
specified Endurance Group, then the controller shall allocate capacity for that created namespace from the
specified NVM Set.
If the NVM Set Identifier field and the Endurance Group Identifier field are both set to non-zero values in a
create operation for a namespace that contains formatted storage and the specified NVM Set does not exist
in the specified Endurance Group, then the controller shall abort the command with a status code of Invalid
Field in Command.
For each namespace that contains formatted storage, the NVM capacity used for that namespace is
reported in the Identify Namespace data structure (refer to the applicable NVM Express I/O Command Set
specification). The controller may allocate NVM capacity in units such that the requested size for a
namespace that contains formatted storage may be rounded up to the next unit boundary. The units in
which NVM capacity is allocated are reported in the Namespace Granularity List (refer to the NVM Express
NVM Command Set Specification), if supported. For example, when using the NVM Command Set, if the
host requests a namespace of 32 logical blocks with a logical block size of 4 KiB for a total size of 128 KiB
and the allocation unit for the implementation is 1 MiB, then the NVM capacity consumed may be rounded
up to 1 MiB. The NVM capacity fields may not correspond to the logical block size multiplied by the total
number of logical blocks.
The method of allocating ANA Group identifiers is outside the scope of this specification. If the ANA Group
Identifier (refer to Figure 335 and the Identify Namespace data structure in the NVM Express NVM
Command Set Specification) is cleared to 0h, then the controller shall determine the ANAGRPID that is
assigned to that namespace.
