### 11.1 Basic Security Requirements

> **Section ID**: 11.1 | **Page**: 97-101


---
### ðŸ“Š Tables (1)

#### Table 1: Table_11_1_Basic_Security_Requirements
![Table_11_1_Basic_Security_Requirements](../section_images/Table_11_1_Basic_Security_Requirements.png)

| Requirement ID | Description |
| :--- | :--- |
| SEC-1 | The device shall support signed firmware binary update which is checked before firmware is activated. The device firmware shall be authenticated using cryptographic keys on every reboot and during firmware update. |
| SEC-2 | The device shall support XTS-AES-256 or AES-256 hardware-based data encryption or better. |
| SEC-3 | The device shall support anti-rollback protection for firmware. The anti-rollback protection shall be implemented with a security version which is different than the firmware version. If the security version of the firmware being activated is greater or equal to the current security version the firmware may be activated. If the security version of the firmware being activated is not equal or greater than the firmware being activated the firmware update shall fail. |
| SEC-4 | The device shall support Crypto Erase (see NVMe-AD-5 (support Format NVM) and NVMe-AD-7 (support Sanitize)). |
| SEC-5 | The device shall support Secure Boot (see Section 11.2 Secure Boot). |
| SEC-6 | The device shall have a method of identifying a secure boot failure which does not require physical access to the device. |
| SEC-7 | The device's cryptographic module shall be FIPS 140-3 capable per CMVP and shall follow the NIST 800-90 (A, B and C) specification. |
| SEC-8 | The device shall implement only FIPS and NIST approved implementations and algorithms. |
| SEC-9 | The device shall support Key revocation allowing a new key to be used for firmware validation on update. Preferred implementation is to allow for up to 3 key revocations. |
| SEC-10 | The device shall support Opal v2.01 with mandatory support for the Locking feature, the Opal SSC feature, and the Datastore Table feature. |
| SEC-11 | The device shall support Single User Mode feature set Version 1.00, revision 1.00. |
| SEC-12 | The device shall support Configurable Namespace Locking (CNL) feature set Version 1.00, revision 1.00 with mandatory support for the Namespace Global Range Locking object. The Namespace Non-Global Range Locking object may be supported. |
| SEC-13 | For some models, the IEEE 1667 silo will be required for eDrive support. |
| SEC-14 | Supplier shall follow the Security Development Lifecycle (SDL), and provide a report with the following for each qualification-ready or production-ready firmware version:<br>â€¢ The Threat Model.<br>â€¢ Fuzz & Pen Tests.<br>â€¢ Static Analysis.<br>â€¢ Build Logs and Compiler Security Settings.<br>Additional information about the SDL is available here: https://www.microsoft.com/en-us/sdl/default.aspx |
| SEC-15 | Security audits, including firmware source code review, shall be provided to the customer. This will include Telemetry and debug logs, etc. |
| SEC-16 | All signing keys shall be stored in a Hardware Security Module (HSM) that is either FIPS 140-2 Level 3 (or greater) certified or FIPS 140-3 Level 3 (or greater) certified. |
| SEC-17 | Access/use of signing keys should be restricted to a small set of developers, following the principle of least privilege. Number of people with access and their corresponding roles shall be provided. |
| SEC-18 | All debug ports shall be disabled before the device leaves the factory. Alternatively, the ports shall only be accessible in the field after a successful exchange of a challenge-response mechanism using an asymmetric crypto scheme (refer to NIST SP 800-63). The state shall be reset to inaccessible on any reset or power cycle. |
| SEC-19 | All vendor unique commands, log pages or set features that are not explicitly defined in this specification or approved of in writing by the customer shall be disabled before the device leaves the factory. Alternatively, the commands/log pages/set features shall only be accessible in the field after a successful exchange of a challenge-response mechanism using an asymmetric crypto scheme (refer to NIST SP 800-63). The state shall be reset to inaccessible on any reset or power cycle. |
| SEC-20 | Adversarial testing using red teams shall be conducted before qualification start. A report of items attempted, and results shall be provided to the customer. |
| SEC-21 | Vendor shall provide timely notification to the customer of security issues and delivery of fixes to the customer:<br>â€¢ Vendor shall document all security fixes with each firmware update.<br>â€¢ Vendor shall notify end customer within 7 days of discovering security issues in the device hardware or firmware.<br>â€¢ Notification of issues shall include the process and timeline of the vendor's commitment to fix the issue:<br>â€ƒâ—‹ For privately disclosed vulnerabilities, the duration shall be no longer than 90 days.<br>â€ƒâ—‹ For publicly disclosed vulnerabilities, the duration shall be no longer than 7 days.<br>â€ƒâ—‹ Vendors shall notify the customers about the known CVEs and security issues and provide security-related updates before public announcement. |
| SEC-22 | All Telemetry and debugging logs shall be human readable. |
| SEC-23 | The device shall not include user data, passwords, keys and any secret or sensitive information in any Telemetry or debug logs. |
| SEC-24 | All public keys shall be revocable. |
| SEC-25 | Secure Boot Flow shall be based upon immutable firmware and Root Key. All mutable key(s), Certificate(s) and/or firmware shall be cryptographically bound to the immutable firmware and Root Key. |
| SEC-26 | Secure firmware update flow shall be immutable from exploitation and use immutable public keys. |
| SEC-27 | If the Opal SP has been activated and the host has supplied a band password, the device shall use that password as an added source of randomness for its Deterministic Random Number Generator (DRNG). For example, the device may use KDF (PBKDF2) on the user provided band password to generate an output of equal length to the required band key length plus DRNG seed length. This output can then be utilized in parts, one part as Opal band key and the other part as an additional input to the DRNG implementation does not allow taking additional input, then an alternate option would be to XOR this output (e.g., from PBKDF2 operation) with initial DRNG seed. |
| SEC-28 | The device shall delete all keys from volatile memory as soon as they are no longer needed for operation during the current power on state. |
| SEC-29 | The device shall only store host provided passwords, host provided keys, or any host provided secret information in non-volatile memory at any stage in an encrypted form. The encryption key for this protection shall not be stored in non-volatile memory. Device shall not store plaintext/cleartext secrets in any non-volatile memories. |
| SEC-30 | The supplier must deliver key management and encryption flow diagram details (not source code) which includes:<br>â€¢ Encryption algorithms and modes (e.g., RNG, wrapping function, key derivation function).<br>â€¢ Key size and password length.<br>â€¢ Any crypto information that is stored in nonvolatile memory.<br>â€¢ Critical Security Parameters.<br>Complete details about algorithm inputs (e.g., Initialization vector source and size, salt source and size, unique per device/product line/vendor) |
| SEC-31 | The supplier must provide industry certification reports, if available, such as FIPS, NIST for device and device components such as TRNG, RNG, Crypto engine etc. |
| SEC-32 | Log data and user data (data transferred from the Host in Write Commands) shall be stored on physically separate areas on the device. For example, in the system area and the user data area, respectively. |
| SEC-33 | The vendor shall provide a comprehensive list of what is and what is not in the logs. |
| SEC-34 | The device supplier shall develop and make available to the customer a software implementation of the device's crypto algorithm functionality for verification. |
| SEC-35 | All telemetry and debug logs shall only be writable by device firmware after a successful secure boot. |
| SEC-36 | The device shall set the default TryLimit to 5 for all Opal authorities. The value of the Tries column shall only be cleared to 0 after a power cycle. |
| SEC-37 | TCG Opal devices shall support TCG Opal configuration (e.g., Level 0 discovery, ownership, etc.) through the SMBus interface via the NVME-MI Security Send and Security Receive NVMe Admin commands.<br>This shall be supported even when the PCIe Links are not active (e.g., PERS# is asserted, secondary bus reset). |
| SEC-38 | The device shall support TCG Feature Set: Block SID Authentication. |

