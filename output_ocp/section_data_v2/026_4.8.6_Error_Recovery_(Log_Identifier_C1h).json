{
  "section_index": 26,
  "section_id": "4.8.6",
  "title": "4.8.6 Error Recovery (Log Identifier C1h)",
  "level": 3,
  "pages": {
    "start": 21,
    "end": 25,
    "count": 5
  },
  "content": {
    "text": "Below are the requirements for the Error Recovery (Log Identifier C1h) AEN requirements:\nThis vendor-specific log page, C1h shall be 512 bytes with the following functional requirements and\nfield format:",
    "tables": [
      {
        "id": "table_21_764",
        "page": 21,
        "bbox": [
          120.0,
          764.0,
          936.0,
          905.0
        ],
        "image_path": "Table_4_8_6_Error_Recovery_Log_Identifier_C1h_1.png",
        "title": "Table_4_8_6_Error_Recovery_Log_Identifier_C1h_1",
        "merged_count": 2,
        "table_md": "| Requirement ID | Description |\n| :--- | :--- |\n| EREC-AEN-1 | If the device encounters a Panic condition, it shall complete an outstanding Asynchronous Event Request (AER) command with an Asynchronous Event Notification (AEN) with Completion Queue Dword 0 set as follows:<br>• The Log Page Identifier field shall be set to C1h.<br>• The Asynchronous Event Information field shall be cleared to zero. |\n| | • The Asynchronous Event Type field shall be set to 111b (Vendor Specific). |"
      },
      {
        "id": "table_22_222",
        "page": 22,
        "bbox": [
          119.0,
          222.0,
          933.0,
          905.0
        ],
        "has_intervening_text": true,
        "image_path": "Table_4_8_6_Error_Recovery_Log_Identifier_C1h_2.png",
        "title": "Table_4_8_6_Error_Recovery_Log_Identifier_C1h_2",
        "merged_count": 4,
        "table_md": "| Requirement ID | Byte Address | Field | # of Bytes | Field Description |\n| :--- | :--- | :--- | :--- | :--- |\n| EREC-1 | 1:0 | Panic Reset Wait Time | 2 | The amount of time the host should wait for the device panic workflow to complete in msec. |\n| EREC-2 | 2 | Panic Reset Action | 1 | Bit field indicating potential reset actions that may need to be taken. If no reset action needed, do not set any of the bits. More than 1 bit can be set, and it is up to the host to decide the sequence of action(s) to take. Use Bit 0 if possible. If Bit 0 is not possible use Bit 1, etc. <br> | |\n| | | | | <table><tbody><tr><th>Bit</th><th>Description</th></tr><tr><td>7:6</td><td>Reserved. Shall be cleared to zero.</td></tr><tr><td>5</td><td>PCIe Conventional Hot Reset.</td></tr><tr><td>4</td><td>Main Power Cycle.</td></tr><tr><td>3</td><td>PERST#.</td></tr><tr><td>2</td><td>PCIe Function Level Reset.</td></tr><tr><td>1</td><td>NVM Subsystem Reset.</td></tr><tr><td>0</td><td>NVMe Controller Reset.</td></tr></tbody></table> |\n| EREC-3 | 3 | Device Recovery Action 1 | 1 | The recovery action to take for handling a device panic condition. Value is dependent on the panic condition. Use 01h if possible. <br> | |\n| | | | | <table><tbody><tr><th>Bit</th><th>Description</th></tr><tr><td>7:6</td><td>Reserved. Shall be cleared to zero.</td></tr><tr><td>5</td><td>Sanitize Required.</td></tr><tr><td>4</td><td>Device Replacement Required.</td></tr><tr><td>3</td><td>Vendor Analysis Required.</td></tr><tr><td>2</td><td>Vendor Specific Command Required.</td></tr><tr><td>1</td><td>Format NVM Required (Any SES value, any supported combination of other parameters - PIL, PI, MSET, LBAF).</td></tr><tr><td>0</td><td>No Action Required.</td></tr></tbody></table> |\n| Requirement ID | Byte Address | Field | # of Bytes | Field Description |\n| :--- | :--- | :--- | :--- | :--- |\n| EREC-4 | 11:4 | Panic ID | 8 | ID to identify the panic condition encountered. A Zero value indicates no panic. Value is dependent on the panic condition. The following Panic ID values are reserved for Host defined fault codes for known panic conditions: <br> o 00000000_0000000h – 00000000_0000FFh <br> | |\n| | | | | <table><tbody><tr><th>Byte</th><th>Field Description</th></tr><tr><td>11:4</td><td>Panic ID definition:<ul><li>00000000_00000001h – Panic caused by flush failures or data loss during power loss handling.</li></ul></td></tr></tbody></table> |\n| EREC-5 | 15:12 | Device Capabilities | 4 | Field to indicate device capabilities. <br> | |\n| | | | | <table><tbody><tr><th>Bit</th><th>Description</th></tr><tr><td>31:2</td><td>Reserved. Shall be cleared to zero.</td></tr><tr><td>1</td><td>Panic CFS Supported: If set, indicates device supports using CFS to notify host of a panic condition*.</td></tr><tr><td>0</td><td>Panic AEN Supported: If set, indicates device supports using AEN to notify host of a panic condition*.</td></tr></tbody></table> |\n| | | | | *Note: It is valid for a device to indicate support for both Panic AEN Supported and Panic Controller Fatal Status Supported. If the device supports both, the device shall only use one of the panic notification mechanisms when reporting a given panic event. |\n| EREC-6 | 16 | Vendor Specific Recovery Opcode | 1 | Vendor specific command opcode to recover device from panic condition. Only valid when Device Recovery Action 1 field value is 02h. When Device Recovery Action 1 field value is not 02h, this field shall be cleared to zero. |\n| EREC-7 | 19:17 | Reserved | 3 | Shall be cleared to zero. |\n| EREC-8 | 23:20 | Vendor Specific Command CDW12 | 4 | CDW12 value for the Vendor Specific command to recover device from panic condition. Only valid when Device Recovery Action 1 field value is 02h. When Device Recovery Action 1 field value is not 02h, this field shall be cleared to zero. |\n| Requirement ID | Byte Address | Field | # of Bytes | Field Description |\n| :--- | :--- | :--- | :--- | :--- |\n| EREC-9 | 27:24 | Vendor Specific Command CDW13 | 4 | CDW13 value for the Vendor Specific command to recover device from panic condition. Only valid when Device Recovery Action 1 field value is 02h. When Device Recovery Action 1 field value is not 02h, this field shall be cleared to zero. |\n| EREC-13 | 28 | Vendor Specific Command Timeout | 1 | The amount of time the host should wait for the device to complete the recovery command in seconds. |\n| EREC-14 | 29 | Device Recovery Action 2 | 1 | Bit field indicating potential post reset actions that may need to be taken. If no reset action needed, do not set any of the bits. More than 1 bit can be set, and it is up to the host to decide the sequence of action(s) to take. Use Bit 0 if possible. If Bit 0 is not possible use Bit 1, etc. <br> | |\n| | | | | <table><tbody><tr><th>Bit</th><th>Description</th></tr><tr><td>7:6</td><td>Reserved. Shall be cleared to zero.</td></tr><tr><td>5</td><td>PCIe Conventional Hot Reset.</td></tr><tr><td>4</td><td>Main Power Cycle.</td></tr><tr><td>3</td><td>PERST#.</td></tr><tr><td>2</td><td>PCIe Function Level Reset.</td></tr><tr><td>1</td><td>NVM Subsystem Reset.</td></tr><tr><td>0</td><td>NVMe Controller Reset.</td></tr></tbody></table> |\n| EREC-15 | 30 | Device Recovery Action 2 Timeout | 1 | The amount of time the host should wait for the device to complete the Device Recovery Action 2 in seconds (overrides CAP.TO value). |\n| EREC-10 | 493:31 | Reserved | 463 | Shall be cleared to zero. |\n| EREC-11 | 495:494 | Log Page Version | 2 | This indicates the version of the mapping this log page uses. Shall be set to 0002h. |\n| EREC-12 | 511:496 | Log Page GUID | 16 | Shall be set to 5A1983BA3DFD4ABAE3430FE2131D944h. |\n| Requirement ID | Description |\n| :--- | :--- |\n| FWHST-LOG-1 | Lists the last twenty firmware images that were activated (not downloaded) on the device. This is a circular buffer where the 21st entry is placed in entry 0 (byte offset 8 decimal). |\n| FWHST-LOG-2 | When the device is first shipped from the factory, there are no entries recorded. |\n| FWHST-LOG-3 | A Firmware Activation History Entry shall be recorded as shown in the table below. Firmware downloads shall not generate an entry. <br> | |\n| | <table><tbody><tr><th>Commit Action</th><th>Response</th></tr><tr><td>000b</td><td>No Firmware Activation History Entry is recorded.</td></tr><tr><td>001b</td><td>A Firmware Activation History Entry is recorded after the next Controller Level Reset.</td></tr><tr><td>010b</td><td>A Firmware Activation History Entry is recorded after the next Controller Level Reset.</td></tr><tr><td>011b</td><td>A Firmware Activation History Entry is recorded immediately.</td></tr></tbody></table> |\n| FWHST-LOG-4 | Redundant activation events shall not generate a new entry to prevent the scrolling out of useful information. An entry shall not be considered redundant if it meets ALL the criteria below: <ol><li>Timestamp is within 1 minute from the last RECORDED entry; and</li><li>Power cycle count is the same; and</li><li>Current firmware is the same; and</li><li>New firmware activated is the same; and</li><li>Slot number is the same; and</li><li>Commit Action Type is the same; and</li><li>The Result field has not changed.</li></ol> |\n| FWHST-LOG-5 | Firmware Activation History's log page format shall follow the requirements below. |"
      }
    ],
    "figures": []
  },
  "statistics": {
    "table_count": 2,
    "figure_count": 0
  }
}