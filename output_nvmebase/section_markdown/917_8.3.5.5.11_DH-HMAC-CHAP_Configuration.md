###### 8.3.5.5.11 DH-HMAC-CHAP Configuration

> **Section ID**: 8.3.5.5.11 | **Page**: 757-761

DH-HMAC-CHAP implementations that do not use an AVE (refer to section 8.3.5.6 for AVE information)
shall be able to be provisioned with their own DH-HMAC-CHAP secret and with a verification secret per
each remote entity that is able to be authenticated. DH-HMAC-CHAP implementations that use an AVE
shall be able to be provisioned with their own DH-HMAC-CHAP secret and the parameters for accessing
the AVE (refer to section 8.3.5.6.2).
This section uses the term configuration to indicate an NVMe internal state that controls the use of DH-
HMAC-CHAP. That internal state may or may not be externally configurable for a host or NVM subsystem.
For an NVMe/TCP implementation that supports DH-HMAC-CHAP, a DH-HMAC-CHAP configuration may
apply to:
â€¢
a single connection;
â€¢
a group of connections; or
â€¢
all connections.
DH-HMAC-CHAP implementations that do not support secure channel concatenation with the TLS protocol
shall support configuring use of DH-HMAC-CHAP using one or more of the configurations shown in Figure
804.
NVM subsystems that do not support secure channel concatenation with the TLS protocol shall set the ATR
and ASCR bits in the AUTHREQ field in the response of a successful Connect command (refer to Figure
582) as defined in Figure 805.
Hosts that do not support secure channel concatenation with the TLS protocol shall behave as defined in
Figure 806, according to the ATR and ASCR bits in the AUTHREQ field received in the response of a
successful Connect command (refer to Figure 582).
NVM subsystems that do not support secure channel concatenation with the TLS protocol shall behave as
defined in Figure 807, according to the SC_C field in a received AUTH_Negotiate message (refer to section
8.3.5.4.1).
For example, consider a host that supports DH-HMAC-CHAP without secure channel concatenation with
the TLS protocol configured with Authentication Permitted and an NVM subsystem that supports DH-
HMAC-CHAP without secure channel concatenation with the TLS protocol configured with Authentication
Required. As defined in Figure 805, the NVM subsystem clears the ASCR bit to â€˜0â€™ and sets the ATR bit to
â€˜1â€™ in the Connect response. As defined in Figure 806, upon receiving the Connect response the host begins
an authentication transaction with the SC_C field set to NOSC. As defined in Figure 807, the NVM
subsystem participates in the authentication transaction.
DH-HMAC-CHAP implementations that support secure channel concatenation with the TLS protocol shall
support configuring use of DH-HMAC-CHAP with secure channel concatenation with the TLS protocol using
one or more of the configurations shown in Figure 808.
NVM subsystems that support secure channel concatenation with the TLS protocol shall set the ATR and
ASCR bits in the AUTHREQ field in the response of a successful Connect command on an Admin Queue
over a TCP channel without TLS (refer to Figure 582) as defined in Figure 809.
Hosts that support secure channel concatenation with the TLS protocol shall behave as defined Figure 810,
according to the ATR and ASCR bits in the AUTHREQ field received in the response of a successful
Connect command on an Admin Queue over a TCP channel without TLS (refer to Figure 582).
NVM subsystems that support secure channel concatenation with the TLS protocol shall behave as defined
in Figure 811, according to the SC_C field in a received AUTH_Negotiate message on an Admin Queue
over a TCP channel without TLS (refer to section 8.3.5.4.1).
As an example, consider a host that supports DH-HMAC-CHAP with secure channel concatenation with
the TLS protocol configured with Authentication Permitted, TLS Permitted and an NVM subsystem that
supports DH-HMAC-CHAP with secure channel concatenation with the TLS protocol configured with
Authentication Required, TLS Required. As defined in Figure 809, the NVM subsystem sets the ASCR bit
to â€˜1â€™ and clears the ATR bit to â€˜0â€™ in the Connect response. As defined in Figure 810, upon receiving the
Connect response the host begins an authentication transaction with the SC_C field set to NEWTLSPSK.
As defined in Figure 811, the NVM subsystem participates in the authentication transaction and establishes
a TLS channel.


---
### ðŸ“Š Tables (1)

#### Table 1: Table_8_3_5_5_11_DH_HMAC_CHAP_Configuration
![Table_8_3_5_5_11_DH_HMAC_CHAP_Configuration](../section_images/Table_8_3_5_5_11_DH_HMAC_CHAP_Configuration.png)

| Configuration | Description |
| :--- | :--- |
| Authentication Disabled | Authentication of a remote entity not allowed |
| Authentication Permitted | Authentication of a remote entity allowed |
| Authentication Required | Authentication of a remote entity required |
| Configuration | ASCR | ATR |
| :--- | :--- | :--- |
| Authentication Disabled | 0 | 0 |
| Authentication Permitted | 0 | 0 |
| Authentication Required | 0 | 1 |
| Host Configuration | ASCR | ATR | Action |
| :--- | :--- | :--- | :--- |
| Authentication Disabled | 0 | 0 | Do not begin an authentication transaction |
| | 0 | 1 | Disconnect from the NVM subsystem |
| | 1 | any | |
| Host Configuration | ASCR | ATR | Action |
| :--- | :--- | :--- | :--- |
| Authentication Permitted | 0 | 0 | If the TASC field in the Discovery Log Page Entry for the remote entity is set to 01b or set to 10b, then begin an authentication transaction with the SC_C field set to NOSC.<br>If the TASC field in the Discovery Log Page Entry for the remote entity is cleared to 00b or set to 11b or if no Discovery Log Page Entry for the remote entity has been retrieved, then do not begin an authentication transaction. |
| | 0 | 1 | Begin an authentication transaction with the SC_C field set to NOSC |
| | 1 | any | Disconnect from the NVM subsystem |
| Authentication Required | 0 | any | Begin an authentication transaction with the SC_C field set to NOSC |
| | 1 | any | Disconnect from the NVM subsystem |
| Subsystem Configuration | SC_C Value | Action |
| :--- | :--- | :--- |
| Authentication Disabled | Any | Disconnect from the host |
| Authentication Permitted | NOSC | Participate in the authentication transaction |
| | NEWTLSPSK or REPLACETLSPSK | Disconnect from the host |
| Authentication Required | NOSC | Participate in the authentication transaction |
| Configuration | Description |
| :--- | :--- |
| Authentication Disabled | TLS Disabled |
| Authentication Permitted | TLS Disabled |
| Authentication Required | TLS Permitted |
| Configuration | Description |
| :--- | :--- |
| Authentication Disabled | TLS Disabled |
| Authentication Permitted | TLS Disabled |
| Authentication Required | TLS Permitted |
| Configuration | ASCR | ATR |
| :--- | :--- | :--- |
| Authentication Disabled | TLS Disabled | 0 | 0 |
| Authentication Permitted | TLS Disabled | 0 | 0 |
| | TLS Permitted | 0 | 0 |
| Authentication Required | TLS Disabled | 0 | 1 |
| | TLS Permitted | 0 | 1 |
| | TLS Required | 1 | 0 |
| Host Configuration | ASCR | ATR | Action |
| :--- | :--- | :--- | :--- |
| Authentication Disabled | TLS Disabled | 0 | 0 | Do not begin an authentication transaction |
| | | 0 | 1 | Disconnect from the NVM subsystem |
| | | 1 | any | |
| Authentication Permitted | TLS Disabled | 0 | 0 | If the TASC field in the Discovery Log Page Entry for the remote entity is set to 01b or set to 10b, then begin an authentication transaction with the SC_C field set to NOSC.<br>If the TASC field in the Discovery Log Page Entry for the remote entity is cleared to 00b or set to 11b or if no Discovery Log Page Entry for the remote entity has been retrieved, then do not begin an authentication transaction. |
| | | 0 | 1 | Begin an authentication transaction with the SC_C field set to NOSC |
| | | 1 | any | Disconnect from the NVM subsystem |
| | TLS Permitted | 0 | 0 | If the TASC field in the Discovery Log Page Entry for the remote entity is set to 01b or set to 10b, then begin an authentication transaction with the SC_C field set to NOSC.<br>If the TASC field in the Discovery Log Page Entry for the remote entity is cleared to 00b or set to 11b or if no Discovery Log Page Entry for the remote entity has been retrieved, then do not begin an authentication transaction. |
| | | 0 | 1 | Begin an authentication transaction with the SC_C field set to NOSC |
| | | 1 | any | Begin an authentication transaction with the SC_C field set to NEWTLSPSK |
| | TLS Required | 0 | any | Begin an authentication transaction with the SC_C field set to NOSC |
| | | 1 | any | Disconnect from the NVM subsystem |
| | | 0 | any | Begin an authentication transaction with the SC_C field set to NOSC |
| | | 1 | any | Begin an authentication transaction with the SC_C field set to NEWTLSPSK |
| | | any | any | Begin an authentication transaction with the SC_C field set to NEWTLSPSK |
| Subsystem Configuration | SC_C Value | Action |
| :--- | :--- | :--- |
| Authentication Disabled | TLS Disabled | any | Disconnect from the host |
| Authentication Permitted | TLS Disabled | NOSC | Participate in the authentication transaction |
| | | NEWTLSPSK or REPLACETLSPSK | Disconnect from the host |
| | TLS Permitted | NOSC | Participate in the authentication transaction and establish a TLS channel as described in section 8.3.5.3 |
| | | NEWTLSPSK | |
| | | REPLACETLSPSK | Disconnect from the host |
| Subsystem Configuration | SC_C Value | Action |
| :--- | :--- | :--- |
| Authentication Required | TLS Disabled | NOSC | Participate in the authentication transaction |
| | | NEWTLSPSK or REPLACETLSPSK | Disconnect from the host |
| | | NOSC | Participate in the authentication transaction |
| | TLS Permitted | NEWTLSPSK | Participate in the authentication transaction and establish a TLS channel as described in section 8.3.5.3 |
| | | REPLACETLSPSK | Disconnect from the host |
| | TLS Required | NOSC or REPLACETLSPSK | Disconnect from the host |
| | | NEWTLSPSK | Participate in the authentication transaction and establish a TLS channel as described in section 8.3.5.3 |

