###### 8.1.26.4.2 Restricted Processing State

> **Section ID**: 8.1.26.4.2 | **Page**: 663-665

In this state, if the sanitize operation fails, then the sanitization target transitions to the Restricted Failure
state.
In this state:
a) the controller shall set the Sanitize Progress (SPROG) field, in the Sanitize Status log page for the
sanitization target, as described in Figure 302;
b) the controller shall perform additional media modification, if required, as described in section
8.1.26.2;
c) the controller should deallocate all media in the sanitization target that is allocated for user data, if
permitted, as described in section 8.1.26.2;
d) if a change in the composition of the NVM subsystem occurs then the MVCNCLD bit, in the Sanitize
Status log page for the sanitization target, shall be set to â€˜1â€™;
e)
if a Controller Level Reset of any controller in the NVM subsystem occurs that is caused by:
â€¢
a transport-specific reset type (refer to the applicable NVM Express Transport specification
applicable NVM Express Transport specification); or
â€¢
an NVM Subsystem Reset,
then the MVCNCLD bit, in the Sanitize Status log page for the sanitization target, shall be set to â€˜1;
f)
all controllers and Management Endpoints in the NVM subsystem shall process commands as
f)
all controllers and Management Endpoints in the NVM subsystem shall process commands as
described in section 8.1.26.5;
g)
if the sanitization target is the NVM subsystem then all controllers in the NVM subsystem shall
g) if the sanitization target is the NVM subsystem, then all controllers in the NVM subsystem shall
abort a:
â€¢
Sanitize command; and
â€¢
Sanitize Namespace command,
with a status code of Sanitize In Progress; and
h) if the sanitization target is a namespace, then all controllers in the NVM subsystem shall abort a:
â€¢
Sanitize command; and
â€¢
Sanitize Namespace command for the sanitization target associated with this state
machine,
with a status code of Sanitize Namespace In Progress.
The controller shall:
a) if the sanitization target is the NVM subsystem:
o
if the Sanitize Namespace command is not supported:
i. set the Global Data Erased (GDE) bit to â€˜1â€™ in the Sanitize Status log page for the
NVM subsystem; and
ii. set the Sanitize State (SANS) field to 0h (i.e., Idle state) in the Sanitize Status log
page for the NVM subsystem;
e Sanitize Namespace command is supported:
i. set the Global Data Erased (GDE) bit to â€˜1â€™ in every Sanitize Status log page;
ii. set the Namespace Data Erased (NDE) bit to â€˜1â€™ in the Sanitize Status log page for
each namespace that exists in the NVM subsystem; and
iii. set the SANS field to 0h (i.e., Idle state) in the Sanitize Status log page for the
NVM subsystem and each namespace that exists in the NVM subsystem;
b)
if the sanitization target is a namespace:
o
set the Namespace Data Erased (NDE) bit to â€˜1â€™ in the Sanitize Status log page for that
namespace; and
o
set the SANS field to 0h (i.e., Idle state) in the Sanitize Status log page for that namespace;
d
ort the Sanitize Operation Completed asynchronous event or the Sanitize Operation Completed
h Unexpected Deallocation asynchronous event as described in section 8 1 26 1
The controller shall:
a) set the FAILS field, in the Sanitize Status log page for the sanitization target, to 1h (i.e., Restricted
Processing state); and
b) report the Sanitize Operation Completed asynchronous event or the Sanitize Operation Completed
With Unexpected Deallocation asynchronous event as described in section 8.1.26.1.
The controller shall:
a) report the Sanitize Operation Entered Media Verification State asynchronous event as described
in section 8.1.26.1.


---
### ðŸ“Š Tables (1)

#### Table 1: Table_8_1_26_4_2_Restricted_Processing_State
![Table_8_1_26_4_2_Restricted_Processing_State](../section_images/Table_8_1_26_4_2_Restricted_Processing_State.png)

| State Transition |  |  | Transition Condition |
| :--- | :--- | :--- | :--- |
| Starting | Ending | LabelÂ¹ | |
| Restricted Processing | Idle | C1 | Sanitize processing completes successfully and the EMVS bit was:<br>a) cleared to '0' in the command that started the sanitize operation; or<br>b) set to '1' in the command that started the sanitize operation, the MVCNCLD bit is set to '1' in the Sanitize Status log page for the sanitization target, and deallocation of all media in the sanitization target that is allocated for user data completes successfully. |
| | Restricted Failure | D1 | Sanitize processing fails. |
| | Media Verification | F1 | The EMVS bit was set to '1' in the command that started the sanitize operation, the sanitize processing completes successfully, and the MVCNCLD bit is cleared to '0' in the Sanitize Status log page for the sanitization target. |
| Notes: | | | |
| | | 1. | Refer to Figure 706. |

