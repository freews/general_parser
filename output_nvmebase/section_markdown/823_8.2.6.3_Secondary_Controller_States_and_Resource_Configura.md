##### 8.2.6.3 Secondary Controller States and Resource Configuration

> **Section ID**: 8.2.6.3 | **Page**: 696-697

A secondary controller shall be in one of the following states:
•
Online: The secondary controller may be in use by a host. Required resources have been
assigned. The secondary controller may be enabled in this state (CC.EN may be set to ‘1’ and
CSTS.RDY may then transition to ‘1’); or
•
Offline: The secondary controller may not be used by a host. CSTS.CFS shall be set to ‘1’.
Controller properties other than CSTS are undefined in this state.
The host may request a transition to the Online or Offline state using the Virtualization Management
command. When a secondary controller transitions from the Online state to the Offline state all Flexible
Resources are removed from the secondary controller.
To ensure that the host accurately detects capabilities of the secondary controller, the host should complete
the following procedure to bring a secondary controller Online:
If VI Resources are supported, then following this process ensures the MSI-X Table size indicated by
MSIXCAP.MXC.TS is updated to reflect the appropriate number of VI Resources before the transition to
the Online state.
A primary controller or secondary controller is enabled when CC.EN and CSTS.RDY are both set to ‘1’ for
that controller. A secondary controller is able to be enabled only when in the Online state. If the primary
controller associated with a secondary controller is disabled or undergoes a Controller Level Reset, then
the secondary controller shall implicitly transition to the Offline state. A secondary controller shall transition
to the Offline state when a shutdown occurs (refer to section 3.6, section 3.1.4.5, and section 3.1.4.20) on
the primary controller associated with that secondary controller.
Resources shall only be assigned to a secondary controller when in the Offline state. If the minimum number
of resources are not assigned to a secondary controller, then a request to transition to the Online state shall
fail for that secondary controller. For implementations that support SR-IOV, if VF Enable is cleared to ‘0’ or
NumVFs specifies a value that does not enable the associated secondary controller, then the secondary
controller shall implicitly transition to the Offline state.
