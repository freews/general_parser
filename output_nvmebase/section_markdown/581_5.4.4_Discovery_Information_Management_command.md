#### 5.4.4 Discovery Information Management command

> **Section ID**: 5.4.4 | **Page**: 492-499

The Discovery Information Management command registers, de-registers, or updates discovery information
entries.
The type of task performed by the Discovery Information Management command (i.e., registration, de-
registration, or update) is determined by the value set in Task (TAS) field of Command Dword 10 (refer to
Figure 530).
For a register task (i.e., TAS field cleared to 0h), the Discovery Information Management command
registers:
‚Ä¢
one or more host discovery information entries; or
‚Ä¢
one or more NVM subsystem discovery information entries.
For a de-register task (i.e., TAS field set to 1h), the Discovery Information Management command de-
registers:
‚Ä¢
one or more host discovery information entries; or
‚Ä¢
one or more NVM subsystem discovery information entries.
For an update task (i.e., TAS field set to 2h), the Discovery Information Management command updates:
‚Ä¢
one host discovery information entry; or
‚Ä¢
one NVM subsystem discovery information entry.
Discovery information entries may be one of the following:
‚Ä¢
a basic discovery information entry (refer to Figure 310); or
‚Ä¢
an extended discovery information entry (refer to Figure 532).
Host discovery information entries shall be extended discovery information entries.
NVM subsystem discovery information entries may be basic discovery information entries or may be
extended discovery information entries. Each NVM subsystem discovery information entry may specify an
NVM subsystem that exposes namespaces that hosts may access or may specify a referral to another
Discovery subsystem.
The Discovery Information Management command uses the Data Pointer field as shown in Figure 529 and
Command Dword 10 as shown in Figure 530. All other command specific fields are reserved.
The data portion of the Discovery Information Management command contains a header that identifies the
entity performing the register, de-register, or update task.
If a register task is being performed and the data portion of the Discovery Information Management
command does not contain one or more discovery information entries, then the controller shall abort the
command with status code of Invalid Field in Command. If the number of discovery information entries
contained in the data portion of the Discovery Information Management command exceeds the available
capacity for new discovery information entries on the CDC or DDC, then the controller shall abort the
command with a status code of Insufficient Discovery Resources. If multiple register tasks are performed
by the same entity (i.e., the value set in the Entity Identifier (EID) field of the header is associated with an
existing registration record contained in the CDC or DDC), and:
a) the Entry Key associated with a discovery information entry in the Discovery Information
Management command matches the Entry Key associated with an existing registration record, then
the existing registration record contained in the CDC or DDC shall be updated with the discovery
information entry from the Discovery Information Management command; or
b) the Entry Key associated with a discovery information entry in the Discovery Information
Management command does not match the Entry Key associated with an existing registration
record, then the discovery information entry in the Discovery Information Management command
shall be registered with the CDC or DDC.
If a de-register task is being performed and the data portion of the Discovery Information Management
command does not contain one or more discovery information entries, then the controller shall abort the
command with a status code of Invalid Field in Command.
If an update task is being performed and the data portion of the Discovery Information Management
command does not contain two discovery information entries, then the controller shall abort the command
with a status code of Invalid Field in Command. The first discovery information entry identifies the
registration record contained in the CDC or DDC that is to be updated. The fields in the first discovery
information entry that are not used as part of the Entry Key are ignored. The second discovery information
entry replaces the existing registration record identified by the Entry Key from the first discovery information
entry. The update task shall be atomic.
The format for the data portion of the Discovery Information Management command is defined in Figure
531.
Based upon the value set in the Entity Type (ETYPE) field of the header, the data portion of a Discovery
Information Management command shall:
‚Ä¢
only contain host extended discovery information entries if the ETYPE field is set to 1h (i.e., a host
is performing the register, de-register, or update task);
‚Ä¢
only contain host extended discovery information entries if the ETYPE field is set to 3h (i.e., a CDC
is performing the register, de-register, or update task); and
‚Ä¢
only contain NVM subsystem basic discovery information entries or NVM subsystem extended
discovery information entries if the ETYPE field is set to 2h (i.e., a DDC is performing the register,
de-register, or update task). The DDC may set the Port Local (PORTLCL) field to 1h if the NVM
subsystem discovery information entries being registered, de-registered, or updated are only for
NVM subsystem ports that are presented through the same NVM subsystem port on the DDC that
is performing the register, de-register, or update task.
Host extended discovery information entries and NVM subsystem extended discovery information entries
each contain the same set of fields, but not all of the fields are used for both extended discovery information
entry types. Refer to Figure 534 for the usage of the extended discovery information entry fields for each
extended discovery information entry type. If the entity performing a register, de-register, or update task
uses any field in an extended discovery information entry that conflicts with the value set in the ETYPE field
of the Discovery Information Management command data portion‚Äôs header (e.g., a host uses a field
intended for only NVM subsystem extended discovery information entries), then the controller shall abort
the command with a status code of Invalid Discovery Information.
Host extended discovery information entries shall contain at least one extended attribute containing a Host
Identifier. NVM subsystem extended discovery information entries may contain zero or more extended
attributes. The format for an extended attribute is defined in Figure 533.


---
### üñºÔ∏è Figures (6)

#### Figure 1: Figure 529: Discovery Information Management ‚Äì Data Pointer
![Figure 529: Discovery Information Management ‚Äì Data Pointer](../section_images/Figure_5_4_4_Discovery_Information_Management_command_1.png)


#### Figure 2: Figure 530: Discovery Information Management ‚Äì Command Dword 10
![Figure 530: Discovery Information Management ‚Äì Command Dword 10](../section_images/Figure_5_4_4_Discovery_Information_Management_command_2.png)


#### Figure 3: Figure 531: Discovery Information Management ‚Äì Data
![Figure 531: Discovery Information Management ‚Äì Data](../section_images/Figure_5_4_4_Discovery_Information_Management_command_3.png)


#### Figure 4: Figure 532: Extended Discovery Information Entry
![Figure 532: Extended Discovery Information Entry](../section_images/Figure_5_4_4_Discovery_Information_Management_command_4.png)


#### Figure 5: Figure 533: Extended Attribute
![Figure 533: Extended Attribute](../section_images/Figure_5_4_4_Discovery_Information_Management_command_5.png)


#### Figure 6: Figure 534: Extended Discovery Information Entry ‚Äì Applicable Fields
![Figure 534: Extended Discovery Information Entry ‚Äì Applicable Fields](../section_images/Figure_5_4_4_Discovery_Information_Management_command_6.png)

