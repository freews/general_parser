###### 8.3.5.5.2 DH-HMAC-CHAP Authentication Protocol Descriptor

> **Section ID**: 8.3.5.5.2 | **Page**: 748-750

The authentication protocol descriptor for DH-HMAC-CHAP (refer to section 8.3.5.4.1) is shown in Figure
797.
The one-way hash functions used by DH-HMAC-CHAP are shown in Figure 798.
The SHA-256 hash function shall be supported. Use of the SHA-256 hash function may be prohibited by
the requirements of security policies that are not defined by NVM Express (e.g., CNSA 1.0 requires use of
SHA-384).
Upon receiving an AUTH_Negotiate message, if the HashIDList proposed by the host does not satisfy the
security requirements of the controller (e.g., the host proposed SHA-256, but the controller‚Äôs security policy
requires a SHA-384 hash), then the controller shall:
‚Ä¢
reply to the AUTH_Negotiate message with an AUTH_Failure1 message having reason code
‚ÄòAuthentication failure‚Äô and reason code explanation ‚ÄòHash function not usable‚Äô; and
‚Ä¢
disconnect the NVMe over Fabrics connection upon transmitting the AUTH_Failure1 message.
The Diffie-Hellman (DH) groups used by DH-HMAC-CHAP are shown in Figure 799.
The 00h identifier indicates that no Diffie-Hellman exchange is performed, which reduces the DH-HMAC-
CHAP protocol to the HMAC-CHAP protocol. The 00h identifier shall not be proposed in an
AUTH_Negotiate message that requests secure channel concatenation (i.e., with the SC_C field set to a
non-zero value).
The 2048-bit DH group and the 3072-bit DH group shall be supported. A mechanism shall be provided to
disable (i.e., prohibit) use of the 2048-bit DH group. Use of the 2048-bit DH group may be prohibited by the
requirements of security policies that are not defined by NVM Express (e.g., CNSA 1.0 requires use of a
3072-bit or larger DH group).
Upon receiving an AUTH_Negotiate message, if the DHgIDList proposed by the host:
‚Ä¢
does not satisfy the security requirements of the controller (e.g., the host proposed only the NULL
DH group, but the controller‚Äôs security policy requires a DH group whose size is 3072-bit or larger);
or
‚Ä¢
contains the NULL DH group (i.e., identifier 00h) and the AUTH_Negotiate message is requesting
secure channel concatenation (i.e., with the SC_C field set to a non-zero value),
then the controller shall:
‚Ä¢
reply to the AUTH_Negotiate message with an AUTH_Failure1 message having reason code
‚ÄòAuthentication failure‚Äô and reason code explanation ‚ÄòDH group not usable‚Äô; and
‚Ä¢
disconnect the NVMe over Fabrics connection upon transmitting the AUTH_Failure1 message.


---
### üñºÔ∏è Figures (2)

#### Figure 1: Figure 797: Authentication protocol descriptor for DH-HMAC-CHAP
![Figure 797: Authentication protocol descriptor for DH-HMAC-CHAP](../section_images/Figure_8_3_5_5_2_DH_HMAC_CHAP_Authentication_Protocol_Descriptor_1.png)


#### Figure 2: Figure 798: DH-HMAC-CHAP hash function identifiers
![Figure 798: DH-HMAC-CHAP hash function identifiers](../section_images/Figure_8_3_5_5_2_DH_HMAC_CHAP_Authentication_Protocol_Descriptor_2.png)

