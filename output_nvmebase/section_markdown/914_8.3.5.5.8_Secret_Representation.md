###### 8.3.5.5.8 Secret Representation

> **Section ID**: 8.3.5.5.8 | **Page**: 755-756

In order to facilitate provisioning, management, and interchange (e.g., copy & paste in an administrative
configuration tool) of secrets, all NVMe over Fabrics entities shall support the following ASCII representation
of secrets:
DHHC-1:xx:<Base64 encoded string>:
Where:
•
”DHHC-1” indicates this is a version 1 representation of a secret for the DH-HMAC-CHAP protocol;
•
‘:’ is used both as a separator and a terminator;
•
xx indicates the hash function to be used to transform the secret in key (refer to section 8.3.5.5.7),
encoded as the ASCII representation of the hexadecimal value specified in Figure 798 (e.g., the
two ASCII characters “01” indicate SHA-256). The two ASCII characters “00” indicate no transform
(i.e., use the secret as a key); and
•
The Base64 (refer to RFC 4648) string encodes the secret (32, 48, or 64 bytes binary) followed by
the CRC-32 (refer to RFC 1952) of the secret (4 bytes binary).
As an example, the 32-byte secret:
89AEB31A 874EAF84 841B4673 6B0DFDF2 BA58D30A A2A545A3 E235A352 1E07594Ch
has the CRC-32 A70D69FAh, that is represented in little endian format (i.e., FA690DA7h) for concatenation
to the secret, resulting in the following:
“DHHC-1:00:ia6zGodOr4SEG0Zzaw398rpY0wqipUWj4jWjUh4HWUz6aQ2n:”
when intended to be used as a key without transform.
When provided with a secret in this format, NVMe over Fabrics entities shall verify the validity of the
provided secret by computing the CRC-32 value of the secret and checking the computed value with the
provided value. If they do not match, then the secret shall not be used.
