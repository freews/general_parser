##### 3.3.2.7 Submission Queue Head Pointer Update Optimization

> **Section ID**: 3.3.2.7 | **Page**: 122-123

Submission Queue Head Pointer update optimization does not apply to queue pairs for which Submission
Queue (SQ) flow control is disabled, as the SQHD field is reserved if SQ flow control is disabled, refer to
section 3.3.2.5 and to section 6.3.
The NVMe Transport may omit transmission of the SQHD value for a response capsule that:
a) contains a Generic Command status (i.e., Status Code Type 0h) indicating successful completion
of a command (i.e., Status Code 00h);
b) is not a Connect response capsule; and
c) is not a Disconnect response capsule.
If a new SQHD value is not received in a response capsule, the host continues to use its previous SQHD
value. Thus, at the NVMe layer there is a logical progression of SQHD values despite the fact that the
NVMe Transport may not actually transfer the SQHD value in each response capsule.
The NVMe Transport may deliver response capsules that do not contain an SQHD value to the host in any
order. The applicable NVMe Transport binding specification defines how presence versus absence of an
SQHD value in a response capsule is indicated by the NVMe Transport.
Periodic SQHD updates at the host are required to avoid Submission Queue (SQ) starvation as SQHD
value transmission in responses is the only means of releasing SQ slots for host reuse.
An NVMe Transport may transmit an SQHD value in every response capsule. If an NVMe Transport does
not transmit an SQHD value in every response capsule, then an SQHD value should be transmitted
periodically (e.g., in at least one of every n response capsules on a CQ, where n is 10% of the size of the
associated SQ) or more often. An SQHD value should always be transmitted if 90% or more of the slots in
the associated SQ are occupied at the subsystem.
