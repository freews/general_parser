#### 8.1.14 Key Per I/O

> **Section ID**: 8.1.14 | **Page**: 603-604

The Key Per I/O capability provides a mechanism to use encryption keys that have been injected into an
NVM subsystem by a host. The mechanism to perform activation of the Key Per I/O capability, encryption
key injection, management, and association to encryption key tag is outside the scope of this specification.
One mechanism is defined in the TCG Storage Security Subsystem Class: Key Per I/O Specification using
the NVMe Admin commands Security Send and Security Receive. If the TCG mechanism is used, any
additional modifications to the NVM subsystem as a result of activation of the Key Per I/O Security Provider
are defined in the TCG Storage Interface Interactions Specification (SIIS).
Encryption keys injected into the NVM subsystem may be referenced by I/O commands through the use of
the encryption key tag (refer to the KEYTAG field in Figure 668) associated with the encryption keys. If an
I/O command CETYPE field is set to the KPIOTAG value, then the CEV field (refer to Figure 668) of that
I/O command specifies the encryption key tag associated with the encryption key to be used to encrypt or
decrypt the data in that I/O command. The association of an encryption key tag to a specific encryption key
is outside the scope of this specification. One association mechanism is defined in the TCG Storage
Security Subsystem Class: Key Per I/O Specification.
The Key Per I/O Scope bit (refer to Figure 328) indicates if the Key Per I/O capability:
â€¢
applies to all read and write commands in all namespaces within the NVM subsystem; or
â€¢
independently applies to read and write commands in each namespace within the NVM subsystem.
The Key Per I/O capability does not have any effect on host accesses to RPMBs and Boot Partitions as
these features are not addressed through I/O commands that specify a namespace.
A controller that supports the Key Per I/O capability shall set the KPIOS bit to â€˜1â€™ in the Identify Controller
data structure (refer to Figure 328).
A namespace that supports the Key Per I/O capability shall set the KPIOSNS bit to â€˜1â€™ in the I/O Command
Set Independent Identify Namespace data structure (refer to Figure 335).
The Key Per I/O capability uses the Command Extension Type (CETYPE) and Command Extension Value
(CEV) fields in all read and write commands. Definition of the CETYPE fields are shown in Figure 668.
If:
â€¢
the Key Per I/O capability is enabled in a namespace (i.e., the KPIOENS bit set to â€˜1â€™);
â€¢
an I/O command supports the CETYPE field; and
â€¢
the CETYPE field in that I/O command is set to a value that is reserved,
then the controller shall abort that command with a status code of Invalid Field in Command.


---
### ðŸ“Š Tables (1)

#### Table 1: Table_8_1_14_Key_Per_I_O
![Table_8_1_14_Key_Per_I_O](../section_images/Table_8_1_14_Key_Per_I_O.png)

| Value | Definition | CEV Field Definition |
| :--- | :--- | :--- |
| 0h | Reserved | |
| 1h | **Key Per I/O Tag (KPIOTAG):**<br>This command is using the Key Per I/O capability. | **Key Tag (KEYTAG):** Specifies a namespace-specific 16-bit encryption key tag that identifies the encryption key used to encrypt or decrypt the data of the command.<br><br>The same Key Tag value on different namespaces may or may not identify the same encryption key.<br><br>Refer to the Maximum Key Tag field in the I/O Command Set Independent Identify Namespace data structure (refer to Figure 335) for the supported values. |
| 2h to Eh | Reserved | |
| Fh | Vendor Specific | |

