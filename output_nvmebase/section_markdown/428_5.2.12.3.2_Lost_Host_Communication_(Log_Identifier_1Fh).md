###### 5.2.12.3.2 Lost Host Communication (Log Identifier 1Fh)

> **Section ID**: 5.2.12.3.2 | **Page**: 328-330

The Lost Host Communication log page for a controller reports a list of other controllers in the same NVM
subsystem that have lost communication with the host that submitted the Get Log Page command for this
log page without the NVM subsystem observing a host action that terminated the association. That list of
controllers shall not include the controller that processes that Get Log Page command.
Entries in this log page inform the host of communication losses detected by the NVM subsystem as a
complement to other host communication loss detection mechanisms. The host is able to use this log page
to:
â€¢
detect communication loss (refer to section 9.6.1);
â€¢
select the controller for submission of the Cross-Controller Reset command (refer to section 5.4.3)
as part of Cross-Controller Reset Recovery (refer to section 8.3.3); and
â€¢
shorten Time-Based Recovery (refer to section 9.6.2.1).
For purposes of this log page, a Lost Host Communication (LHC) Controller is a controller that has lost
communication with the host:
â€¢
without the NVM subsystem observing a host action that terminated the association (e.g., as a
result of a Cross-Controller Reset command); and
â€¢
without an NVM subsystem action that terminated the association and that was sent to the host
(e.g., an authentication failure, refer to section 8.3.5.2).
Some message-based transports do not enable the NVM subsystem to distinguish between a host
terminating an NVMe Transport connection and the fabric terminating the NVMe Transport connection (e.g.,
some firewalls reset TCP connections). For such a transport, the NVM subsystem should treat the
termination of an NVMe Transport connection as not resulting from a host action.
As a result of a controller becoming an LHC Controller, the NVM subsystem should add an entry to this log
page for one or more other controllers that are associated with the same host. The NVM subsystem shall
not add an entry to this log page for a controller that is not associated with the host that is associated with
the controller that became an LHC Controller.
This log page is not required to include entries for all loss of communication events detected by the NVM
subsystem. Addition of entries to this log page may be limited by implementation restrictions (e.g., security
considerations such as secure channel configuration differences between the two controllers, internal
communication boundaries, or other internal resource limits). If the host is associated with many controllers,
addition of entries to this log page should be limited to a subset of these controllers, limiting the number of
Cross Controller Reset commands sent by the host for a given loss of communication event.
If Lost Host Communication Notices are enabled and the NVM subsystem adds an entry to this log page
then the controller shall report a Lost Host Communication Notice asynchronous event (refer to Figure 154)
This log page consists of a header followed by a list of up to 511 Lost Host Communication Entries. The list
is ordered from the oldest (i.e., least recently added) entry to the newest (i.e., most recently added) entry
with the oldest entry in the lowest numbered index. If this log page has 511 entries and an entry is added,
then the oldest entry shall be removed. If an entry with a controller ID exists and an entry with the same
controller ID is added to this log page, then:
â€¢
that existing entry shall be removed from this log page; and
â€¢
the Loss Count field in the new entry shall be set to:
o
one more than the value of the older entry, if the value of the Loss Count field in the older
entry is less than FFh; and
o
FFh, if the value of the Loss Count field in the older entry is FFh.
If an entry is added to this log page and no entry with the same controller ID exists, then the value of the
Loss Count field of the new entry shall be set to 1h.
The controller should remove any entry from this log page that has been present for longer than an
implementation specific amount of time (e.g., entries older than one hour).
All entries are removed from this log page if the controller processes:
â€¢
a Get Log Page command for this log page with the RAE bit cleared to â€˜0â€™; or
â€¢
a Controller Level Reset.
If the host connected to a Discovery subsystem using the well-known Discovery Service NQN, then the
controller shall not report that this log page is supported in the Supported Log Pages log page (refer to
section 5.2.12.1.1).
The log page is defined in Figure 306.
The format of the Lost Host Communication Entry is defined in Figure 307.
For each controller indicated by an entry in this log page, if a host has not received completions for all
outstanding commands submitted to that controller (refer to section 3.4.5), then it is strongly recommended
that the host takes steps described in section 9.6 to avoid possible data corruption caused by interaction
between outstanding commands and subsequent commands submitted by that host to another controller.
A host may have already detected a loss of communication with the LHC Controller indicated by an entry
in this log page. To avoid performing recovery from a loss of communication (as described in section 9.6)
when recovery is not necessary:
â€¢
if the NVM subsystem uses the dynamic controller model or the NVM subsystem supports the host
specifying a controller ID of FFFEh in the Connect command, then the NVM subsystem should not
aggressively reuse controller IDs, as described in section 6.3;
â€¢
if the value of the Controller Instance Uniquifier (CIU) field of an entry in the log page is not the
same as the CIU field in the Identify Controller data structure of the controller indicated by that
entry, then the host should ignore that entry because that entry identifies an older controller
instance that is no longer processing commands (e.g., because the controller instance no longer
exists); and
â€¢
if the host is already in process of recovery from a loss of communication with a controller indicated
by an entry in the log page, then the host should ignore that log page entry and not restart that
recovery.


---
### ðŸ“Š Tables (1)

#### Table 1: Table_5_2_12_3_2_Lost_Host_Communication_Log_Identifier_1Fh
![Table_5_2_12_3_2_Lost_Host_Communication_Log_Identifier_1Fh](../section_images/Table_5_2_12_3_2_Lost_Host_Communication_Log_Identifier_1Fh.png)

| Bytes | Description | Header |
| :--- | :--- | :--- |
| 01:00 | **Number of Entries (NE):** This field indicates the number of valid entries in the Lost Host Communication Entry list. Contents of entries that are not valid shall be cleared to zero. The maximum value of this field is 511. | |
| 07:02 | Reserved | |
| | **Lost Host Communication Entry List** | |
| 15:08 | **Lost Host Communication Entry 0 (LHCE0):** This field contains the first Lost Host Communication Entry (refer to Figure 307), if any. | |
| 23:16 | **Lost Host Communication Entry 1 (LHCE1):** This field contains the second Lost Host Communication Entry, if any. | |
| ... | ... | |
| 4095:4088 | **Lost Host Communication Entry 510 (LHCE510):** This field contains the 511th Lost Host Communication Entry, if any. | |
| Bytes | Description | |
| 01:00 | **Controller ID (CNTLID):** This field indicates the controller ID of the LHC Controller. | |
| 02 | **Loss Count (LC):** This field contains a count of the number of lost host communication events that are reported by this entry (i.e., the number of lost host communication events since the last time that this log page did not contain an entry for the LHC Controller). After the counter has reached a maximum value of FFh, the counter is not incremented (i.e., does not roll over from FFh to 00h). | |
| 03 | **Controller Instance Uniquifier (CIU):** This field indicates the CIU field in the Identify Controller data structure (refer to Figure 328) of the LHC Controller at the time the entry was created. | |
| 07:04 | Reserved | |

