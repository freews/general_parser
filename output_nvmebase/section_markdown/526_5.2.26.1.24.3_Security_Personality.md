###### 5.2.26.1.24.3 Security Personality

> **Section ID**: 5.2.26.1.24.3 | **Page**: 450-453

The Security Personality allows a host to configure the NVM subsystem with one or more of the security
protocols supported indicated in Figure 450.
If an NVM subsystem is configured with that Security Personality and a supported security protocol has
been enabled, then any Security Send and Security Receive command issued by the host that specifies
that security protocol shall be allowed.
If a security protocol is allowed, then once the security protocol is no longer in the defined default
manufacturing state (e.g., transition out of the Manufacturing-Inactive state for the TCG Security Protocol
(refer to the TCG Storage Security Subsystem Class: Opal Specification)), then the controller shall freeze
the Security Personality and a CDP Change Event shall be recorded in the Persistent Event log page for
the Security Personality (refer to section 5.2.12.1.14.2.15).
If a supported security protocol is prohibited, then any Security Send and Security Receive command issued
by the host that specifies that security protocol shall be prohibited. If a Security Send or Security Receive
command is processed that uses a security protocol that is prohibited, then the controller shall abort the
command with a status code of Access Denied.
If a Get Features command specifies this personality, then the Security Personality data structure defined
in Figure 450 shall be returned in the data buffer for that command.
If a Set Features command is processed for the Security Personality, then the Security Personality
Attributes data structure (refer to Figure 451) is specified in the data buffer for that command. If the host
specifies a Supported Security Protocol (SSP) field value that is not supported, then the controller shall
abort the command with a status code of Invalid Field in Command.
A security protocol that is allowed shall only able to be unfrozen if that security protocol is reset to the
default security settings for the given security protocol. Refer to the appropriate security specification (e.g.,
PSID Feature Set to reset the device to Original Factory Settings (OFS) using the Revert method defined
in TCG Storage Opal SSC Feature Set: PSID Specification).


---
### ðŸ“Š Tables (2)

#### Table 1: Table_5_2_26_1_24_3_Security_Personality_1
![Table_5_2_26_1_24_3_Security_Personality_1](../section_images/Table_5_2_26_1_24_3_Security_Personality_1.png)

| Bytes | Description |
| :--- | :--- |
| | **Security Protocol Status (SPS):** This field indicates the status of security protocols. If a security protocol is not supported as indicated in the Supported Security Protocol (SSP) field, then the bit corresponding to that security protocol shall be cleared to '0'. |
| | | 
| | **Bits** | **Description** |
| | | 
| 03:00 | 31 | Vendor Specific Protocol FF (VSPPF): This bit indicates the status for the vendor-specific security protocol value FFh. If the vendor-specific security protocol value of FFh is allowed in the NVM subsystem, then this bit shall be set to '1'; otherwise, this bit shall be cleared to '0'. |
| | ... | ... |
| | 17 | Vendor Specific Protocol F1 (VSPF1): This bit indicates the status for the vendor-specific security protocol value of F1h. If the vendor-specific security protocol value of F1h is allowed in the NVM subsystem, then this bit shall be set to '1'; otherwise, bit shall be cleared to '0'. |
| | 16 | Vendor Specific Protocol F0 (VSPF0): This bit indicates the status for the vendor-specific security protocol value F0h. If the vendor-specific security protocol value of F0h is allowed in the NVM subsystem, then this bit shall be set to '1'; otherwise, this bit shall be cleared to '0'. |
| | 15:03 | Reserved |
| | 02 | Authentication in Host Attachments of Transient Storage Devices Protocol Status (AHATSDPS): This bit indicates the status for the security protocol value of EEh. If the Authentication in Host Attachments of Transient Storage Devices security protocol is allowed in the NVM subsystem, then this bit shall be set to '1'; otherwise, this bit shall be cleared to '0'. |
| | 01 | TCG Security Protocol Status (TCGPST): This bit indicates the status for the security protocol range 01h to 06h. If the TCG security protocol is allowed in the NVM subsystem, then this bit shall be set to '1'; otherwise, this bit shall be cleared to '0'. |
| | 00 | Reserved |
| | | 
| Bytes | Description |
| | **Supported Security Protocol (SSP):** This field indicates support to allow or prohibit security protocols. |
| | | 
| | **Bits** | **Description** |
| | | 
| 07:04 | 31 | Vendor Specific Protocol FF (VSP15): This bit indicates support to allow and prohibit Security Send and Security Receive commands that target the vendor-specific security protocol value FFh. <br> If the NVM subsystem supports allowing and prohibiting this vendor-specific security protocol value, then this bit shall be set to '1'. If the NVM subsystem does not support allowing and prohibiting this vendor-specific security protocol, then this bit shall be cleared to '0'. |
| | ... | ... |
| | 17 | Vendor Specific Protocol F1 (VSP1): This bit indicates support to allow and prohibit Security Send and Security Receive commands that target the vendor-specific security protocol value F1h. <br> If the NVM subsystem supports allowing and prohibiting this vendor-specific security protocol value, then this bit shall be set to '1'. If the NVM subsystem does not support allowing and prohibiting this vendor-specific security protocol, then this bit shall be cleared to '0'. |
| | 16 | Vendor Specific Protocol F0 (VSP0): This bit indicates support to allow and prohibit Security Send and Security Receive commands that target the vendor-specific security protocol value F0h as defined in SPC-5. <br> If the NVM subsystem supports allowing and prohibiting this vendor-specific security protocol value, then this bit shall be set to '1'. If the NVM subsystem does not support allowing and prohibiting this vendor-specific security protocol, then this bit shall be cleared to '0'. |
| | 15:03 | Reserved |
| | 02 | Authentication in Host Attachments of Transient Storage Devices Protocol Support (AHATSDPS): This bit indicates support to allow and prohibit Security Send and Security Receive commands that target the Authentication in Host Attachments of Transient Storage Devices security protocol value (i.e., EEh, as defined in SPC-5). <br> If the NVM subsystem supports allowing and prohibiting this security protocol, then this bit shall be set to '1'. If the NVM subsystem does not support allowing and prohibiting this security protocol, then this bit shall be cleared to '0'. |
| | 01 | TCG Security Protocol Support (TCGPSUP): This bit indicates support to allow and prohibit Security Send and Security Receive commands that target the TCG security protocol values (i.e., 01h to 06h, as defined by TCG in SPC-5). <br> If the NVM subsystem supports allowing and prohibiting this security protocol, then this bit shall be set to '1'. If the NVM subsystem does not support allowing and prohibiting this security protocol, then this bit shall be cleared to '0'. |
| | 00 | Reserved |


#### Table 2: Table_5_2_26_1_24_3_Security_Personality_2
![Table_5_2_26_1_24_3_Security_Personality_2](../section_images/Table_5_2_26_1_24_3_Security_Personality_2.png)

| Bits | Description |
| :--- | :--- |
| 31 | Vendor Specific Protocol FF (VSPPF): This bit specifies the vendor-specific security protocol N+15 (i.e., the vendor-specific security protocol FFh). If this bit is set to '1', then this vendor-specific security protocol is set to be allowed or set to be prohibited based on the ASP bit in this data structure. If this bit is cleared to '0', then allowed or prohibited setting for this security protocol range shall not be changed. |
| ... | ... |
| 17 | Vendor Specific Protocol F1 (VSPP1): This bit specifies the vendor-specific security protocol N+1 (i.e., the vendor-specific security protocol F1h). If this bit is set to '1', then this vendor-specific security protocol is set to be allowed or set to be prohibited based on the ASP bit in this data structure. If this bit is cleared to '0', then allowed or prohibited setting for this security protocol range shall not be changed. |
| 16 | Vendor Specific Protocol F0 (VSPP0): This bit specifies the vendor-specific security protocol N (i.e., the vendor-specific security protocol F0h). If this bit is set to '1', then this vendor-specific security protocol is set to be allowed or set to be prohibited based on the ASP bit in this data structure. If this bit is cleared to '0', then allowed or prohibited setting for this security protocol range shall not be changed. |
| 15:03 | Reserved |
| 02 | Authentication in Host Attachments of Transient Storage Devices Protocol (AHATSDP): This bit specifies the security protocol value of EEh. If this bit is set to '1', then the Authentication in Host Attachments of Transient Storage Devices security protocol shall be set to be allowed or set to be prohibited based on the setting of the ASP bit in this data structure. If this bit is cleared to '0', then allowed or prohibited setting for this security protocol range shall not be changed. |
| 01 | TCG Security Protocol (TCGP): This bit specifies the security protocol range 01h to 06h. If this bit is set to '1', then the TCG security protocol range is set to be allowed or set to be prohibited based on the setting of the ASP bit in this data structure. If this bit is cleared to '0', then allowed or prohibited setting for this security protocol range shall not be changed. |
| 00 | Allow Security Protocol (ASP): This bit specifies whether to allow or prohibit the security protocols specified in this data structure. If this bit is set to '1', then the security protocols specified in this data structure shall be allowed. If this bit is cleared to '0', then the security protocols specified in this data structure shall be prohibited. |

