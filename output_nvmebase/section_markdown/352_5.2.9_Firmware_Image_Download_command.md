#### 5.2.9 Firmware Image Download command

> **Section ID**: 5.2.9 | **Page**: 223-224

The Firmware Image Download command is used to download all or a portion of an image for a future
update to the controller. The Firmware Image Download command may be submitted while other
commands on the Admin Submission Queue or I/O Submission Queues are outstanding. The Firmware
Image Download command downloads a new image (in whole or in part) to the controller.
The image may be constructed of multiple pieces that are individually downloaded with separate Firmware
Image Download commands. Each Firmware Image Download command includes a Dword Offset and
Number of Dwords that specify a dword range. The host should ensure that image pieces do not have
dword ranges that overlap and that the NUMD field and OFST field meet the alignment and granularity
requirements indicated in the FWUG field (refer to Figure 328). Firmware portions may be submitted out of
order to the controller. The host shall submit image portions in order when updating a Boot Partition. If
ranges overlap, the controller may return an error of Overlapping Range.
The new firmware image is not activated as part of the Firmware Image Download command. Refer to
section 3.11 for details on the firmware update process. The firmware update process does not modify the
contents of Boot Partitions. Refer to section 8.1.3.2 for details on the Boot Partition update process.
The host should not overlap command sequences that update Boot Partitions and/or firmware images (refer
to section 3.11 and section 8.1.3.2).
If a change to the settings of any personality is pending (refer to section 8.1.6.1), then the controller shall
abort the Firmware Image Download command with a status code of Access Denied.
After downloading an image, the host issues a Firmware Commit command before downloading another
image. Processing of the first Firmware Image Download command after completion of a Firmware Commit
command shall cause the controller to discard all remaining portion(s), if any, of downloaded images. If a
Controller Level Reset occurs between a firmware download and completion of the Firmware Commit
command, then the controller shall discard all portion(s), if any, of downloaded images.
The Firmware Image Download command uses the Data Pointer, Command Dword 10, and Command
Dword 11 fields. All other command specific fields are reserved.


---
### ðŸ“Š Tables (1)

#### Table 1: Table_5_2_9_Firmware_Image_Download_command
![Table_5_2_9_Firmware_Image_Download_command](../section_images/Table_5_2_9_Firmware_Image_Download_command.png)

| Bits | Description |
| :--- | :--- |
| 127:00 | **Data Pointer (DPTR):** This field specifies the location where data should be transferred from. Refer to Figure 92 for the definition of this field. |
| | |
| Bits | Description |
| 31:00 | **Number of Dwords (NUMD):** This field specifies the number of dwords to transfer for this portion of the firmware. This is a 0's based value. If the value specified in this field does not meet the requirement indicated by the FWUG field (refer to Figure 328), then the controller may abort the command with a status code of Invalid Field in Command. |
| | |
| Bits | Description |
| 31:00 | **Offset (OFSST):** This field specifies the number of dwords offset from the start of the firmware image being downloaded to the controller. The offset is used to construct the complete firmware image when the firmware is downloaded in multiple pieces. The piece corresponding to the start of the firmware image shall have an Offset of 0h. If the value specified in this field does not meet the requirement indicated by the FWUG field (refer to Figure 328), then the controller may abort the command with a status code of Invalid Field in Command. |

