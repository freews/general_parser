###### 5.2.12.1.14 Persistent Event (Log Page Identifier 0Dh)

> **Section ID**: 5.2.12.1.14 | **Page**: 260-267

The Persistent Event log page contains information about significant events not specific to a particular
command. The information in this log page shall be retained across power cycles and resets. NVM
subsystems should be designed for minimal loss of event information upon power failure. This log page
consists of a header describing the log and zero or more Persistent Events (refer to section 5.2.12.1.14.1).
This log page is global to the NVM subsystem.
The Log Specific Parameter field in Command Dword 10 (refer to Figure 201) for this log page is defined
in Figure 229.
A sanitize operation may alter this log page (e.g., remove or modify events to prevent derivation of user
data from log page information, refer to section 8.1.26). The events removed from this log page by a sanitize
operation are unspecified.
Persistent Event Log events specified in this section should be reported in an order such that more recent
events are reported earlier (i.e., at a lower offset) in the log data than older events. The method by which
the NVM subsystem determines the order in which events occurred is vendor specific.
The number of events supported is vendor specific. The supported maximum size for the Persistent Event
Log is indicated in the PELS field of the Identify Controller data structure (refer to Figure 328). The number
of events supported and the supported maximum size should be large enough that the number of events
or the size of the Persistent Event Log data does not reach the maximum supported size over the usable
life of the NVM subsystem.
The controller shall log all supported events at each event occurrence unless the controller determines that
the same event is occurring at a frequency that exceeds a vendor specific threshold for the frequency of
event creation. If the same event is occurring at a frequency that exceeds a vendor specific threshold then
the vendor may suppress further entries for the same event. A controller may indicate if events have been
suppressed in vendor specific event data.
It is vendor specific which events are deleted (e.g., important events may be retained and events that are
newer than an important event that was retained may be deleted) to make room for future events if:
a) the size of the Persistent Event Log data reaches the maximum supported size;
b) the number of events reaches the largest reportable number of events; or
c) an event category reaches the largest reportable number of events for that category (e.g.,
information regarding 1,000 occurrences of changes to the timestamp is stored in internal data
structures and extracted for reporting as Timestamp Change events in the Persistent Event Log
and more than 1,000 Timestamp Change events have occurred).
Events that affect multiple controllers (e.g., an NVM Subsystem Reset) should be logged once by a
controller selected by the vendor and not logged by any other controllers.
The Action field in the Log Specific Parameter field (refer to Figure 229) specifies whether:
a) A persistent event log reporting context is created at the start of processing this Get Log Page
command and log page data, if any, is read from the log page data associated with that log reporting
context;
b) Log page data is read from the log page data associated with a preexisting log reporting context;
or
c) The persistent event log reporting context, if any, is released.
The persistent event log reporting context is vendor specific information that the controller creates for
determining what information is included in the persistent event log page data (e.g., the persistent event
log reporting context may be the persistent event log page data or may contain a set of pointers to the
events to report).
The controller should retain the persistent event log reporting context:
a) Until the controller processes:
a) a Get Log Page command requesting the Persistent Event log page with the Action field set to
02h (i.e., Release Context);
b) an NVM Subsystem Reset; or
c) a Controller Level Reset;
or
b) For a vendor specific time long enough to allow retrieval of the Persistent Event log page data.
Persistent Event Log events that occur while a persistent event log reporting context exists shall not be
reported in the existing reporting context but shall be logged.
The host is expected to issue a Get Log Page command with the Action field set to 02h to release the
persistent event log reporting context after reading the persistent event log page data.
If the Persistent Event Log is not read with a single Get Log Page command, then the host should read the
Generation Number field in the Persistent Event Log header after establishing a reporting context but before
reading the remainder of the log and then re-read the Generation Number field after it has read the entire
log. If the generation numbers do not match, then:
â€¢
the reporting context may have been lost while reading the log;
â€¢
the Persistent Event Log contents read may be invalid; and
â€¢
the host should re-read the log.
The log page returned is defined in Figure 230.
The format of the Persistent Events in the Persistent Event log is shown in Figure 231.


---
### ðŸ“Š Tables (3)

#### Table 1: Table_5_2_12_1_14_Persistent_Event_Log_Page_Identifier_0Dh_1
![Table_5_2_12_1_14_Persistent_Event_Log_Page_Identifier_0Dh_1](../section_images/Table_5_2_12_1_14_Persistent_Event_Log_Page_Identifier_0Dh_1.png)

| Bits | Description |
| :--- | :--- |
| 14:10 | Reserved |
| | **Action (ACT):** This field specifies the action the controller shall take during processing this Get Log Page command. |
| | | **Value** | **Definition** |
| | | 00b | **Read Log Data:** Return Persistent Event log page data starting at the address indicated by the LPOU field and the LPOL field in the Get Log Page command. If the controller does not have a persistent event log reporting context, then the controller shall abort the command with a status code of Command Sequence Error. |
| | | | **Establish Context and Read Log Data:** The controller shall: <br> a) determine the length of the Persistent Event log page data; <br> b) determine the set of events to report in the Persistent Event log page data; and <br> c) establish a persistent event log reporting context to store information describing the Persistent Event log page data to be reported and track Persistent Event log page data accesses. |
| | | 01b | After establishing a persistent event log reporting context, the controller shall return Persistent Event log page data starting at the address indicated by the LPOU field and the LPOL field in the Get Log Page command. <br> If a persistent event log reporting context already exists, then the controller shall abort the command with a status code of Command Sequence Error. |
| | | | **Release Context:** The controller shall: <br> â€¢ release the persistent event log reporting context, if any. It is not an error if the controller does not have a persistent event log reporting context; and <br> â€¢ not return any Persistent Event log page data (i.e., the controller ignores the NUMDU field, NUMDL field, LPOL field, and the LPOU field). |
| 09:08 | | 10b | |
| | | 11b | **Establish Context and Read 512 Bytes of Header:** The controller shall: <br> a) determine the length of the Persistent Event log page data; <br> b) determine the set of events to report in the Persistent Event log page data; and <br> c) if a reporting context does not already exist, then establish a persistent event log reporting context to store information describing the Persistent Event log page data to be reported and track Persistent Event log page data accesses. <br> If a persistent event log reporting context did not already exist when the Get Log Page command was processed, then the controller shall: <br> a) establish a persistent event log reporting context; and <br> b) after establishing the context, return 512 bytes of the Persistent Event Log Header starting at offset 0h with the Reporting Context Exists bit cleared to '0' with a status code of Successful Completion. <br> If a persistent event log reporting context already existed when the Get Log Page command was processed, then the controller shall return 512 bytes of the Persistent Event Log Header starting at offset 0h with the Reporting Context Exists bit set to '1' with a status code of Successful Completion. <br> The 512 bytes of the Persistent Event Log Header shall be returned regardless of the values in the LPOL, LPOU, NUMDL, and NUMDU fields (i.e., the controller shall ignore the LPOL, LPOU, NUMDL, and NUMDU fields). Hosts should ensure allocation of at least 512 bytes in the data buffer to avoid possible data corruption. |


#### Table 2: Table_5_2_12_1_14_Persistent_Event_Log_Page_Identifier_0Dh_2
![Table_5_2_12_1_14_Persistent_Event_Log_Page_Identifier_0Dh_2](../section_images/Table_5_2_12_1_14_Persistent_Event_Log_Page_Identifier_0Dh_2.png)

| Bytes | Description |
| :--- | :--- |
| | **Persistent Event Log Header** |
| 00 | **Log Page Identifier (LID):** This field shall be set to 0Dh. |
| 03:01 | Reserved |
| 07:04 | **Total Number of Events (TNEV):** Contains the number of event entries in this log page. |
| 15:08 | **Total Log Length (TLL):** Contains the total number of bytes of persistent event log page data available, including the header. |
| 16 | **Log Revision (LREV):** Contains a number indicating the revision of the Get Log Page data structure that this log page data complies with. Shall be set to 03h. This revision applies to the Persistent Event Log and the Persistent Event Format (refer to Figure 231). This revision does not apply to the contents of the Event Data field in the Persistent Event Format as that field is not covered by the Event Type Revision (refer to Figure 231). |
| 17 | Reserved |
| 19:18 | **Log Header Length (LHL):** This field contains the length in bytes of the log header information that follows. The total length of the log header in bytes is the value in this field plus 20. |
| 27:20 | **Timestamp (TSTMP):** This field contains a timestamp of the time at which the persistent event log reporting context was established. The value returned shall use the Timestamp data structure defined in Figure 415. |
| 43:28 | **Power On Hours (POH):** This field indicates the number of power-on hours at the time the Persistent Event log was retrieved. This may or may not include time that the controller was powered and in a non-operational state. |
| 51:44 | **Power Cycle Count (PWRC):** Contains the number of power cycles for this controller. |
| 53:52 | **PCI Vendor ID (VID):** This is the same value as reported in the Identify Controller data structure PCI Vendor ID field (i.e., bytes 01:00). |
| 55:54 | **PCI Subsystem Vendor ID (SSVID):** This is the same value as reported in the Identify Controller data structure PCI Subsystem Vendor ID field (i.e., bytes 03:02). |
| 75:56 | **Serial Number (SN):** This field contains the same value as reported in the Serial Number field of the Identify Controller data structure, bytes 23:04. |
| 115:76 | **Model Number (MN):** This field contains the same value as reported in the Model Number field of the Identify Controller data structure, bytes 23:24. |
| 371:116 | **NVM Subsystem NVMe Qualified Name (SUBNQN):** This field contains the same value as reported in the NVM Subsystem NVMe Qualified Name field of the Identify Controller data structure, bytes 1023:768. If the NVM Subsystem NVMe Qualified Name field of the Identify Controller data structure is not supported, then all bytes of this field shall be cleared to 0h. |
| 373:372 | **Generation Number (GNUM):** Contains a value that is incremented by one each time:<br>â€¢ a persistent event log reporting context is established; and<br>â€¢ the log page contents change to contain different data than when this log page last established a reporting context.<br>If the value of this field is FFFFh, then the field shall be cleared to 0h when incremented (i.e., rolls over to 0h). |
| | **Reporting Context Information (RCI):** This field contains information about the persistent event log reporting context. |
| 31:19 | Reserved |
| 18 | **Reporting Context Exists (RCE):** This bit indicates the persistent event log reporting context. If this bit is set to '1', then a persistent event log reporting context already existed when the Get Log Page command that requested this log page was processed. If this bit is cleared to '0', then a persistent event log reporting context did not already exist when the Get Log Page command that requested this log page was processed. |
| 17:16 | **Reporting Context Port Identifier Type (RCPLIT):** If the RCE bit is set to '1', then this field indicates the type of port identifier reported in the Reporting Context Port Identifier (RCPID) field. If the RCE bit is cleared to '0', then this field shall be cleared to 00b.<br>**Value** | **Definition** |
| | 00b | A persistent event log reporting context does not already exist. |
| | 01b | The reporting context was established by an NVM subsystem port. |
| | 10b | The reporting context was established by a Management Endpoint (refer to the NVM Express Management Interface Specification). |
| | 11b | Reserved |
| 15:00 | **Reporting Context Port Identifier (RCPID):** If the RCE bit is cleared to '0', then this field shall be cleared to 0h.<br>If the RCE bit is set to '1', then this field contains a Port Identifier of the type indicated in the RCPLIT field.<br>If the RCPLIT field is set to 01b, then this field shall contain the Port Identifier of the NVM subsystem port that established the reporting context as defined in the Primary Controller Capabilities data structure (refer to section 5.2.13.3.1).<br>If the RCPLIT field is set to 10b:<br>â€¢ the least-significant byte of this field shall contain the Port Identifier of the Management Endpoint (refer to the NVM Express Management Interface Specification); and<br>â€¢ the most-significant byte of this field shall be cleared to 0h. |
| 479:378 | Reserved |
| | **Supported Events Bitmap (SEB):** This field contains a bitmap indicating support for the persistent event log events. Each bit in the bitmap corresponds to the value for the event type (refer to Figure 233) (e.g., bit 222 decimal, DEh, corresponds to event type value DEh, Vendor Specific Event). A bit set to '1' indicates that the corresponding event is supported. A bit cleared to '0' indicates that the corresponding event is not supported. |
| 255:224 | Reserved |
| 223 | **TCG Defined** | TCG Storage Interface Interactions Specification |
| 222 | **Vendor Specific Event Supported (VSES)** | 5.2.12.1.14.2.16 |
| 221:16 | Reserved |
| 15 | **Configurable Device Personality Change Event Support (CDPCES)** | 5.2.12.1.14.2.15 |
| 14 | **Sanitize Media Verification Event Support (SMVES)** | 5.2.12.1.14.2.14 |
| 13 | **Thermal Excursion Event Support (TEES)** | 5.2.12.1.14.2.13 |
| 12 | **Telemetry Log Create Event Support (TLCES)** | 5.2.12.1.14.2.12 |
| 11 | **Set Feature Event Support (SFES)** | 5.2.12.1.14.2.11 |
| 10 | **Sanitize Completion Event Support (SCES)** | 5.2.12.1.14.2.10 |
| 09 | **Sanitize Start Event Support (SSES)** | 5.2.12.1.14.2.9 |
| 08 | **Format NVM Completion Event Support (FNCES)** | 5.2.12.1.14.2.8 |
| 07 | **Format NVM Start Event Support (FNSES)** | 5.2.12.1.14.2.7 |
| 06 | **Change Namespace Event Support (CNES)** | 5.2.12.1.14.2.6 |
| 05 | **NVM Subsystem Hardware Error Event Support (NSHEES)** | 5.2.12.1.14.2.5 |
| 04 | **Power-on or Reset Event Supported (PRES)** | 5.2.12.1.14.2.4 |
| 03 | **Timestamp Change Event Supported (TCES)** | 5.2.12.1.14.2.3 |
| 02 | **Firmware Commit Event Supported (FCES)** | 5.2.12.1.14.2.2 |
| 01 | **SMART / Health Log Snapshot Event Supported (SHLSES)** | 5.2.12.1.14.2.1 |
| 00 | Reserved |
| | **Persistent Event Log Events** |
| (M-1)+512:512 | **Persistent Event 0:** This field contains the first persistent event log entry (refer to Figure 231) where M is the length of this persistent event. |
| ... | ... |
| (TLL-1):(TLL-K) | **Persistent Event N:** This field contains the last persistent event log entry (refer to Figure 231) where K is the length of this persistent event, TLL is the size specified in the Total Log Length field, and N is the value of the TNEV field minus 1h. |


#### Table 3: Table_5_2_12_1_14_Persistent_Event_Log_Page_Identifier_0Dh_3
![Table_5_2_12_1_14_Persistent_Event_Log_Page_Identifier_0Dh_3](../section_images/Table_5_2_12_1_14_Persistent_Event_Log_Page_Identifier_0Dh_3.png)

| Bytes | Description |
| :--- | :--- |
| 00 | **Event Type (ET):** This field indicates the event type for this entry. Refer to section 5.2.12.1.14.1 for the definition of the event types. |
| 01 | **Event Type Revision (ETR):** This field contains a number indicating the revision of the event data structure for the event indicated by the Event Type field that this event data complies with. |
| 02 | **Event Header Length (EHL):** This field contains the length in bytes of the event header that follows. The total length of the event header in bytes is the value in this field plus 3. The host should use the value in this field to calculate the offset to the start of the Vendor Specific Information field. |
| | |
| Bytes | Description |
| 03 | **Event Header Additional Information (EHAI):** This field indicates if additional information is present in this event header. |
| | <table><tbody><tr><td>Bits</td><td>Description</td></tr><tr><td>7:2</td><td>Reserved</td></tr><tr><td>1:0</td><td>Port Identifier Type (PIT): This field indicates the type of port identifier reported in the Port Identifier (PELPID) field. Implementations that are compliant with NVM Express Base Specification Revision 2.0 and later shall set this field to a non-zero value.</td></tr></tbody></table> |
| | <table><tbody><tr><td>Value</td><td>Definition</td></tr><tr><td>00b</td><td>The Port Identifier Type is not reported and the Port Identifier (PELPID) field does not apply.</td></tr><tr><td>01b</td><td>This event is associated with an NVM subsystem port.</td></tr><tr><td>10b</td><td>This event is associated with a Management Endpoint (refer to the NVM Express Management Interface Specification).</td></tr><tr><td>11b</td><td>This event is not associated with any port.</td></tr></tbody></table> |
| 05:04 | **Controller Identifier (CNTLID):** This field contains the NVM subsystem unique controller identifier for the controller that created this event. If the event is controller specific, then the event data is associated with that controller. If the event is not controller specific, then this is the controller that the NVM subsystem selected for creating the event. |
| 13:06 | **Event Timestamp (ETSTP):** This field contains a timestamp of the time when this event occurred using the Timestamp data structure defined in Figure 414. |
| 15:14 | **Port Identifier (PELPID):** If the PIT field in the EHAI field is cleared to 00b or set to 11b, then this field contains a Port Identifier of the type indicated in the PIT field.<br><br>If the PIT field in the EHAI field is not cleared to 00b or set to 11b, then this field shall contain the Port Identifier of the NVM subsystem port associated with this event as defined in the Primary Controller Capabilities data structure (refer to section 5.2.13.3.1).<br><br>If the PIT field in the EHAI field is set to 01b, then this field shall contain the Port Identifier of the Management Endpoint associated with this event (refer to the NVM Express Management Interface Specification); and<br><ul><li>the least-significant byte of this field shall contain the Port Identifier of the Management Endpoint associated with this event (refer to the NVM Express Management Interface Specification); and</li><li>the most-significant byte of this field shall be cleared to 0h.</li></ul> |
| 19:16 | Reserved |
| 21:20 | **Vendor Specific Information Length (VSIL):** This field indicates the length in bytes of the Vendor Specific Information. If no Vendor Specific Information is present, then this field shall be cleared to 0h. The length of the Vendor Specific Information is included in the Event Length field (bytes 23:22). Information associated with this event that is not able to be described in the event data structure fields may be reported in Vendor Specific Information fields in this event. |
| 23:22 | **Event Length (EL):** This field indicates the length in bytes of the vendor specific information, if any, and the persistent event log event data that follows. The total length of the event in bytes is the value in this field plus the value in the Event Header Length field plus 3. |
| | **Vendor Specific Information, if any** |
| EHL+2+VSIL:EHL+3 | **Vendor Specific Information (VSI):** This field contains the vendor specific information, if any. This field is omitted if there is no vendor specific information (i.e., if VSIL is cleared to 0h). |
| EHL+EL+2: EHL+3+VSIL | **Event Data (ED):** This field contains persistent event log event data, if any (refer to section 5.2.12.1.14.1). |

