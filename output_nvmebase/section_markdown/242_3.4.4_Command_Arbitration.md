#### 3.4.4 Command Arbitration

> **Section ID**: 3.4.4 | **Page**: 125-126

After a command has been submitted to the controller (refer to section 1.5.19), the controller transfers
submitted commands into the controller for subsequent processing using a vendor specific algorithm.
A command is being processed when the controller and/or namespace state is being accessed or modified
by the command such as:
•
a Feature setting is being accessed;
•
a Feature setting is being modified;
•
user data (e.g., a logical block as defined by the NVM Express NVM Command Set Specification)
is being accessed; or
•
user data is being modified.
A command is completed when a completion queue entry for the command has been posted to the
corresponding Completion Queue. Upon completion, all controller state and/or namespace state
modifications made by that command are globally visible to all subsequently submitted commands.
A candidate command is a submitted command which has been transferred into the controller that the
controller deems ready for processing. The controller selects command(s) for processing from the pool of
submitted commands for each Submission Queue. The commands that comprise a fused operation shall
be processed together and in order by the controller. The controller may select candidate commands for
processing in any order. The order in which commands are selected for processing does not imply the order
in which commands are completed.
Arbitration is the method used to determine the Submission Queue from which the controller starts
processing the next candidate command(s). Once a Submission Queue is selected using arbitration, the
Arbitration Burst setting determines the maximum number of commands that the controller may start
processing from that Submission Queue before arbitration shall again take place. A fused operation may
be considered as one or two commands by the controller.
All controllers shall support the round robin command arbitration mechanism. A controller may optionally
implement weighted round robin with urgent priority class and/or a vendor specific arbitration mechanism.
The Arbitration Mechanism Supported field in the Controller Capabilities property (CC.AMS) indicates
optional arbitration mechanisms supported by the controller.
In order to make efficient use of the non-volatile memory, it is often advantageous to execute multiple
commands from a Submission Queue in parallel. For Submission Queues that are using weighted round
robin with urgent priority class or round robin arbitration, a host may configure an Arbitration Burst setting.
The Arbitration Burst setting indicates the maximum number of commands that the controller may launch
at one time from a particular Submission Queue. It is recommended that a host configure the Arbitration
Burst setting as close to the recommended value by the controller as possible (specified in the
Recommended Arbitration Burst field of the Identify Controller data structure in Figure 328), taking into
consideration any latency requirements. Refer to section 5.2.26.1.1.
