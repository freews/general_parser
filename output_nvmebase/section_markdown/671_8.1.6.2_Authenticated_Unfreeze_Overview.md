##### 8.1.6.2 Authenticated Unfreeze Overview

> **Section ID**: 8.1.6.2 | **Page**: 562-564

Security Send and Security Receive commands, that specify CDP Authentication, are used to submit
authenticated unfreeze operations to the controller and to retrieve the result of that request.
Security Send and Security Receive commands populate the command data buffer with the data frames as
defined in this section.
A controller that supports version N of the data frames defined in Figure 630 and Figure 631:
a) shall not generate an error for any value in the Request Data Frame Version field as a result of
parsing a data frame with a different version than the version of the Request Data Frame data
structure supported by the NVM subsystem (e.g., the controller shall not fail a command due to a
version mismatch);
b) shall process the data frames as defined by version N of these data frames regardless of the value
in the Request Data Frame Version field;
c) shall ignore non-zero values in fields that are reserved in version N of these data frames; and
d) shall not perform any functionality related to these data frames that are not defined by version N of
these data frames.
For example, a controller, supporting version N of any request data frames that receives version N-1 of
these data frames from the host, processes the data frames provided for version N as described in this
section. A controller, supporting version N of the CDP Request Data Frame and CDP Response Data
Frame that receives version N+1 of these data frames from the host, processes the provided data frames
for version N as described in this section.
A host is able to unfreeze a single personality (refer to section 8.1.6.2.2) that supports an authenticated
unfreeze method (refer to the Authenticated Unfreeze Support (AUS) field in Figure 285) by submitting a
Security Send command requesting to unfreeze that personality (i.e., by setting the PERID field in the
Request Data (REQD) field in the CDP Request Data Frame data structure (refer to Figure 630) to a
supported PERID (refer to Figure 447)).
A host is able to unfreeze all personalities that support a given authenticated unfreeze method by submitting
a Security Send command requesting to unfreeze all personalities that support that authentication method
by setting the PERID field in the REQD field in the CDP Request Data Frame data structure to FFh and
setting the CDP Authentication Algorithm Method Identifier (CDPAMI) field in the CDP Unfreeze Request
Data Frame to the value of that authentication method (refer to 8.1.6.2.1).
An authentication command sequence consists of one or more Security Send and Security Receive
commands specifying the NVMe Security Protocol and using CDP Authentication (refer to section 5.2.24.3).
The concurrent processing of an independent authentication command sequence shall be supported for
each Admin Submission Queue and Management Endpoint (refer to the NVM Express Management
Interface Specification).
If a Security Send command is processed requesting to unfreeze a personality that specifies an
authentication method that is not supported by that personality (refer to the CDPALG field in Figure 328),
then the controller returns a successful completion for that Security Send command, and the personality
remains frozen. A controller processing a Security Receive command following that Security Send
command in this sequence shall return a:
â€¢
successful completion for the most recent successfully processed Security Receive command; and
â€¢
CDP Response Data Frame, as defined in Figure 631, containing a Response Message Type with
a value of 04h (i.e., Authentication Method Not Supported) and the corresponding Response Data.
It is not an error to attempt to unfreeze a personality:
â€¢
that is unfrozen; or
â€¢
for an unsupported Personality Identifier.
Security Send and Security Receive commands specifying CDP Authentication (i.e., a SPSP value of
0002h) do not use the NSID field and the NSID field shall be ignored by the controller.
A host is able to retrieve the random nonce by issuing a Security Send command that contains a CDP
Request Data Frame as described in section 8.1.6.3.2 and subsequently submitting a Security Receive
command. The random nonce data returned by the controller is described in Figure 639.
Figure 630 defines all common fields for all request operations. The Request Data for each CDP Request
and Response Message Type (refer to Figure 629) is defined in section 8.1.6.2.1.
Figure 631 defines all common fields for responses to all request operations. Specific response data is
defined in section 8.1.6.2.1.


---
### ðŸ“Š Tables (1)

#### Table 1: Table_8_1_6_2_Authenticated_Unfreeze_Overview
![Table_8_1_6_2_Authenticated_Unfreeze_Overview](../section_images/Table_8_1_6_2_Authenticated_Unfreeze_Overview.png)

| Bytes | Description |
| :--- | :--- |
| | **Header** |
| 00 | Request Data Frame Version (REQDFV): This field specifies the version of this data frame that includes the header and the payload. This field shall be cleared to 0h. |
| 01 | Data Frame Header Length (DFHL): This field specifies the length in bytes of this header. This field shall be set to 4h. |
| 03:02 | Request Header and Common Payload Size (RHCP S): This field specifies the size of this data frame structure in bytes including the header and common payload. This field shall be set to 06h. |
| | **Request Common Payload** |
| 04 | CDP Request Message Type (CDPRMT): This field specifies the Request Message Type value (refer to Figure 629). |
| 05 | Request Data Size (REQDS): This field indicates the length in bytes of the Request Data (REQD) field. |
| (REQDS+5):06 | Request Data (REQD): This field contains CDP Request Data, if any (refer to section 8.1.6.2.1). |
| | **Header** |
| 00 | Response Data Frame Version (RESPDFV): This field indicates the version of this data frame that includes the header and the payload. This field shall be cleared to 0h. |
| 01 | Data Frame Header Length (DFHL): This field indicates the length in bytes of this header. This field shall be set to 4h. |
| 03:02 | Response Data Frame Size (RESPDS): This field indicates the size of this data frame structure in bytes including the header and common payload. This field shall be set to 07h. |
| | **Request Common Payload** |
| 04 | CDP Response Message Type (CDPRMT): This field indicates the CDP response message type. This field shall be set to the Response Message Type value corresponding to this operation (refer to Figure 629). |
| 05 | Result Code (RC): This field indicates the result code. This field shall be set to the Result Code value of the most recent Security Send command that returned a successful completion since the last Controller Level Reset of the controller that processed the corresponding request. |
| | **Bits** | **Description** |
| | | **Result Code:** This field indicates the operation status. Valid operation status values are listed below. |
| | | **Value** | **Definition** |
| | | 00h | Operation Successful |
| | | 01h | General Failure |
| | | 02h | Authentication Failure (e.g., credential comparison not matching) |
| | | 03h | DHK Not Programmed |
| | | 04h | Authentication Method Not Supported |
| | | 05h to FFh | Reserved |
| 06 | Response Data Size (RESPDS): This field indicates the length in bytes of the Response Data (RESPD) field. |
| (RESPDS+6):07 | Response Data (RESPD): This field contains CDP Response Data, if any (refer to section 8.1.6.2.1). |

