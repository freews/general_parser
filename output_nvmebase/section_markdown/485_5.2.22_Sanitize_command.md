#### 5.2.22 Sanitize command

> **Section ID**: 5.2.22 | **Page**: 415-417

The Sanitize command is used to start an NVM subsystem sanitize operation (refer to section 1.5.70) or to
recover from a previously failed NVM subsystem sanitize operation. The NVM subsystem sanitize operation
types that may be supported are Block Erase, Crypto Erase, and Overwrite.
An NVM subsystem sanitize operation consists of:
‚Ä¢
sanitize processing (refer to section 8.1.26), which may include:
deallocation of all media in the NVM subsystem that is allocated for user data; and
additional media modification;
‚Ä¢
optional verification of media in the NVM subsystem that is allocated for user data; and
‚Ä¢
post-verification deallocation of all media in the NVM subsystem that is allocated for user data
following media verification, if any, as described in section 8.1.26.
Refer to section 8.1.26.1 for command processing requirements that are common to the Sanitize command
and the Sanitize Namespace command.
The Sanitize command shall not be supported by Exported NVM Subsystems (refer to section 8.1.26.6).
The Sanitize Capabilities (SANICAP) field in the Identify Controller data structure (refer to Figure 328)
indicates:
a) the NVM subsystem sanitize operation types supported for the Sanitize command;
b) whether setting the No-Deallocate After Sanitize (NDAS) bit (refer to Figure 388) causes media to
be modified as part of sanitize processing;
c) whether the controller inhibits the functionality of the No-Deallocation After Sanitize bit in the
Sanitize command; and
d) whether the controller supports the Media Verification state and the Post-Verification Deallocation
state (refer to the Verification Support (VERS) bit in the SANICAP field in Figure 328).
If the Verification Support (VERS) bit is cleared to ‚Äò0‚Äô and a Sanitize command specifies the Enter Media
Verification State (EMVS) bit set to ‚Äò1‚Äô (refer to Figure 388), then the controller shall abort the command
with a status code of Invalid Field in Command.
If the Verification Support (VERS) bit is set to ‚Äò1‚Äô and a Sanitize command is processed that specifies:
a) the Enter Media Verification State (EMVS) bit set to ‚Äò1‚Äô, the SANACT field set to a value of 010b
(i.e., Block Erase) or a value of 100b (i.e., Crypto Erase), and the No-Deallocate After Sanitize
(NDAS) bit cleared to ‚Äò0‚Äô, then successful sanitize processing is followed by entry to the Media
Verification state;
b) the Enter Media Verification State (EMVS) bit set to ‚Äò1‚Äô and:
a) the SANACT field set to 011b (i.e., Overwrite); or
b) the No-Deallocate After Sanitize (NDAS) bit set to ‚Äò1‚Äô;
then the controller shall abort the command with a status code of Invalid Field in Command;
c) the SANACT field set to 101b (i.e., Exit Media Verification State) and the sanitization target is in
the Media Verification state, then:
‚Ä¢
the controller does not start a new NVM subsystem sanitize operation; and
‚Ä¢
the sanitization target transitions from the Media Verification state to the Post-Verification
Deallocation state, in which all media allocated for user data in the NVM subsystem is
deallocated;
or
the SANACT field set to 101b (i.e., Exit Media Verification State) and the sanitization target is not
in the Media Verification state, then the controller shall abort the command with a status code of
Invalid Field in Command
If any Persistent Memory Region is enabled in an NVM subsystem, then the controller shall abort any
Sanitize command with a status code of Sanitize Prohibited While Persistent Memory Region is Enabled.
If any namespace is write protected in an NVM subsystem (refer to section 8.1.17), then the controller
aborts any Sanitize command with a status code of Namespace is Write Protected.
If one or more controllers in the NVM subsystem is suspended (refer to section 5.2.17.1.1), then the
controller shall abort the command with a status code of Controller Suspended.
Support for Sanitize commands in a Controller Memory Buffer (i.e., submitted to an Admin Submission
Queue in a Controller Memory Buffer or specifying an Admin Completion Queue in a Controller Memory
Buffer) is implementation specific. If an implementation does not support Sanitize commands in a Controller
Memory Buffer and a controller‚Äôs Admin Submission Queue or Admin Completion Queue is in the Controller
Memory Buffer, then the controller shall abort all Sanitize commands with a status code of Command Not
Supported for Queue in CMB.
The Sanitize command uses Command Dword 10 and Command Dword 11. All other command specific
fields are reserved.


---
### üñºÔ∏è Figures (1)

#### Figure 1: Figure 388: Sanitize ‚Äì Command Dword 10
![Figure 388: Sanitize ‚Äì Command Dword 10](../section_images/Figure_5_2_22_Sanitize_command.png)

