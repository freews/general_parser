#### 5.2.22 Sanitize command

> **Section ID**: 5.2.22 | **Page**: 415-417

The Sanitize command is used to start an NVM subsystem sanitize operation (refer to section 1.5.70) or to
recover from a previously failed NVM subsystem sanitize operation. The NVM subsystem sanitize operation
types that may be supported are Block Erase, Crypto Erase, and Overwrite.
An NVM subsystem sanitize operation consists of:
â€¢
sanitize processing (refer to section 8.1.26), which may include:
o
deallocation of all media in the NVM subsystem that is allocated for user data; and
o
additional media modification;
â€¢
optional verification of media in the NVM subsystem that is allocated for user data; and
â€¢
post-verification deallocation of all media in the NVM subsystem that is allocated for user data
following media verification, if any, as described in section 8.1.26.
Refer to section 8.1.26.1 for command processing requirements that are common to the Sanitize command
and the Sanitize Namespace command.
The Sanitize command shall not be supported by Exported NVM Subsystems (refer to section 8.1.26.6).
The Sanitize Capabilities (SANICAP) field in the Identify Controller data structure (refer to Figure 328)
indicates:
a) the NVM subsystem sanitize operation types supported for the Sanitize command;
b) whether setting the No-Deallocate After Sanitize (NDAS) bit (refer to Figure 388) causes media to
be modified as part of sanitize processing;
c) whether the controller inhibits the functionality of the No-Deallocation After Sanitize bit in the
Sanitize command; and
d) whether the controller supports the Media Verification state and the Post-Verification Deallocation
state (refer to the Verification Support (VERS) bit in the SANICAP field in Figure 328).
If the Verification Support (VERS) bit is cleared to â€˜0â€™ and a Sanitize command specifies the Enter Media
Verification State (EMVS) bit set to â€˜1â€™ (refer to Figure 388), then the controller shall abort the command
with a status code of Invalid Field in Command.
If the Verification Support (VERS) bit is set to â€˜1â€™ and a Sanitize command is processed that specifies:
a) the Enter Media Verification State (EMVS) bit set to â€˜1â€™, the SANACT field set to a value of 010b
(i.e., Block Erase) or a value of 100b (i.e., Crypto Erase), and the No-Deallocate After Sanitize
(NDAS) bit cleared to â€˜0â€™, then successful sanitize processing is followed by entry to the Media
Verification state;
b) the Enter Media Verification State (EMVS) bit set to â€˜1â€™ and:
a) the SANACT field set to 011b (i.e., Overwrite); or
b) the No-Deallocate After Sanitize (NDAS) bit set to â€˜1â€™;
then the controller shall abort the command with a status code of Invalid Field in Command;
c) the SANACT field set to 101b (i.e., Exit Media Verification State) and the sanitization target is in
the Media Verification state, then:
â€¢
the controller does not start a new NVM subsystem sanitize operation; and
â€¢
the sanitization target transitions from the Media Verification state to the Post-Verification
Deallocation state, in which all media allocated for user data in the NVM subsystem is
deallocated;
or
the SANACT field set to 101b (i.e., Exit Media Verification State) and the sanitization target is not
in the Media Verification state, then the controller shall abort the command with a status code of
Invalid Field in Command
If any Persistent Memory Region is enabled in an NVM subsystem, then the controller shall abort any
Sanitize command with a status code of Sanitize Prohibited While Persistent Memory Region is Enabled.
If any namespace is write protected in an NVM subsystem (refer to section 8.1.17), then the controller
aborts any Sanitize command with a status code of Namespace is Write Protected.
If one or more controllers in the NVM subsystem is suspended (refer to section 5.2.17.1.1), then the
controller shall abort the command with a status code of Controller Suspended.
Support for Sanitize commands in a Controller Memory Buffer (i.e., submitted to an Admin Submission
Queue in a Controller Memory Buffer or specifying an Admin Completion Queue in a Controller Memory
Buffer) is implementation specific. If an implementation does not support Sanitize commands in a Controller
Memory Buffer and a controllerâ€™s Admin Submission Queue or Admin Completion Queue is in the Controller
Memory Buffer, then the controller shall abort all Sanitize commands with a status code of Command Not
Supported for Queue in CMB.
The Sanitize command uses Command Dword 10 and Command Dword 11. All other command specific
fields are reserved.


---
### ðŸ“Š Tables (1)

#### Table 1: Table_5_2_22_Sanitize_command
![Table_5_2_22_Sanitize_command](../section_images/Table_5_2_22_Sanitize_command.png)

| Bits | Description |
| :--- | :--- |
| 31:11 | Reserved |
| 10 | Enter Media Verification State (EMVS): If this bit is set to '1', then the Media Verification state shall be entered to sanitize processing completes successfully (i.e., the Global Data Erased (GDE) bit is set to '1') (refer to Figure 302).<br>If this bit is cleared to '0', then this bit shall have no effect.<br>If the SANACT field does not specify starting an NVM subsystem sanitize operation (i.e., is set to any value other than 010b, 011b, or 100b), then this bit shall be ignored by the controller. |
| Bits | Description |
| 09 | No-Deallocate After Sanitize (NDAS): If this bit is set to '1' and the No-Deallocate Inhibited bit (refer to Figure 328) is cleared to '0', then the controller shall not deallocate any media in the NVM subsystem that is allocated for user data as a result of successfully completing the NVM subsystem sanitize operation.<br>This bit is:<br>a) cleared to '0'; or<br>b) set to '1' and the No-Deallocate Inhibited bit is set to '1',<br>then the controller should deallocate all media in the NVM subsystem that is allocated for user data as a result of successfully completing the NVM subsystem sanitize operation.<br>If the SANACT field does not specify starting an NVM subsystem sanitize operation (i.e., is set to any value other than 010b, 011b, or 100b), then this bit shall be ignored by the controller. |
| 08 | Overwrite Invert Pattern Between Passes (OIPBP): If this bit is set to '1', then the Overwrite pattern shall be inverted between passes. If this bit is cleared to '0', then the overwrite pattern shall not be inverted between passes. If the Sanitize Action field is set to a value other than 011b (i.e., Overwrite), then this bit shall be ignored by the controller. |
| 07:04 | Overwrite Pass Count (OWPASS): This field specifies the number of overwrite passes (i.e., how many times the media is to be overwritten) using the data from the Overwrite Pattern field of this command. A value of 0h specifies 16 overwrite passes. If the Sanitize Action field is set to a value other than 011b (i.e., Overwrite), then this field shall be ignored by the controller. |
| 03 | Allow Unrestricted Sanitize Exit (AUSE): If this bit is set to '1', then the sanitize processing is performed in unrestricted completion mode (i.e., in the Unrestricted Processing state; refer to section 8.1.26.4.4). If this bit is cleared to '0', then the sanitize processing is performed in restricted completion mode (i.e., in the Restricted Processing state; refer to section 8.1.26.4.2).<br>If the SANACT field does not specify starting an NVM subsystem sanitize operation (i.e., is set to any value other than 010b, 011b, or 100b), then this bit shall be ignored by the controller. |
| 02:00 | Sanitize Action: This field specifies the sanitize action to perform.<br>![](https://i.imgur.com/1d00000.png) |
| Bits | Description |
| 31:00 | Overwrite Pattern (OVRPAT): This field specifies a 32-bit pattern that is used for the Overwrite NVM subsystem sanitize operation. Refer to section 8.1.26.<br>If the Sanitize Action field is set to a value other than 011b (i.e., Overwrite), then this field shall be ignored by the controller. |

