#### 5.2.15 Lockdown command

> **Section ID**: 5.2.15 | **Page**: 398-399

The Lockdown command is used to control the Command and Feature Lockdown capability (refer to section
8.1.5) which configures the prohibition or allowance of execution of the specified command or Set Features
command targeting a specific Feature Identifier.
After a successful completion of a Lockdown command prohibiting a command or Feature Identifier, all
controllers, if applicable, and all management endpoints, if applicable, in the NVM subsystem behave as
described in section 8.1.5.
The Lockdown command uses Command Dword 10 (refer to Figure 353) and Command Dword 14 (refer
to Figure 354). All other command specific fields are reserved.
If the controller supports selection of a UUID:
a) by the Lockdown command; and
b) by the Set Features command (refer to section 5.2.26 and section 8.1.30) and for the vendor
specific Feature Identifier specified by the Opcode or Feature Identifier field, if the Scope field is
set to 2h,
then Command Dword 14 (refer to Figure 354) is used to specify a UUID Index value.
If the controller does not support selection of a UUID:
a) by the Lockdown command;
b) by the Set Features command; or
c) for the vendor specific feature identifier specified by the Opcode or Feature Identifier field, if the
Scope field is set to 2h,
then Command Dword 14 does not specify a UUID Index value. If the Scope field is not set to 2h, then
UUID Index field is ignored.
If a controller processes a Lockdown command that specifies a command opcode or Feature Identifier that
is:
â€¢
not indicated as being able to be prohibited from execution (refer to Figure 271), then that command
shall be aborted with a status code of Prohibition of Command Execution Not Supported; or
â€¢
indicated as being able to be prohibited from execution (refer to Figure 271) but that command
opcode or Feature Identifier is not supported on one of the interfaces specified in the Interface field
(e.g., an Admin Submission Queue, a Management Endpoint) of that Lockdown command, then:
that command should be aborted with a status code of Prohibition of Command Execution
Not Supported; and
that command may be aborted with a status code of Invalid Field in Command.
If a controller processes this command with the Interface field set to 01b or 10b and the NVM subsystem
does not contain a Management Endpoint, then the command shall be aborted with a status code of Invalid
Field in Command.
If a controller processes this command with the Interface field set to 00b or 01b and the Scope field is set
to 4h, then the command shall be aborted with a status code of Invalid Field in Command.
It is not an error to attempt to prohibit a command or Feature Identifier that is already prohibited from
execution or allow a command or Feature Identifier that is already allowed to be executed.


---
### ðŸ“Š Tables (2)

#### Table 1: Table_5_2_15_Lockdown_command_1
![Table_5_2_15_Lockdown_command_1](../section_images/Table_5_2_15_Lockdown_command_1.png)

| Bits | Description |
| :--- | :--- |
| 31:16 | Reserved |
| 15:08 | **Opcode or Feature Identifier (OFI):** This field specifies the command opcode or Set Features Feature Identifier identified by the Scope field. |
| 07 | Reserved |
| 06:05 | **Interface (IFC):** This field identifies the interfaces affected by this command. The actions of this command apply if a command is received on the specified interfaces. <br> <table> <tr> <th>Value</th> <th>Affected Interfaces</th> </tr> <tr> <td>00b</td> <td>Admin Submission Queue</td> </tr> <tr> <td>01b</td> <td>Admin Submission Queue and out-of-band on a Management Endpoint</td> </tr> <tr> <td>10b</td> <td>Out-of-band on a Management Endpoint</td> </tr> <tr> <td>11b</td> <td>Reserved</td> </tr> </table> |
| 04 | **Prohibit (PRHBT):** This bit specifies whether to prohibit or allow the command opcode or Set Features Feature Identifier specified by this command. If this bit is set to '1', then this command prohibits the execution of the command based on other fields specified in Dword 10. If this bit is cleared to '0', then this command allows the execution of the command based on other fields specified in Dword 10. |
| Bits | Description |
| :--- | :--- |
| 03:00 | **Scope (SCP):** This field specifies the contents of the Opcode or Feature Identifier field. <br> <table> <tr> <th>Value</th> <th>Opcode or Feature Identifier Definition</th> </tr> <tr> <td>0h</td> <td>Admin command opcode</td> </tr> <tr> <td>1h</td> <td>Reserved</td> </tr> <tr> <td>2h</td> <td>A Set Features Feature Identifier</td> </tr> <tr> <td>3h</td> <td>Management Interface Command Set opcode (refer to the NVM Express Management Interface Specification)</td> </tr> <tr> <td>4h</td> <td>PCIe Command Set opcode (refer to the NVM Express Management Interface Specification)</td> </tr> <tr> <td>5h-Fh</td> <td>Reserved</td> </tr> </table> |


#### Table 2: Table_5_2_15_Lockdown_command_2
![Table_5_2_15_Lockdown_command_2](../section_images/Table_5_2_15_Lockdown_command_2.png)

| Bits | Description |
|:---|:---|
| 31:07 | Reserved |
| 06:00 | UUID Index (UIDX): Refer to Figure 716. |

