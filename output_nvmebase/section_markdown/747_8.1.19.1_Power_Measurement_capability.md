##### 8.1.19.1 Power Measurement capability

> **Section ID**: 8.1.19.1 | **Page**: 623-624

The Power Measurement capability enables a host to control the logging of interval power measurements
The logged interval power measurements are used to report:
•
the average of the interval power measurements;
•
the maximum interval power measurement; and
•
a histogram of the interval power measurements.
If the Power Measurement capability is supported (i.e., the PMS bit is set to ‘1’ in the Identify Controller
data structure, refer to Figure 328), then the controller shall support:
a) the Power Measurement feature (refer to section 5.2.26.1.27); and
b) the Power Measurement log page (refer to section 5.2.12.1.33).
The Power Measurement feature is used to control the Power Measurement capability. The Power
Measurement log page is used for the reporting of logged interval power measurements for the Power
Measurement capability.
The host requests the controller start collecting interval power measurements of a specified power
measurement type (refer to Figure 679) for the Power Measurement log page by issuing a Set Features
command specifying the Power Measurement feature with the Action field set to 1h (i.e., Start Power
Measurements).
The host requests the controller stop collecting interval power measurements for the Power Measurement
log page:
•
by issuing a Set Features command specifying the Power Measurement feature with the Action
field set to 0h (i.e., Stop Power Measurements); or
•
by issuing a Set Features command specifying the Power Measurement feature with the Action
field set to 1h (i.e., Start Power Measurements) and specifying a non-zero value in the Stop
Measurement Time field (refer to Figure 454).
If a controller processes a successful Set Features command specifying:
a) the Power Measurement feature;
b) the Action field set to 1h (i.e., Start Power Measurements); and
c) a non-zero value in the Stop Measurement Time field (refer to Figure 454),
then after the controller has logged interval power measurements in the Power Measurement log page for
the time specified in the Stop Measurement Time field, the controller shall:
If a controller processes a Set Features command specifying:
a) the Power Measurement feature;
b) the Action field set to 1h (i.e., Start Power Measurements); and
c) the value in the Stop Measurement Time field (refer to Figure 454) is greater than a non-zero value
reported in the Maximum Stop Measurement Time (MSMT) field in the Identify Controller data
structure (refer to Figure 328,
then the controller shall abort that command with a status code of Invalid Field in Command.
The Number of Power Histogram Descriptors Supported (NPHDS) field in the Power Measurement log
page indicates the maximum number of Power Histogram Descriptors capable of being reported in the
Power Measurement log page.
If:
•
the Number of Power Histogram Descriptors Supported (NPHDS) field in the Power Measurement
log page is set to a non-zero value;
•
the Power Measurement Count (PMC) field in the Power Measurement log page is set to a non-
zero value; and
•
at least one interval power measurement logged in the Power Measurement log page is greater
than the maximum power indicated by the last Power Histogram Descriptor (i.e., Power Histogram
Descriptor NPHD-1, refer to Figure 297),
then the controller shall set Power Histogram Descriptor Overflow (PHDO) bit to ‘1’ in the Power
Measurement log page.
If the controller is collecting interval power measurements for the Power Measurement log page (i.e., the
PME bit is set to ‘1’), then the controller shall use each interval power measurement (i.e., average of power
measurement samples over one second, refer to section 8.1.19) to:
a) update the Average Interval Power field (i.e., calculate the average of the interval power
measurements collected for the Power Measurement log page (refer to Figure 297));
b) update the:
Maximum Interval Power field (refer to Figure 297); and
Maximum Interval Power Timestamp field (refer to Figure 297), if supported,
if the interval power measurement is greater than the power indicated in the Maximum Interval
Power field;
c) increment the Power Histogram Bin Count field of the associated Power Histogram Descriptor in
the Power Measurement log page (refer to Figure 297), if the interval power measurement is:
greater than or equal to the power indicated in the Power Histogram Bin Lower Threshold field
of that Power Histogram Descriptor; and
less than the sum of:
▪
the power indicated in the Power Histogram Bin Lower Threshold field of that
Power Histogram Descriptor; and
▪
the power indicated in the Power Histogram Bin Size field (refer to Figure 297);
d)
t th
t C
t (PMC) fi ld i
th
t l
(
d) increment the Power Measurement Count (PMC) field in the Power Measurement log page (refer
to Figure 297); and
e) increment the Power Histogram Descriptor Overflow Count (PHDOC) field, if the interval power
measurement is greater than the maximum power indicated by the last Power Histogram Descriptor
(i.e., Power Histogram Descriptor NPHD-1, refer to Figure 297) in the Power Measurement log
page.
