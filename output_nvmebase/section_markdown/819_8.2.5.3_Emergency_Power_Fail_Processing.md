##### 8.2.5.3 Emergency Power Fail Processing

> **Section ID**: 8.2.5.3 | **Page**: 692-693

This section describes the behavior of each controller in the domain when the domain is configured for
Power Loss Signaling with Emergency Power Fail (refer to section 5.2.26.1.19).
If the controller enters the EPF Processing Port Disabled state or the EPF Processing Port Enabled state
as described in Figure 721, then the controller shall perform the following actions in sequence:
1. set the PLA variable, if supported, to the value specified in Figure 719 for that state (i.e., Asserted-
EPF-Disabled or Asserted-EPF-Enabled);
2. stop fetching commands on all submission queues;
3. perform the following actions in parallel or in any sequence:
a) process port communications as described in Figure 719; and
b) prepare for power loss in a manner that may or may not allow command processing to resume
quickly in the event of power loss and then power resumption;
4. enter either the EPF Complete Port Enabled state (refer to Figure 726) or the EPF Complete Port
Disabled state (refer to Figure 725); and
5. set the PLA variable, if supported, to Deasserted (refer to Figure 719).
Entry to the EPF Processing Port Disabled state or the EPF Processing Port Enabled state shall cause the
controller to discard commands that were fetched from a submission queue prior to entry to the state, and
to discard commands that were received out-of-band on a Management Endpoint prior to entry to the state.
The controller may implement the EPF Processing Port Disabled state or the EPF Processing Port Enabled
state. The controller shall not implement both states. All controllers in the domain shall implement the same
state.
The Emergency Power Fail Recovery Time (EPFRT) field and the Emergency Power Fail Recovery Time
Scale (EPFRTS) field (refer to Figure 329) indicate the time that the controller requires to complete recovery
during the first initialization following successful completion of Emergency Power Fail Processing. It is
implementation specific whether the controller begins recovery before or after the host sets the CC.EN bit
to ‘1’. Recovery may or may not be complete when the controller sets the CSTS.RDY bit to ‘1’.
If Emergency Power Fail Processing does not complete successfully (e.g., main power was lost before
completion of processing), then the recovery time may exceed the Emergency Power Fail Recovery Time.
