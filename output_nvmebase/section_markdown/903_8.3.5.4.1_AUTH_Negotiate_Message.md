###### 8.3.5.4.1 AUTH_Negotiate Message

> **Section ID**: 8.3.5.4.1 | **Page**: 743-745

The AUTH_Negotiate message is sent from the host to the controller and is used to indicate the
authentication protocols the host is able to use in this authentication transaction and which secure channel
protocol, if any, to concatenate to this authentication transaction. The AUTH_Negotiate message format is
shown in Figure 789.
The SC_C field determines if a secure channel concatenation to the authentication transaction is requested
and with which secure channel protocol, as shown in Figure 790.
An authentication transaction with the SC_C field set to NOSC is allowed on any Admin or I/O Queue and
does not generate a PSK (i.e., it performs authentication only).
An authentication transaction with the SC_C field set to NEWTLSPSK:
‚Ä¢
is allowed on an Admin Queue over a TCP channel without TLS and generates a new PSK;
‚Ä¢
is prohibited on an I/O Queue over a TCP channel without TLS; and
‚Ä¢
is prohibited on an Admin Queue or I/O queue over a TLS secure channel.
An authentication transaction with the SC C field set to REPLACETLSPSK:
‚Ä¢
is allowed on an Admin Queue over a TLS secure channel and replaces the association‚Äôs PSK;
‚Ä¢
is prohibited on an Admin Queue or I/O queue over a TCP channel without TLS; and
‚Ä¢
is prohibited on an I/O Queue over a TLS secure channel.
The AUTH_Negotiate message is structured as a list of 64-byte authentication protocol descriptors to
enable extensibility to define additional authentication protocols. Currently only one authentication protocol
is defined (i.e., DH-HMAC-CHAP), therefore the AUTH_Negotiate message carries only one authentication
protocol descriptor (i.e., NAPD=1). Implementations should support more than one descriptor to enable
protocol extensibility. The first byte of an authentication protocol descriptor identifies the specific
authentication protocol, as shown in Figure 791.
Upon receiving an AUTH_Negotiate message, if the SC_C value indicated by the host:
‚Ä¢
does not satisfy the security requirements of the controller (e.g., the host did not request secure
channel concatenation, but the controller‚Äôs security configuration requires secure channel
concatenation);
‚Ä¢
is prohibited for the Admin Queue or I/O Queue via which the AUTH_Negotiate message was
received, as specified in this section; or
‚Ä¢
requests secure channel concatenation and that value is contained in an AUTH_Negotiate
message received over a secure channel established in compliance with the requirements of an
NVM Express Transport specification (e.g., the NVMe over TCP Transport Specification),
then the controller shall:
‚Ä¢
reply to the AUTH_Negotiate message with an AUTH_Failure1 message having reason code
‚ÄòAuthentication failure‚Äô and reason code explanation ‚ÄòSecure channel concatenation mismatch‚Äô; and
‚Ä¢
disconnect the NVMe over Fabrics connection upon transmitting the AUTH_Failure1 message.
Upon receiving an AUTH_Negotiate message, if the protocol descriptors proposed by the host do not satisfy
the security requirements of the controller, then the controller shall:
‚Ä¢
reply to the AUTH_Negotiate message with an AUTH_Failure1 message having reason code
‚ÄòAuthentication failure‚Äô and reason code explanation ‚ÄòAuthentication protocol not usable‚Äô; and
‚Ä¢
disconnect the NVMe over Fabrics connection upon transmitting the AUTH_Failure1 message.


---
### üñºÔ∏è Figures (2)

#### Figure 1: Figure 789: AUTH_Negotiate message format
![Figure 789: AUTH_Negotiate message format](../section_images/Figure_8_3_5_4_1_AUTH_Negotiate_Message_1.png)


#### Figure 2: Figure 790: Secure channel protocol identifiers
![Figure 790: Secure channel protocol identifiers](../section_images/Figure_8_3_5_4_1_AUTH_Negotiate_Message_2.png)

