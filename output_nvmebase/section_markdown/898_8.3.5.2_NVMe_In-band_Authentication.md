##### 8.3.5.2 NVMe In-band Authentication

> **Section ID**: 8.3.5.2 | **Page**: 739-740

The Authentication and Security Requirements (AUTHREQ) field in the Connect response capsule (refer
to Figure 581) indicates whether NVMe in-band authentication is required.
If one or more of the bits in the AUTHREQ field are set to ‚Äò1‚Äô, then the controller requires that the host
authenticate on that queue in order to proceed with Fabrics, Admin, and I/O commands. Authentication
success is defined by the specific security protocol that is used for authentication. If any command other
than Connect, Authentication Send, or Authentication Receive is received prior to authentication success,
then the controller shall abort the command with Authentication Required status.
If all bits in the AUTHREQ field are cleared to ‚Äò0‚Äô, then the controller does not require the host to
authenticate, and the NVM subsystem shall not abort any command with a status code value of
Authentication Required.
Refer to section 8.3.5.2.1 for considerations on Discovery subsystems.
The host may initiate a subsequent authentication transaction at any time for reauthentication purposes.
Initiating reauthentication shall not invalidate a prior authentication. If the reauthentication transaction
concludes with the controller sending an AUTH_Failure1 message (refer to section 8.3.5.4.2), then the
controller shall terminate all commands with a status code of Operation Denied and disconnect the NVMe
over Fabrics connection. If the reauthentication transaction concludes with the host sending an
AUTH Failure2 message, then the host shall disconnect the NVMe over Fabrics connection.
The state of an in-progress authentication transaction is soft-state. If the subsequent command in an
authentication transaction is not received by the controller within a timeout equal to:
‚Ä¢
the Keep Alive Timeout value (refer to Figure 579), if the Keep Alive Timer is enabled; or
‚Ä¢
the default Keep Alive Timeout value (i.e., two minutes), if the Keep Alive Timer is disabled,
then the authentication transaction has timed out and the controller should discard the authentication
transaction state (including the T ID value, refer to section 8.3.5.4.1).
For an initial authentication, an authentication transaction timeout should be treated as an authentication
failure with termination of the transport connection. For reauthentication, an authentication transaction
timeout should not be treated as an authentication failure. Authentication commands used to continue that
transaction after an authentication transaction timeout should be aborted with a status code of Command
Sequence Error.
Figure 784 shows an example of authentication transaction for NVMe/TCP.


---
### üñºÔ∏è Figures (1)

#### Figure 1: Figure 784: Example of authentication transaction for NVMe/TCP
![Figure 784: Example of authentication transaction for NVMe/TCP](../section_images/Figure_8_3_5_2_NVMe_In_band_Authentication.png)

