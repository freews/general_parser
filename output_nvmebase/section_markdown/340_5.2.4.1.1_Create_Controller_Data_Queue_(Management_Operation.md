###### 5.2.4.1.1 Create Controller Data Queue (Management Operation 0h)

> **Section ID**: 5.2.4.1.1 | **Page**: 213-215

The Create Controller Data Queue management operation of the Controller Data Queue command is used
to create a queue in host memory to which a controller posts the information specified by the Queue Type
field (refer to Figure 169).
The Create Controller Data Queue management operation uses the PRP Entry 1 field, Command Dword
11 field, and Command Dword 12 field.
If a PRP List is provided to describe the Controller Data Queue, then the PRP List shall be maintained by
the host at the same location in host physical memory and the values in the PRP List shall not be modified
until the Controller Data Queue is deleted (refer to section 5.2.4.1.2) or the controller is reset. If the PRP
List values are modified, then the behavior is undefined.
If the number of memory ranges specified by the PRP Entry 1 field is greater than the value defined by the
Maximum CDQ Memory Ranges (MCMR) field in the Identify Controller data structure (refer to Figure 328),
then the controller shall abort the command with a status code of Invalid Field in Command.
If the number of memory ranges specified by the PRP Entry 1 field plus the number of memory ranges that
exists for all of the Controller Data Queues in the NVM subsystem is greater than the value defined by the
NVM Subsystem Maximum Controller CDQ Memory Ranges (NMCMR) field in the Identify Controller data
structure (refer to Figure 328), then the controller shall abort the command with a status code of Invalid
Field in Command.
If the current number of User Data Migration Queues that exist in the controller is equal to the value in the
Maximum Controller User Data Migration Queues (MCUDMQ) field in the Identify Controller data structure,
then the controller shall abort the command with a status code of Invalid Field in Command.
If the current number of User Data Migration Queues that exist in the NVM subsystem is equal to the value
in the Maximum NVM Subsystem User Data Migration Queues (MNSUDMQ) field in the Identify Controller
data structure, then the controller shall abort the command with a status code of Invalid Field in Command.
If the Controller Data Queue Size field value is not a multiple of the size of the entries for the type of
Controller Data Queue as specified by the Queue Type field (refer to Figure 169), then the controller shall
abort the command with a status code of Invalid Field in Command.
The Management Operation Specific field (refer to Figure 165) for the Create Controller Data Queue
management operation is specified in Figure 169.
If the PRP Entry 1 field has a non-zero PRP offset, then the controller shall abort the command with a status
code of PRP Offset Invalid.


---
### üñºÔ∏è Figures (4)

#### Figure 1: Figure 166: Create Controller Data Queue ‚Äì PRP Entry 1
![Figure 166: Create Controller Data Queue ‚Äì PRP Entry 1](../section_images/Figure_5_2_4_1_1_Create_Controller_Data_Queue_Management_Operation_0h_1.png)


#### Figure 2: Figure 167: Create Controller Data Queue ‚Äì Command Dword 11
![Figure 167: Create Controller Data Queue ‚Äì Command Dword 11](../section_images/Figure_5_2_4_1_1_Create_Controller_Data_Queue_Management_Operation_0h_2.png)


#### Figure 3: Figure 168: Create Queue ‚Äì Command Dword 12
![Figure 168: Create Queue ‚Äì Command Dword 12](../section_images/Figure_5_2_4_1_1_Create_Controller_Data_Queue_Management_Operation_0h_3.png)


#### Figure 4: Figure 169: Create Controller Data Queue ‚Äì Management Operation Specific
![Figure 169: Create Controller Data Queue ‚Äì Management Operation Specific](../section_images/Figure_5_2_4_1_1_Create_Controller_Data_Queue_Management_Operation_0h_4.png)

