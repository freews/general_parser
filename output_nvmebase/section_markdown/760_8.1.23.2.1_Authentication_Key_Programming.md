###### 8.1.23.2.1 Authentication Key Programming

> **Section ID**: 8.1.23.2.1 | **Page**: 638-639

Authentication Key programming is initiated by a Security Send command to program the Authentication
Key to the specified RPMB target, followed by a subsequent Security Send command to request the result,
and lastly, the host issues a Security Receive command to retrieve the result.


---
### ðŸ“Š Tables (1)

#### Table 1: Table_8_1_23_2_1_Authentication_Key_Programming
![Table_8_1_23_2_1_Authentication_Key_Programming](../section_images/Table_8_1_23_2_1_Authentication_Key_Programming.png)

| Command | Bytes in Command | Field Name | Value | Objective |
| :--- | :--- | :--- | :--- | :--- |
| Security Send 1 | Data populated by the host and sent to the controller | | | |
| | 222-0:00 | Stuff Bytes | 0...00h | |
| | 222:222-(N-1) | MAC/Key | Key to be programmed | Send Authentication Key to be Programmed to the controller |
| | 223 | RPMB Target | RPMB target to access | |
| | 239:224 | None | 0...00h | |
| | 243:240 | Write Counter | 00000000h | |
| | 247:244 | Address | 00000000h | |
| | 251:248 | Sector Count | 00000000h | |
| | 253:252 | Result | 0000h | |
| | 255:254 | Request/Response | 0001h (Request) | |
| Security Send 2 | Data populated by the host and sent to the controller | | | |
| | 222-0:00 | Stuff Bytes | 0...00h | |
| | 222:222-(N-1) | MAC/Key | 0...00h | |
| | 223 | RPMB Target | RPMB target to access | Request Result of Key Programming |
| | 239:224 | None | 0...00h | |
| | 243:240 | Write Counter | 00000000h | |
| | 247:244 | Address | 00000000h | |
| | 251:248 | Sector Count | 00000000h | |
| | 253:252 | Result | 0000h | |
| | 255:254 | Request/Response | 0005h (Request) | |
| Security Receive 1 | Data populated by the controller and returned to the host | | | |
| | 222-N:00 | Stuff Bytes | 0...00h | |
| | 222:222-(N-1) | MAC/Key | 0...00h | Retrieve the Key Programming Result |
| Command | Bytes in Command | Field Name | Value | Objective |
| | | | | |
| | 223 | RPMB Target | RPMB target response was sent from | |
| | 239:224 | None | 0...00h | |
| | 243:240 | Write Counter | 00000000h | |
| | 247:244 | Address | 00000000h | |
| | 251:248 | Sector Count | 00000000h | |
| | 253:252 | Result | | |
| | 255:254 | Request/Response | 0100h (Response) | |

