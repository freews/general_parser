{
  "section_index": 853,
  "section_id": "8.3.2.2.2",
  "title": "8.3.2.2.2 Pull Registrations and Pull De-Registrations",
  "level": 5,
  "pages": {
    "start": 706,
    "end": 707,
    "count": 2
  },
  "content": {
    "text": "A pull registration may be requested using a kickstart discovery request and response sequence (refer to\nsection 8.3.2.2.2).\nUpon completion of acknowledging a pull registration request (e.g., after a KDResp NVMe/TCP PDU (refer\nto the Kickstart Discovery Response PDU section in the NVMe over TCP Transport Specification) has been\nsent by the Centralized Discovery controller (CDC)), the CDC performs the pull registration by:\n1. sending a Connect command to the Direct Discovery controller (DDC) to establish an NVMe\nconnection with that DDC; and\n2. sending a Get Log Page command to the DDC with the Log Page Identifier (LID) field set to 70h to\nretrieve NVM subsystem discovery information contained in the associated Discovery log page\nfrom that DDC. The CDC may:\na. set the Port Local Entries Only (PLEO) bit to ‘1’ in the Log Specific Parameter (LSP) field in\nthat Get Log Page command to request that NVM subsystem discovery information entries for\nonly NVM subsystem ports that are presented through the same NVM subsystem port on the\nDDC that received the Get Log Page command be returned; and\nb. set the All NVM Subsystem Entries (ALLSUBE) bit to ‘1’ in the LSP field in that Get Log Page\ncommand to request that records for all NVM subsystem ports be returned.\nThe DDC should match the NQN contained in the CDC NVMe Qualified Name (CDCNQN) field of the\nKDResp NVMe/TCP PDU with the NQN contained in the Host NVMe Qualified Name (HOSTNQN) field in\nthe data portion of the Connect command to know that a CDC is performing a pull registration.\nIf the PLEO bit is cleared to ‘0’ and the ALLSUBE bit is set ‘1’ in the LSP field of the Get Log Page command,\nthen the DDC shall return all NVM subsystem discovery information entries in the resulting Discovery log\npage sent to the CDC (i.e., the DDC shall not filter out any NVM subsystem discovery information entries).\nIf the PLEO bit is set to ‘1’ and the ALLSUBE bit is set ‘1’ in the LSP field of the Get Log Page command,\nthen the DDC shall return all NVM subsystem discovery information entries for NVM subsystem ports that\nare presented through the same NVM subsystem port on the DDC that received the Get Log Page\ncommand in the resulting Discovery log page sent to the CDC (i.e., the DDC shall not filter out any NVM\nsubsystem discovery information entries for NVM subsystem ports that are presented through the same\nNVM subsystem port on the DDC that received the Get Log Page command).\nAn additional pull registration or a pull de-registration may be requested by either:\n•\nsending a Discovery Log Page Change Asynchronous Event notification (Asynchronous Event\nInformation F0h) (refer to section 3.1.3.3.2); or\n•\nrequesting another pull registration.\nIf the CDC established an explicit persistent connection with the DDC when performing the previous pull\nregistration, then the DDC should request the additional pull registration or the pull de-registration by\nsending a Discovery Log Page Change Asynchronous Event notification.\nIf the CDC did not establish an explicit persistent connection with the DDC when performing the previous\npull registration, then the DDC requests the additional pull registration or the pull de-registration by\nrequesting another pull registration.\nUpon receiving a Discovery Log Page Change Asynchronous Event notification, the CDC performs the\nadditional pull registration or the pull de-registration by using the following sequence:\n1. sending a Get Log Page command to the DDC with the LID field set to 70h to retrieve NVM\nsubsystem discovery information contained in the associated Discovery log page from that DDC.\nThe CDC may:\na. set the Port Local Entries Only (PLEO) bit to ‘1’ in the Log Specific Parameter (LSP) field in\nthat Get Log Page command to request that NVM subsystem discovery information entries for\nonly NVM subsystem ports that are presented through the same NVM subsystem port on the\nDDC that received the Get Log Page command be returned; and\nb. set the All NVM Subsystem Entries (ALLSUBE) bit to ‘1’ in the LSP field in that Get Log Page\ncommand to request that records for all NVM subsystem ports be returned;\nand\n2. replacing all existing NVM subsystem discovery information from the previous pull registration with\nthe newly retrieved NVM subsystem discovery information (i.e., only the most recent NVM\nsubsystem discovery information from that DDC is retained by the CDC).\nUpon receiving another pull registration request, the CDC performs the additional pull registration or the\npull de-registration by using the following sequence:\n1. acknowledging that pull registration request (refer to section 8.3.2.2.2.1 for kickstart discovery);\nand\n2. sending a Connect command to the DDC to establish an NVMe connection with that DDC ; and\n3. sending a Get Log Page command to the DDC with the LID field set to 70h to retrieve NVM\nsubsystem discovery information contained in the associated Discovery log page from that DDC.\nThe CDC may:\na. set the Port Local Entries Only (PLEO) bit to ‘1’ in the Log Specific Parameter (LSP) field of the\nGet Log Page command to request that NVM subsystem discovery information entries for only\nNVM subsystem ports that are presented through the same NVM subsystem port on the DDC\nthat received the Get Log Page command be returned; and\nb. set the All NVM Subsystem Entries (ALLSUBE) bit to ‘1’ in the LSP field of the Get Log Page\ncommand to request that records for all NVM subsystem ports be returned;\nand\n4. replacing all existing NVM subsystem discovery information from the previous pull registration with\nthe newly retrieved NVM subsystem discovery information (i.e., only the most recent NVM\nsubsystem discovery information from that DDC is retained by the CDC).",
    "tables": [],
    "figures": []
  },
  "statistics": {
    "table_count": 0,
    "figure_count": 0
  }
}