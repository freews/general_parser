{
  "section_index": 921,
  "section_id": "8.3.5.6.3",
  "title": "8.3.5.6.3 AVE Access Protocol",
  "level": 5,
  "pages": {
    "start": 763,
    "end": 765,
    "count": 3
  },
  "content": {
    "text": "Communication with a DH-HMAC-CHAP AVE uses two PDUs, DH-HMAC-CHAP_Access-Request and\nDH-HMAC-CHAP_Access-Result, that are sent directly over the TLS connection with the AVE (refer to\nsection 8.3.5.6.2). The format of the DH-HMAC-CHAP Access-Request PDU is shown in Figure 813.\nThe DH-HMAC-CHAP_Access-Request PDU contains the parameters exchanged by the host and the\ncontroller during a DH-HMAC-CHAP authentication transaction. The responder is the entity that replied to\na DH-HMAC-CHAP challenge sent by an authenticator.\nReferring to Figure 812, when the controller transmits the DH-HMAC-CHAP_Access-Request PDU, the\nparameters are instantiated as follows:\n•\nResponder’s Role: ‘H’\n•\nSequence Number: S1\n•\nAugmented Challenge Value: Ca1\n•\nResponse Value: R1\n•\nNQNR: NQNh\n•\nHashID, T_ID, SC_C: the correspondent DH-HMAC-CHAP parameters\nWhen the host transmits the DH-HMAC-CHAP_Access-Request PDU, the parameters are instantiated as\nfollows:\n•\nResponder’s Role: ‘C’\n•\nSequence Number: S2\n•\nAugmented Challenge Value: Ca2\n•\nResponse Value: R2\n•\nNQNR: NQNc\n•\nHashID, T_ID, SC_C: the correspondent DH-HMAC-CHAP parameters\nUpon receiving a DH-HMAC-CHAP_Access-Request PDU, the AVE shall perform the following steps in\norder:\n1.\nLookup the DH-HMAC-CHAP key of the responder (i.e., Kr) from NQNR;\n2.\nIf the Responder’s Role is ‘H’, compute the expected response R’ as:\nR’ = HMAC(Kr, Ca || S || T_ID || SC_C || ”HostHost” || NQNr || 00h || NQNa)\nwhere NQNa is the NQN of the authenticator;\n3.\nIf the Responder’s Role is ‘C’, compute the expected response R’ as:\nR’ = HMAC(Kr, Ca || S || T_ID || SC_C || ”Controller” || NQNr || 00h || NQNa)\nwhere NQNa is the NQN of the authenticator; and\n4.\nCompare the expected response R’ with the response value R received in the DH-HMAC-\nCHAP_Access-Request PDU. If R’ = R then the authentication is successful; if R’ ≠ R then the\nauthentication has failed.\nThe NQN of the authenticator (i.e., NQNa) is retrieved from the TLS identity associated to the TLS\nconnection with the AVE (refer to section 8.3.5.6.2).\nThe result of an authentication verification is returned to the NVMe entity in a DH-HMAC-CHAP_Access-\nResult PDU. The format of the DH-HMAC-CHAP_Access-Result PDU is shown in Figure 814.",
    "tables": [],
    "figures": [
      {
        "id": "figure_763_835",
        "page": 763,
        "bbox": [
          115.0,
          835.0,
          883.0,
          899.0
        ],
        "detected_title": "Figure 813: DH-HMAC-CHAP_Access-Request PDU format",
        "title": "Figure 813: DH-HMAC-CHAP_Access-Request PDU format",
        "image_path": "Figure_8_3_5_6_3_AVE_Access_Protocol.png",
        "merged_count": 3
      }
    ]
  },
  "statistics": {
    "table_count": 0,
    "figure_count": 1
  }
}