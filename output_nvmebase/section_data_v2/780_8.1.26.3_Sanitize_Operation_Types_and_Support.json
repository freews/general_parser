{
  "section_index": 780,
  "section_id": "8.1.26.3",
  "title": "8.1.26.3 Sanitize Operation Types and Support",
  "level": 4,
  "pages": {
    "start": 657,
    "end": 660,
    "count": 4
  },
  "content": {
    "text": "The Sanitize Capabilities (SANICAP) field of the Identify Controller data structure (refer to Figure 328)\nindicates the sanitize operation types supported and controller attributes specific to sanitize operations.\nThe sanitize operation types are:\n•\nthe Block Erase sanitize operation, which alters user data with a low-level block erase method that\nis specific to the media for all locations on the media within the sanitization target in which user\ndata may be stored;\n•\nthe Crypto Erase sanitize operation, which alters user data by changing the media encryption keys\nfor all locations on the media within the sanitization target in which user data may be stored; and\n•\nthe Overwrite sanitize operation, which alters user data by writing a fixed data pattern or related\npatterns one or more times to all locations on the media within the sanitization target in which user\ndata may be stored. Figure 705 defines the data pattern or patterns that are written.\nController attributes that affect the processing of sanitize operations include:\n•\nthe No-Deallocate Modifies Media After Sanitize (NODMMAS) field, which indicates whether media\nis modified by the controller as part of sanitize processing for an NVM subsystem sanitize operation\nand that had been requested with the No-Deallocate After Sanitize (NDAS) bit set to ‘1’ in the\nSanitize command that started the NVM subsystem sanitize operation;\n•\nthe No-Deallocate Inhibited (NDI) bit, which indicates if the controller supports the No-Deallocate\nAfter Sanitize bit in the Sanitize command;\n•\nthe Verification Support (VERS) bit, which indicates if the controller supports the Media Verification\nstate and the Post-Verification Deallocation state for NVM subsystem sanitize operations that\nperform block erase or crypto erase; and\n•\nthe Namespace Verification Support (NVERS) bit, which indicates if the controller supports the\nMedia Verification state and the Post-Verification Deallocation state for namespace sanitize\noperations.\nIf the NODMMAS field indicates a value of 10b in the Identify Controller data structure (refer to Figure 328)\nand a Sanitize command that starts an NVM subsystem sanitize operation specifies the No-Deallocate After\nSanitize (NDAS) bit set to ‘1’, then sanitize processing includes additional media modification. Refer to\nAnnex A.3 for further information about sanitize operations and interactions with integrity circuits.\nThe Overwrite sanitize operation is media specific and may not be appropriate for all media types. For\nexample, if the media is NAND, multiple pass overwrite operations may have an adverse effect on media\nendurance.\nIf the NVM subsystem supports the Key Per I/O capability (refer to section 8.1.14), then a sanitize operation\nshall alter all user data such that recovery of any previous user data using the KEYTAG values specified\nwhen that previous user data was written (i.e., original KEYTAG values) is infeasible for a given level of\neffort (refer to ISO/IEC 27040).\nTo start a sanitize operation, the host:\n•\nsubmits a Sanitize command specifying the SANACT field set to:\no\n010b (i.e., start a Block Erase type NVM subsystem sanitize operation);\no\n011b (i.e., start an Overwrite type NVM subsystem sanitize operation); or\no\n100b (i.e., start a Crypto Erase type NVM subsystem sanitize operation).\nor\n•\nsubmits a Sanitize Namespace command specifying the SANACT field set to 100b (i.e.\nCrypto Erase type namespace sanitize operation).\nFollowing a successful sanitize operation, the values of user data (including protection information (PI), if\nany, and non-PI metadata, if any) that result from an audit (refer to section 1.5.11) of the sanitization target\nare defined in the NVM Express I/O Command Set specifications.\nThe Sanitize Status log page (refer to section 5.2.12.1.36) indicates estimated times for sanitize operations\nand a consistent snapshot of information about the most recently started sanitize operation for the\nsanitization target specified in the Get Log Page command, including whether a sanitize operation is in\nprogress, the sanitize operation parameters and the status of the most recent sanitize operation. The\ncontroller shall report that a sanitize operation is in progress if:\n•\nsanitize processing is in progress (including additional media modification, if required);\n•\nthe sanitization target is in the Media Verification state; or\n•\nthe sanitization target is in the Post-Verification Deallocation state.\nIf an NVM subsystem sanitize operation is not in progress, then the Global Data Erased (GDE) bit in the\nlog page indicates whether the NVM subsystem contains any user data (i.e., whether the NVM subsystem\nhas been written to since the most recent successful NVM subsystem sanitize operation).\nIf a namespace sanitize operation is not in progress on the namespace associated with a Sanitize Status\nlog page, then the Namespace Data Erased (NDE) bit in that log page indicates whether the namespace\nmay contain any user data (i.e., whether the namespace has been written to since the most recent\nsuccessful namespace sanitize operation).\nThe Sanitize Status log page shall be:\n•\ninitialized before any controller in the NVM subsystem is ready as described in sections 3.5.3 and\n3.5.4;\n•\nupdated when a namespace is created (i.e., the Sanitize Status log page for that namespace is\ncreated); and\n•\nupdated when any state transition occurs (refer to section 8.1.26.4).\nThe Sanitize Status log page is updated periodically during a sanitize operation to make progress\ninformation available to hosts.\nDuring a sanitize operation, the host may periodically examine the Sanitize Status log page to check for\nprogress, however, the host should limit this polling (e.g., to at most once every several minutes) to avoid\ninterfering with the progress of the sanitize operation itself.\nThe Sanitize Progress (SPROG) field in the Sanitize Status log page indicates progress during states that\nmay take long times to complete (i.e., the Restricted Processing state, the Unrestricted Processing state,\nand the Post-Verification Deallocation state). The SPROG field is cleared to 0h upon entry to any of those\nstates, and while in any of those states is updated as described in Figure 302. The SPROG field shall not\nbe modified under any conditions not explicitly permitted by this specification.\nA sanitize operation completes when the sanitization target enters any of the following states (refer to\nsection 8.1.26.4):\n•\nthe Idle state;\n•\nthe Restricted Failure state; or\n•\nthe Unrestricted Failure state.\nUpon completion of a sanitize operation or upon entry to the Media Verification state, the host should read\nthe Sanitize Status log page, specifying the NSID indicating the sanitization target (i.e., cleared to 0h or set\nto FFFFFFFFh for the NVM subsystem or set to the NSID of the namespace), and with the Retain\nAsynchronous Event bit cleared to ‘0’ (which clears the asynchronous event, if one was generated).\nIf a command that requests sanitize operations (i.e., the Sanitize command or the Sanitize Namespace\ncommand) is supported, then all controllers in the NVM subsystem shall:\n•\nsupport the Sanitize Status log page;\n•\nsupport the Sanitize Operation Completed asynchronous event;\n•\nsupport the Sanitize Operation Completed With Unexpected Deallocation asynchronous event, if\nthe Sanitize Config feature is supported;\n•\nsupport the Exit Failure Mode action for that command;\n•\nsupport at least one of the following sanitize operation types: Block Erase, Overwrite, or Crypto\nErase;\n•\nsupport the same set of sanitize operation types for that command;\n•\nindicate the supported sanitize operation types in the Sanitize Capabilities field in the Identify\nController data structure; and\n•\nif the Verification Support (VERS) bit is set to ‘1’ or the Namespace Verification Support (NVERS)\nbit is set to ‘1’ in the Identify Controller data structure (refer to Figure 328), support:\no\nthe FAILS field in the Sanitize Status log page (refer to section 5.2.12.1.36);\no\nthe SANS field in the Sanitize Status log page;\no\nthe Media Verification state;\no\nthe Post-Verification Deallocation state; and\no\nthe Sanitize Operation Entered Media Verification State asynchronous event.\nThe Sanitize Config Feature Identifier (refer to section 5.2.26.1.15) contains the No-Deallocate Response\nMode (NODRM) bit that specifies the response of the controller to a Sanitize command specifying the No-\nDeallocate After Sanitize (NDAS) bit (refer to Figure 388) set to ‘1’ if the No-Deallocate Inhibited bit is set\nto ‘1’ in the Sanitize Capabilities field of the Identify Controller data structure (refer to Figure 328). In the\nNo-Deallocate Error Response Mode, the controller aborts such Sanitize commands with a status code of\nInvalid Field in Command. In the No-Deallocate Warning Response Mode, the controller processes such\nSanitize commands, and if a resulting NVM subsystem sanitize operation is completed successfully, then\nthe SOS field is set to 100b (i.e., Sanitized Unexpected Deallocate) in the Sanitize Status log page (refer\nto Figure 302).",
    "tables": [
      {
        "id": "table_658_636",
        "page": 658,
        "bbox": [
          119.0,
          636.0,
          879.0,
          750.0
        ],
        "image_path": "Table_8_1_26_3_Sanitize_Operation_Types_and_Support.png",
        "title": "Table_8_1_26_3_Sanitize_Operation_Types_and_Support",
        "merged_count": 2,
        "table_md": "| OIPBP¹ | Overwrite Pass Count¹ | Overwrite Pass Number | User Data except PI Metadata | Protection Information² |\n| :--- | :--- | :--- | :--- | :--- |\n| '0' | All | All | Overwrite Pattern¹ | Each byte set to FFh |\n| | | First | Inversion of Overwrite Pattern¹ | Each byte cleared to 00h |\n| '1' | Even | Subsequent | Inversion of Overwrite Pattern¹ from previous pass (i.e., each bit XORed with '1') | |\n| OIPBP¹ | Overwrite Pass Count¹ | Overwrite Pass Number | User Data except PI Metadata | Protection Information² |\n| '1' | Odd | First | Overwrite Pattern¹ | Each byte set to FFh |\n| | | Subsequent | Inversion of Overwrite Pattern¹ from previous pass (i.e., each bit XORed with '1') | |\n| Notes: | | | | |\n| 1. Parameters are specified in Command Dword 10 and Command Dword 11 of the corresponding Sanitize command that started the Overwrite operation. The Overwrite Invert Pattern Between Passes (OIPBP) field is defined in Command Dword 10. The Overwrite Pass Count field is defined in Command Dword 10. The Overwrite Pattern field is defined in Command Dword 11. Refer to section 5.2.22. | | | | |\n| 2. If Protection Information is present within the metadata. | | | | |"
      }
    ],
    "figures": []
  },
  "statistics": {
    "table_count": 1,
    "figure_count": 0
  }
}