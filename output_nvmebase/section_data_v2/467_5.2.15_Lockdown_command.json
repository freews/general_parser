{
  "section_index": 467,
  "section_id": "5.2.15",
  "title": "5.2.15 Lockdown command",
  "level": 3,
  "pages": {
    "start": 398,
    "end": 399,
    "count": 2
  },
  "content": {
    "text": "The Lockdown command is used to control the Command and Feature Lockdown capability (refer to section\n8.1.5) which configures the prohibition or allowance of execution of the specified command or Set Features\ncommand targeting a specific Feature Identifier.\nAfter a successful completion of a Lockdown command prohibiting a command or Feature Identifier, all\ncontrollers, if applicable, and all management endpoints, if applicable, in the NVM subsystem behave as\ndescribed in section 8.1.5.\nThe Lockdown command uses Command Dword 10 (refer to Figure 353) and Command Dword 14 (refer\nto Figure 354). All other command specific fields are reserved.\nIf the controller supports selection of a UUID:\na) by the Lockdown command; and\nb) by the Set Features command (refer to section 5.2.26 and section 8.1.30) and for the vendor\nspecific Feature Identifier specified by the Opcode or Feature Identifier field, if the Scope field is\nset to 2h,\nthen Command Dword 14 (refer to Figure 354) is used to specify a UUID Index value.\nIf the controller does not support selection of a UUID:\na) by the Lockdown command;\nb) by the Set Features command; or\nc) for the vendor specific feature identifier specified by the Opcode or Feature Identifier field, if the\nScope field is set to 2h,\nthen Command Dword 14 does not specify a UUID Index value. If the Scope field is not set to 2h, then\nUUID Index field is ignored.\nIf a controller processes a Lockdown command that specifies a command opcode or Feature Identifier that\nis:\n•\nnot indicated as being able to be prohibited from execution (refer to Figure 271), then that command\nshall be aborted with a status code of Prohibition of Command Execution Not Supported; or\n•\nindicated as being able to be prohibited from execution (refer to Figure 271) but that command\nopcode or Feature Identifier is not supported on one of the interfaces specified in the Interface field\n(e.g., an Admin Submission Queue, a Management Endpoint) of that Lockdown command, then:\no\nthat command should be aborted with a status code of Prohibition of Command Execution\nNot Supported; and\no\nthat command may be aborted with a status code of Invalid Field in Command.\nIf a controller processes this command with the Interface field set to 01b or 10b and the NVM subsystem\ndoes not contain a Management Endpoint, then the command shall be aborted with a status code of Invalid\nField in Command.\nIf a controller processes this command with the Interface field set to 00b or 01b and the Scope field is set\nto 4h, then the command shall be aborted with a status code of Invalid Field in Command.\nIt is not an error to attempt to prohibit a command or Feature Identifier that is already prohibited from\nexecution or allow a command or Feature Identifier that is already allowed to be executed.",
    "tables": [
      {
        "id": "table_398_670",
        "page": 398,
        "bbox": [
          117.0,
          670.0,
          881.0,
          903.0
        ],
        "image_path": "Table_5_2_15_Lockdown_command.png",
        "title": "Table_5_2_15_Lockdown_command",
        "merged_count": 3,
        "table_md": "| Bits | Description |\n| :--- | :--- |\n| 31:16 | Reserved |\n| 15:08 | Opcode or Feature Identifier (OFI): This field specifies the command opcode or Set Features Feature Identifier identified by the Scope field. |\n| 07 | Interface (IFC): This field identifies the interfaces affected by this command. The actions of this command apply if a command is received on the specified interfaces. |\n| | <table><tbody><tr><td><b>Value</b></td><td><b>Affected Interfaces</b></td></tr><tr><td>00b</td><td>Admin Submission Queue</td></tr><tr><td>01b</td><td>Admin Submission Queue and out-of-band on a Management Endpoint</td></tr><tr><td>10b</td><td>Out-of-band on a Management Endpoint</td></tr><tr><td>11b</td><td>Reserved</td></tr></tbody></table> |\n| 04 | Prohibit (PRHBT): This bit specifies whether to prohibit or allow the command opcode or Set Features Feature Identifier specified by this command. If this bit is set to '1', then this command prohibits the execution of the command based on other fields specified in Dword 10. If this bit is cleared to '0', then this command allows the execution of the command based on other fields specified in Dword 10. |\n| | |\n| Bits | Description |\n| :--- | :--- |\n| 03:00 | Scope (SCP): This field specifies the contents of the Opcode or Feature Identifier field. |\n| | <table><tbody><tr><td><b>Value</b></td><td><b>Opcode or Feature Identifier Definition</b></td></tr><tr><td>0h</td><td>Admin command opcode</td></tr><tr><td>1h</td><td>Reserved</td></tr><tr><td>2h</td><td>A Set Features Feature Identifier</td></tr><tr><td>3h</td><td>Management Interface Command Set opcode (refer to the NVM Express Management Interface Specification)</td></tr><tr><td>4h</td><td>PCIe Command Set opcode (refer to the NVM Express Management Interface Specification)</td></tr><tr><td>5h-Fh</td><td>Reserved</td></tr></tbody></table> |\n| | |\n| Bits | Description |\n| :--- | :--- |\n| 31:07 | Reserved |\n| 06:00 | UUID Index (UIDX): Refer to Figure 716. |"
      }
    ],
    "figures": []
  },
  "statistics": {
    "table_count": 1,
    "figure_count": 0
  }
}