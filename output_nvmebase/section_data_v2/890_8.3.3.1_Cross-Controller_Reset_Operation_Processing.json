{
  "section_index": 890,
  "section_id": "8.3.3.1",
  "title": "8.3.3.1 Cross-Controller Reset Operation Processing",
  "level": 4,
  "pages": {
    "start": 731,
    "end": 733,
    "count": 3
  },
  "content": {
    "text": "A Cross-Controller Reset operation consists of the following steps:\n1. Determine whether the NVM subsystem is able to validate the Host NQN, the CIU field and\nthe CIRN field.\nIf:\n•\nthe NVM subsystem is not able to validate the Host NQN, the CIU field or the CIRN field\n(e.g., the Source Controller is not able to communicate with the Impacted Controller); and\n•\nthe NVM subsystem is able to determine via an implementation-dependent mechanism\nthat command processing for commands submitted to the Impacted Controller satisfies all\nImmediate Abort requirements as described in section 5.2.1.1 (e.g., the NVM subsystem\ndetermines that the Impacted Controller is powered down),\nthen the NVM subsystem shall complete the Cross-Controller Reset operation and report that the\noperation succeeded with the V bit cleared to ‘0’ and the CLRI bit cleared to ‘0’.\nIf:\n•\nthe NVM subsystem is not able to validate at least one of the Host NQN, the CIU field or\nthe CIRN field; and\n•\nthe NVM subsystem is not able to determine that the Impacted Controller is no longer\nprocessing outstanding commands,\nthen the NVM subsystem shall complete the Cross-Controller Reset operation and report that the\noperation failed with the V bit cleared to ‘0’ and the CLRI bit cleared to ‘0’.\nOtherwise, the operation proceeds to the next step.\nThe NVM subsystem determines whether the Source Controller is authorized to cause the NVM\nsubsystem to initiate a Cross-Controller Reset operation on the Impacted Controller and prohibits\nthe operation if the Source Controller is not authorized.\nThe authorization checks performed by the NVM subsystem include determining whether the\nSource Controller is allowed to access the Impacted Controller for the purpose of a Cross-Controller\nReset (i.e., whether that access is prohibited by an access control policy or other NVM subsystem\nauthorization policy). If that access is not allowed, then this authorization check fails and the NVM\nsubsystem prohibits the operation.\nHosts that support Cross-Controller Reset Recovery should use the same security mechanisms,\nprotocols, and algorithms with all controllers in the same NVM subsystem. If the Source Controller\nand Impacted Controller do not use the same security mechanisms, protocols, and algorithms with\nthe host (e.g., to authenticate the host), then the operation should be prohibited unless the NVM\nsubsystem is able to determine that for any security mechanism, protocol, or algorithm that differs\nbetween these two controllers, the Source Controller uses a stronger security mechanism, protocol\nor algorithm than the Impacted Controller. For example, if the Source Controller has authenticated\nthe host, and the Impacted Controller has not authenticated the host, then the operation should not\nbe prohibited, as the Source Controller has used a stronger security mechanism. However, if the\nImpacted Controller has authenticated the host, and the Source Controller has not authenticated\nthat host, then the operation should be prohibited.\nIf any authorization check causes the Cross-Controller Reset operation to be prohibited, then the\nNVM subsystem shall complete that Cross-Controller Reset operation and report that the operation\nfailed with the V bit cleared to ‘0’ and the CLRI bit cleared to ‘0’.\nOtherwise, the operation proceeds to the next step.\nIf:\n•\nthe Source Controller and the Impacted Controller are associated with hosts that have\ndifferent Host NQNs;\n•\nthe value of the CIU field specified in the Cross-Controller Reset command is not the same\nas the current value of the CIU field in the Identify Controller data structure for the Impacted\nController; or\n•\nthe CIRN (i.e., the combination of the value of the CIRNL field and the value of the CIRNU\nfield) specified in the Cross-Controller Reset command is not the same as the current value\nof the CIRN field in the Identify Controller data structure for the Impacted Controller,\nthen the NVM subsystem shall complete the Cross-Controller Reset operation and report that the\noperation succeeded with the V bit cleared to ‘0’ and the CLRI bit cleared to ‘0’.\nThe operation completes successfully because each of these three conditions indicates that the\ninstance of the Impacted Controller specified in the CIU field, CIRNL field and CIRNU field in the\nCross-Controller Reset command no longer exists and hence is not processing commands that this\nhost is trying to recover.\nOtherwise, the operation proceeds to the next step.\nIf a CLR is not in progress on that Impacted Controller, the NVM subsystem shall initiate a CLR (as\ndescribed in section 3.7.2) on the Impacted Controller.\nIf the NVM subsystem is not able to either initiate a CLR on that Impacted Controller or determine\nthat a CLR is in progress on that Impacted Controller, then the NVM subsystem shall complete the\nCross-Controller Reset operation and report that the operation failed with the V bit set to ‘1’ and\nthe CLRI bit cleared to ‘0’.\nOtherwise (i.e., the Impacted Controller is processing a CLR), the operation proceeds to the next\nstep.\nAt the start of this step, the Impacted Controller is processing a CLR. The Cross-Controller Reset\noperation remains in progress until one of the following events occurs, which causes the NVM\nsubsystem to complete the Cross-Controller Reset operation:\na. If the NVM subsystem determines that the Impacted Controller has completed processing\nthe CLR, then the NVM subsystem shall complete the Cross-Controller Reset operation\nand report that the operation succeeded with the V bit set to ‘1’ and the CLRI bit set to ‘1’.\nb. If the NVM subsystem is able to determine via an implementation-dependent mechanism\nthat command processing for commands submitted to the Impacted Controller satisfies all\nImmediate Abort requirements as described in section 5.2.1.1 (e.g., the NVM subsystem\ndetermines that the Impacted Controller is powered down), then the NVM subsystem shall\ncomplete the Cross-Controller Reset operation and report that the operation succeeded\nwith the V bit set to ‘1’ and the CLRI bit set to ‘1’.\nc. If the NVM subsystem is not able to determine whether the Impacted Controller is\nprocessing the CLR (e.g., the Source Controller is no longer able to contact the Impacted\nController), and available implementation-dependent mechanisms fail to determine that\ncommand processing for commands submitted to the Impacted Controller satisfies all\nImmediate Abort requirements as described in section 5.2.1.1, then the NVM subsystem\nshall complete the Cross-Controller Reset operation and report that the operation failed\nwith the V bit set to ‘1’ and the CLRI bit set to ‘1’.\nUpon the NVM subsystem completing the Cross-Controller Reset operation, the Source Controller records\nthe result in either:\n•\nthe entry for the Impacted Controller in the Cross-Controller Reset log page; or\n•\nthe completion of the Cross-Controller Reset command if the operation is successful and the CQE\nof the Cross-Controller Reset command has not been posted by setting the IRS bit to ‘1’.",
    "tables": [],
    "figures": []
  },
  "statistics": {
    "table_count": 0,
    "figure_count": 0
  }
}