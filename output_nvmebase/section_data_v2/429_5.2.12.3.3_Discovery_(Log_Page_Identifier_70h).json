{
  "section_index": 429,
  "section_id": "5.2.12.3.3",
  "title": "5.2.12.3.3 Discovery (Log Page Identifier 70h)",
  "level": 5,
  "pages": {
    "start": 330,
    "end": 336,
    "count": 7
  },
  "content": {
    "text": "The Discovery log page shall only be supported by Discovery controllers. The Discovery log page shall not\nbe supported by controllers that expose namespaces for NVMe over PCIe or NVMe over Fabrics. The\nDiscovery log page provides an inventory of NVM subsystems with which a host may attempt to form an\nassociation. Depending on the parameters specified in a Get Log Page command, the Discovery log page\nmay contain entries for:\n•\nall known NVM subsystems; or\n•\na subset of entries specific to the host or Discovery controller requesting the log page.\nThe Discovery log page is persistent across power cycles.\nFigure 308 specifies the format for the LID Specific Parameter field in the Supported Log Pages log page\n(refer to section 5.2.12.1.1) for the Discovery log page.\nIf a Discovery controller supports returning Extended Discovery Log Page Entries (i.e., the Extended\nDiscovery Log Page Entries Supported (EXTDLPES) bit is set to ‘1’ in the LID Specific Parameter field as\ndefined in Figure 308) and that Discovery controller processes a Get Log Page command for this log page\nwith the Extended Discovery Log Page Entries (EXTDLPE) bit set to ‘1’ in the Log Specific Parameter (LSP)\nfield (refer to Figure 309), then each entry returned by that Discovery controller may be either a Discovery\nLog Page Entry or an Extended Discovery Log Page Entry. Extended Discovery Log Page Entries may\ncontain zero or more extended attributes. If a Discovery controller returns records that include Extended\nDiscovery Log Page Entries, then that Discovery controller shall set the Extended (EXTEND) bit to ‘1’ in\nthe Discovery Log Page Flags (DLPF) field. A Centralized Discovery controller (CDC) shall support\nreturning Extended Discovery Log Page Entries.\nIf a Discovery controller supports returning only port local Discovery Log Page Entries or port local Extended\nDiscovery Log Page Entries (i.e., the Port Local Entries Only Supported (PLEOS) bit is set to ‘1’ in the LID\nSpecific Parameter field as defined in Figure 308) and that Discovery controller processes a Get Log Page\ncommand for this log page with the Port Local Entries Only (PLEO) bit set to ‘1’ in the LSP field (refer to\nFigure 309), then that Discovery controller shall return records for only NVM subsystem ports that are\npresented through the same NVM subsystem port that received the Get Log Page command. If a Discovery\ncontroller returns records for only NVM subsystem ports that are presented through the same NVM\nsubsystem port that received the Get Log Page command, then that Discovery controller shall set the Port\nLocal (PORTLCL) bit to ‘1’ in the DLPF field. Only a Direct Discovery controller (DDC) may support returning\nonly port local Discovery Log Page Entries or port local Extended Discovery Log Page Entries.\nIf a Discovery controller supports returning records for all NVM subsystem ports that are registered (i.e.,\nthe All NVM Subsystems Entries Supported (ALLSUBES) bit is set to ‘1’ in the LID Specific Parameter field\nas defined in Figure 308) and that Discovery controller processes a Get Log Page command for this log\npage with the All NVM Subsystem Entries (ALLSUBE) bit set to ‘1’ in the LSP field (refer to Figure 309),\nthen that Discovery controller shall return records for all NVM subsystem ports that are registered. The list\nof records returned by that Discovery controller shall not be filtered based upon the requesting HOSTNQN.\nIf a Discovery controller returns records for all NVM subsystem ports that are registered, then that Discovery\ncontroller shall set the All Subsystems (ALLSUB) bit to ‘1’ in the DLPF field. A Discovery controller may\nrequire authentication before reporting the ALLSUBES bit being set to ‘1’ or may require configuration\noutside the scope of this specification.\nThe Log Page Offset may be used to retrieve specific records. If the Discovery controller supports an index\noffset for this log page (i.e., the Index Offset Supported (IOS) bit is set to ‘1’ in the Supported Log Pages\nlog page (refer to section 5.2.12.1.1) for this log page) and the OT bit is set to ‘1’ in a Get Log Page\ncommand, then the index values specified in the Log Page Offset Lower (LPOL) field (refer to Figure 203)\nand Log Page Offset Upper (LPOU) field (refer to Figure 204) in that Get Log Page command shall be used\nto index into the header and list of entries within this log page (e.g., specifying an index offset of 0 returns\nthis log page starting at the header, specifying an index offset of 1 returns this log page starting at the offset\nof Entry 0, etc.).\nThe number of records (i.e., the number of Discovery Log Page Entries) is returned in the header of the log\npage. The format for a Discovery Log Page Entry is defined in Figure 310. The format for an Extended\nDiscovery Log Page Entry is defined in Figure 311. The format for an extended attribute is defined in Figure\n533. The format for the Discovery log page is defined in Figure 312.\nA single Get Log Page command used to read the Discovery log page shall be atomic. If the Discovery log\npage is read using multiple Get Log Page commands, then the reader should validate the Generation\nCounter field to ensure that there has not been a change in the contents of the data. The Discovery log\npage contents should be processed in the following sequence:\n1. read the Discovery log page contents in order (i.e., with increasing Log Page Offset values);\n2. re-read the Generation Counter field after the entire log page is transferred; and\n3. if the Generation Counter field does not match the original value read, then discard the log page\nread, as the entries may be inconsistent, and restart the sequence.; or\n4. if the Generation Counter field does match the original value read, then process the returned data.\nIf the log page contents change during this command sequence, then the controller may return a status\ncode of Discover Restart.\nEvery record indicates via the SUBTYPE field if that record is describing the current Discovery Service,\nreferring to another Discovery Service, or if the record indicates an NVM subsystem composed of\ncontrollers that may expose namespaces. A referral to another Discovery Service (i.e., SUBTYPE field set\nto 01h) is a mechanism to find additional Discovery subsystems. An NVM subsystem entry (i.e., SUBTYPE\nfield set to 02h) is a mechanism to find NVM subsystems that contain controllers that may expose\nnamespaces. An entry that describes the current Discovery Service (i.e., SUBTYPE field set to 03h) is a\nmechanism to find additional access information (e.g., other NVM subsystem ports) for the current\nDiscovery service. Hosts or Discovery controllers are not required to process referral entries deeper than\neight levels.\nFor entries that describe the current Discovery Service, the DUPRETINFO bit set to ‘1’ in the Entry Flags\nfield indicates those ports that return duplicate information. A host need not retrieve the Discovery Log Page\nfrom all NVM subsystem ports described by a Discovery Log Page Entry that contains the DUPRETINFO\nbit set to ‘1’ (refer to Figure 310), as each of those ports return the same information. A host may retrieve\nthe Discovery Log Page from multiple ports with the DUPRETINFO bit set to ‘1’ to act as redundant access\nto the same information. A host may choose to enable the Discovery Log Page Change AEN on one of the\nconnections associated with an entry with the DUPRETINFO bit set to ‘1’. If the Discovery Log Page Change\nAEN is enabled on multiple ports represented by entries with the DUPRETINFO bit set to ‘1’, then the host\nmay process a Discovery Log Page Change AEN for one connection as applying to all ports represented\nby entries that also have the DUPRETINFO bit set to ‘1’.\nIf an NVM subsystem supports the dynamic controller model, then all entries for that NVM subsystem shall\nhave the Controller ID field set to FFFFh. For a particular NVM subsystem port and NVMe Transport\naddress in an NVM subsystem, there shall be no more than one entry with the Controller ID field set to:\n•\nFFFFh if that NVM subsystem supports the dynamic controller model; or\n•\nFFFEh if that NVM subsystem supports the static controller model.",
    "tables": [],
    "figures": [
      {
        "id": "figure_330_375",
        "page": 330,
        "bbox": [
          115.0,
          375.0,
          881.0,
          577.0
        ],
        "detected_title": "Figure 308 specifies the format for the LID Specific Parameter field in the Supported Log Pages log page\n(refer to section 5.2.12.1.1) for the Discovery log page.",
        "title": "Figure 308 specifies the format for the LID Specific Parameter field in the Supported Log Pages log page\n(refer to section 5.2.12.1.1) for the Discovery log page.",
        "image_path": "Figure_5_2_12_3_3_Discovery_Log_Page_Identifier_70h_1.png"
      },
      {
        "id": "figure_332_208",
        "page": 332,
        "bbox": [
          114.0,
          208.0,
          881.0,
          360.0
        ],
        "detected_title": "Figure 308: Discovery Log Page – LID Specific Parameter Field",
        "has_intervening_text": true,
        "title": "Figure 308: Discovery Log Page – LID Specific Parameter Field",
        "image_path": "Figure_5_2_12_3_3_Discovery_Log_Page_Identifier_70h_2.png"
      },
      {
        "id": "figure_332_405",
        "page": 332,
        "bbox": [
          114.0,
          405.0,
          881.0,
          750.0
        ],
        "detected_title": "Figure 309: Discovery Log Specific Parameter Field",
        "title": "Figure 309: Discovery Log Specific Parameter Field",
        "image_path": "Figure_5_2_12_3_3_Discovery_Log_Page_Identifier_70h_3.png"
      },
      {
        "id": "figure_333_124",
        "page": 333,
        "bbox": [
          114.0,
          124.0,
          879.0,
          860.0
        ],
        "detected_title": "Figure 310: Discovery Log Page Entry Data Structure",
        "title": "Figure 310: Discovery Log Page Entry Data Structure",
        "image_path": "Figure_5_2_12_3_3_Discovery_Log_Page_Identifier_70h_4.png",
        "merged_count": 3
      },
      {
        "id": "figure_335_818",
        "page": 335,
        "bbox": [
          114.0,
          818.0,
          881.0,
          904.0
        ],
        "detected_title": "Figure 311: Extended Discovery Log Page Entry",
        "title": "Figure 311: Extended Discovery Log Page Entry",
        "image_path": "Figure_5_2_12_3_3_Discovery_Log_Page_Identifier_70h_5.png"
      },
      {
        "id": "figure_336_127",
        "page": 336,
        "bbox": [
          114.0,
          127.0,
          881.0,
          700.0
        ],
        "detected_title": "Figure 312: Discovery Log Page",
        "title": "Figure 312: Discovery Log Page",
        "image_path": "Figure_5_2_12_3_3_Discovery_Log_Page_Identifier_70h_6.png"
      }
    ]
  },
  "statistics": {
    "table_count": 0,
    "figure_count": 6
  }
}