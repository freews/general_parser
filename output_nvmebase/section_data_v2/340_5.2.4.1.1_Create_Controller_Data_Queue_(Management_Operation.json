{
  "section_index": 340,
  "section_id": "5.2.4.1.1",
  "title": "5.2.4.1.1 Create Controller Data Queue (Management Operation 0h)",
  "level": 5,
  "pages": {
    "start": 213,
    "end": 215,
    "count": 3
  },
  "content": {
    "text": "The Create Controller Data Queue management operation of the Controller Data Queue command is used\nto create a queue in host memory to which a controller posts the information specified by the Queue Type\nfield (refer to Figure 169).\nThe Create Controller Data Queue management operation uses the PRP Entry 1 field, Command Dword\n11 field, and Command Dword 12 field.\nIf a PRP List is provided to describe the Controller Data Queue, then the PRP List shall be maintained by\nthe host at the same location in host physical memory and the values in the PRP List shall not be modified\nuntil the Controller Data Queue is deleted (refer to section 5.2.4.1.2) or the controller is reset. If the PRP\nList values are modified, then the behavior is undefined.\nIf the number of memory ranges specified by the PRP Entry 1 field is greater than the value defined by the\nMaximum CDQ Memory Ranges (MCMR) field in the Identify Controller data structure (refer to Figure 328),\nthen the controller shall abort the command with a status code of Invalid Field in Command.\nIf the number of memory ranges specified by the PRP Entry 1 field plus the number of memory ranges that\nexists for all of the Controller Data Queues in the NVM subsystem is greater than the value defined by the\nNVM Subsystem Maximum Controller CDQ Memory Ranges (NMCMR) field in the Identify Controller data\nstructure (refer to Figure 328), then the controller shall abort the command with a status code of Invalid\nField in Command.\nIf the current number of User Data Migration Queues that exist in the controller is equal to the value in the\nMaximum Controller User Data Migration Queues (MCUDMQ) field in the Identify Controller data structure,\nthen the controller shall abort the command with a status code of Invalid Field in Command.\nIf the current number of User Data Migration Queues that exist in the NVM subsystem is equal to the value\nin the Maximum NVM Subsystem User Data Migration Queues (MNSUDMQ) field in the Identify Controller\ndata structure, then the controller shall abort the command with a status code of Invalid Field in Command.\nIf the Controller Data Queue Size field value is not a multiple of the size of the entries for the type of\nController Data Queue as specified by the Queue Type field (refer to Figure 169), then the controller shall\nabort the command with a status code of Invalid Field in Command.\nThe Management Operation Specific field (refer to Figure 165) for the Create Controller Data Queue\nmanagement operation is specified in Figure 169.\nIf the PRP Entry 1 field has a non-zero PRP offset, then the controller shall abort the command with a status\ncode of PRP Offset Invalid.",
    "tables": [
      {
        "id": "table_214_267",
        "page": 214,
        "bbox": [
          115.0,
          267.0,
          881.0,
          435.0
        ],
        "image_path": "Table_5_2_4_1_1_Create_Controller_Data_Queue_Management_Operation_0h_1.png",
        "title": "Table_5_2_4_1_1_Create_Controller_Data_Queue_Management_Operation_0h_1",
        "merged_count": 3,
        "table_md": "| Bits | Description |\n| :--- | :--- |\n| 63:00 | PRP Entry 1 (PRP1): If the PC bit is set to '1', then this field specifies a 64-bit base host memory (refer to section 1.5.47) address pointer of the Controller Data Queue that is physically contiguous. The address pointer is memory page aligned (based on the value in CC.MPS field) unless otherwise specified. If the PC bit (refer to Figure 167) is cleared to '0', then this field specifies a PRP List pointer that describes the list of pages that constitute the Controller Data Queue. The list of pages is host memory (refer to section 1.5.47) that is page aligned (based on the value in CC.MPS field) unless otherwise specified. In both cases the PRP Entry shall have an offset of 0h. In a non-contiguous Controller Data Queue, each PRP Entry in the PRP List shall have an offset of 0h. If there is a PRP Entry with a non-zero offset, then the controller shall return an error of PRP Offset Invalid.<br>If the memory specified by this field is not host memory (e.g., CMB or PMR), then the controller shall abort the command with a status code of Invalid Field in Command. |\n| Bits | Description |\n| 31:16 | Create Queue Specific (CQS): The definition of this field is specific to the type of queue being created (refer to Queue Type (QT) field in Figure 169). If the type of queue being created does not define the use of this field, then this field is reserved. |\n| 15:01 | Reserved |\n| 00 | Physically Contiguous (PC): If set to '1', then the Controller Data Queue is physically contiguous and PRP Entry 1 (PRP1) is the address of a contiguous physical buffer. If cleared to '0', then the Controller Data Queue is not physically contiguous and PRP Entry 1 (PRP1) is a PRP List pointer. |\n| Bits | Description |\n| 31:00 | Controller Data Queue Size (CDQSIZE): This field specifies the size of the queue to be created in dwords. |"
      },
      {
        "id": "table_214_816",
        "page": 214,
        "bbox": [
          115.0,
          816.0,
          881.0,
          845.0
        ],
        "has_intervening_text": true,
        "image_path": "Table_5_2_4_1_1_Create_Controller_Data_Queue_Management_Operation_0h_2.png",
        "title": "Table_5_2_4_1_1_Create_Controller_Data_Queue_Management_Operation_0h_2",
        "merged_count": 2,
        "table_md": "| Bits | Description |\n| :--- | :--- |\n| 15:08 | Reserved |\n| | |\n| Bits | Description |\n| 07:00 | Queue Type (QT): This field specifies the type of queue to be created which defines the information that the controller posts into the entries of the queue. |\n| | | | | |\n| | | **Value** | **Definition** | **Reference Section** |\n| | | 0h | User Data Migration Queue | 5.2.4.1.1.1 |\n| | | 1h to BFh | Reserved | |\n| | | C0h to FFh | Vendor Specific | |"
      }
    ],
    "figures": []
  },
  "statistics": {
    "table_count": 2,
    "figure_count": 0
  }
}