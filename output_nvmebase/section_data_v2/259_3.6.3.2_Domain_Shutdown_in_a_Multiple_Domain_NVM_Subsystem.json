{
  "section_index": 259,
  "section_id": "3.6.3.2",
  "title": "3.6.3.2 Domain Shutdown in a Multiple Domain NVM Subsystem",
  "level": 4,
  "pages": {
    "start": 141,
    "end": 142,
    "count": 2
  },
  "content": {
    "text": "A normal NVM Subsystem Shutdown on this controller and all controllers within the associated domain is\ninitiated by:\n•\na host writing the value 4E726D6Ch (\"Nrml\") to NSSD.NSSC when CAP.CPS is set to 10b; or\n•\nissuing an NVMe-MI Shutdown command to a Management Endpoint (refer to the NVM Express\nManagement Interface Specification) specifying a normal shutdown.\nFor each controller in the domain for this normal NVM subsystem shutdown, if:\n•\nCSTS.SHST is cleared to 00b; and\n•\nAn outstanding Asynchronous Event Request command exists,\nthen the controller shall issue a Normal NVM Subsystem Shutdown event prior to shutting down the\ncontroller.\nAn abrupt NVM Subsystem Shutdown to this controller and all controllers within the associated domain is\ninitiated by:\n•\na host writing the value 41627074h (\"Abpt\") to NSSD.NSSC when CAP.CPS is set to 10b; or\n•\nissuing an NVMe-MI Shutdown command to a Management Endpoint (refer to the NVM Express\nManagement Interface Specification) specifying an abrupt shutdown.\nWhile NVM Subsystem Shutdown processing is in progress, any controller in the domain may abort any\ncommand with a status code of Commands Aborted due to Power Loss Notification.\nIt is recommended that the host wait a minimum of the NVM Subsystem Shutdown Latency reported in the\nIdentify Controller data structure (refer to Figure 328) for NVM Subsystem Shutdown processing on a\ndomain to complete; if the reported NVM Subsystem Shutdown Latency value is 0h, then the host should\nwait for a minimum of 30 seconds. While an NVM Subsystem Shutdown is reported as in progress, it is not\nrecommended to reset the domain via either an NVM Subsystem Reset on the domain or power cycling the\ndomain (which causes an NVM Subsystem Reset on the domain). This aborts the NVM Subsystem\nShutdown which may impact the subsequent time required for the domain to become ready to perform I/O\n(e.g., after power is reapplied following a power cycle).\nFor either a normal or an abrupt NVM Subsystem Shutdown on the domain, the domain is ready to be\npowered off (e.g., the media is in the shutdown state (refer to Figure 85)) when the CSTS.ST bit is set to\n‘1’ and the CSTS.SHST field indicates that shutdown processing is complete (i.e., the CSTS.SHST field is\nset to 10b) on any controller in the domain. The NVM subsystem shall not set the CSTS.SHST field to 10b\non any controller in the domain until the entire domain is ready to be powered off. The NVM Subsystem\nshall indicate that NVM Subsystem Shutdown processing is complete by setting the CSTS.SHST field to\n10b on all controllers in the domain. The domain remains ready to be powered off (e.g., the media remains\nin the shutdown state) until:\nA. an NVM Subsystem Reset occurs on that domain; or\nB. an Admin command that requires access to the media (refer to Figure 84) and specifies the Ignore\nShutdown bit set to ‘1’ is processed by any controller in the domain via the out-of-band mechanism\n(refer to the NVM Express Management Interface Specification).\nIf a normal or an abrupt NVM Subsystem Shutdown is reported as in progress or is reported as complete\nwithin a domain (i.e., the CSTS.ST bit is set to ‘1’ and the CSTS.SHST field is set to either 01b or 10b on\nall controllers in the domain, indicating that an NVM Subsystem Reset on the domain has not occurred\nsince initiation of that NVM Subsystem Shutdown), then:\n•\nan NVM Subsystem Reset on the domain:\nshall abort any in progress NVM Subsystem Shutdown on the domain; and\nclears the CSTS.SHST field to 00b in all controllers in the domain; and\nclears the CSTS.ST bit to ‘0’ in all controllers in the domain;\nand\n•\na Controller Level Reset of any controller in the domain that is initiated by any other method (refer\nto section 3.7.2)\nshall not abort any in progress NVM Subsystem Shutdown on the domain;\ndoes not change the values of the CSTS.ST bit and the CSTS.SHST field, as described in\nFigure 42; and\nshall not cause the domain to cease being ready to be powered off (e.g., shall not transition\nthe media out of the shutdown state) if the domain was ready to be powered off when that\nController Level Reset was initiated.\nTo start executing commands on the controller after that controller reports NVM Subsystem Shutdown\nprocessing complete (i.e., the CSTS.ST bit is set to ‘1’ and the CSTS.SHST field is set to 10b):\n•\nregardless of the value of CC.EN, an NVM Subsystem Reset on that domain is required; and\n•\nthe CC.EN bit is subsequently required to be set to ‘1’ as part of the initialization sequence (refer\nto section 3.5).\nThe initialization sequence (refer to section 3.5) should then be executed on that controller.",
    "tables": [],
    "figures": []
  },
  "statistics": {
    "table_count": 0,
    "figure_count": 0
  }
}