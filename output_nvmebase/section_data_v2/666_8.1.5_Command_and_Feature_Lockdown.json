{
  "section_index": 666,
  "section_id": "8.1.5",
  "title": "8.1.5 Command and Feature Lockdown",
  "level": 3,
  "pages": {
    "start": 558,
    "end": 558,
    "count": 1
  },
  "content": {
    "text": "The Command and Feature Lockdown capability is used to prohibit the execution of commands submitted\nto NVM Express controllers and/or Management Endpoints in an NVM subsystem. Within this feature,\ncommands and Feature Identifiers are defined with the following scopes:\n•\nAdmin Command Set commands defined by the Opcode field;\n•\nSet Features command features defined by the Feature Identifier field;\n•\nManagement Interface Command Set commands defined by the Opcode field (refer to the NVM\nExpress Management Interface Specification); and\n•\nPCIe Command Set commands defined by the Opcode field (refer to the NVM Express\nManagement Interface Specification).\nAdmin Command Set commands and Feature Identifiers are defined to be prohibitable by this feature,\nhowever it is vendor specific which of the Command Set commands and Feature Identifiers are prohibitable\nfrom execution, including the Lockdown command itself.\nThe prohibition of commands or Feature Identifiers on an interface is specified in the Interface field of the\nLockdown command (refer to section 5.2.15). The prohibition applies to all applicable:\n•\nNVM Express controllers; and\n•\nManagement Endpoints,\nin the NVM subsystem, as specified in the Interface field.\nThe Lockdown command is used to specify commands that are prohibited from execution (i.e., locked\ndown) and may be used further to then again allow that command to be executed.\nThe prohibiting of execution of a command as part of this feature shall persist until:\na) power cycle of the NVM subsystem; or\nb) further being allowed by a follow-on Lockdown command.\nIf a controller in the NVM subsystem processes an Admin Command Set command or Feature Identifier\nthat is prohibited from execution if received on an Admin submission queue, then that command shall be\naborted with a status code of Command Prohibited by Command and Feature Lockdown.\nIf a Management Endpoint processes a command that is prohibited from execution on that Management\nEndpoint, then that command shall be aborted and a Response Message with an Access Denied Error\nResponse (refer to the NVM Express Management Interface Specification) shall be returned.\nThe prohibition or allowance of the execution of a command is based on the interface on which the\ncommand is received (i.e., the Admin Submission Queue, or an out-of-band Management Endpoint). For\nexample, a command is able to be prohibited if received on an Admin Submission Queue but allowed if\nreceived on an out-of-band Management Endpoint, if supported. The Interface field in the Lockdown\ncommand (refer to 5.2.15) is used to specify this behavior.\nA host may use the Command and Feature Lockdown log page (refer to section 5.2.12.1.20) to determine\nthe commands and Feature Identifiers that are allowed to be prohibited from execution. A Get Log Page\ncommand specifying the Command and Feature Lockdown log page returns a list of Admin command\nopcodes or Feature Identifiers depending on the scope specified in the Get Log Page command. The\nreturned list of opcodes or Feature Identifiers are the opcodes or Feature Identifiers that are:\na) supported as being prohibitable from execution using the Lockdown command;\nb) currently prohibited from execution if received on an Admin Submission Queue; or\nc) currently prohibited from execution if received out-of-band on a Management Endpoint.\nIf the Command and Feature Lockdown capability is supported (i.e., the CFLS bit in the OACS field in\nFigure 328 is set to ‘1’), then the controller shall support the Lockdown command and the Command and\nFeature Lockdown log page.",
    "tables": [],
    "figures": []
  },
  "statistics": {
    "table_count": 0,
    "figure_count": 0
  }
}