{
  "section_index": 903,
  "section_id": "8.3.5.4.1",
  "title": "8.3.5.4.1 AUTH_Negotiate Message",
  "level": 5,
  "pages": {
    "start": 743,
    "end": 745,
    "count": 3
  },
  "content": {
    "text": "The AUTH_Negotiate message is sent from the host to the controller and is used to indicate the\nauthentication protocols the host is able to use in this authentication transaction and which secure channel\nprotocol, if any, to concatenate to this authentication transaction. The AUTH_Negotiate message format is\nshown in Figure 789.\nThe SC_C field determines if a secure channel concatenation to the authentication transaction is requested\nand with which secure channel protocol, as shown in Figure 790.\nAn authentication transaction with the SC_C field set to NOSC is allowed on any Admin or I/O Queue and\ndoes not generate a PSK (i.e., it performs authentication only).\nAn authentication transaction with the SC_C field set to NEWTLSPSK:\n•\nis allowed on an Admin Queue over a TCP channel without TLS and generates a new PSK;\n•\nis prohibited on an I/O Queue over a TCP channel without TLS; and\n•\nis prohibited on an Admin Queue or I/O queue over a TLS secure channel.\nAn authentication transaction with the SC C field set to REPLACETLSPSK:\n•\nis allowed on an Admin Queue over a TLS secure channel and replaces the association’s PSK;\n•\nis prohibited on an Admin Queue or I/O queue over a TCP channel without TLS; and\n•\nis prohibited on an I/O Queue over a TLS secure channel.\nThe AUTH_Negotiate message is structured as a list of 64-byte authentication protocol descriptors to\nenable extensibility to define additional authentication protocols. Currently only one authentication protocol\nis defined (i.e., DH-HMAC-CHAP), therefore the AUTH_Negotiate message carries only one authentication\nprotocol descriptor (i.e., NAPD=1). Implementations should support more than one descriptor to enable\nprotocol extensibility. The first byte of an authentication protocol descriptor identifies the specific\nauthentication protocol, as shown in Figure 791.\nUpon receiving an AUTH_Negotiate message, if the SC_C value indicated by the host:\n•\ndoes not satisfy the security requirements of the controller (e.g., the host did not request secure\nchannel concatenation, but the controller’s security configuration requires secure channel\nconcatenation);\n•\nis prohibited for the Admin Queue or I/O Queue via which the AUTH_Negotiate message was\nreceived, as specified in this section; or\n•\nrequests secure channel concatenation and that value is contained in an AUTH_Negotiate\nmessage received over a secure channel established in compliance with the requirements of an\nNVM Express Transport specification (e.g., the NVMe over TCP Transport Specification),\nthen the controller shall:\n•\nreply to the AUTH_Negotiate message with an AUTH_Failure1 message having reason code\n‘Authentication failure’ and reason code explanation ‘Secure channel concatenation mismatch’; and\n•\ndisconnect the NVMe over Fabrics connection upon transmitting the AUTH_Failure1 message.\nUpon receiving an AUTH_Negotiate message, if the protocol descriptors proposed by the host do not satisfy\nthe security requirements of the controller, then the controller shall:\n•\nreply to the AUTH_Negotiate message with an AUTH_Failure1 message having reason code\n‘Authentication failure’ and reason code explanation ‘Authentication protocol not usable’; and\n•\ndisconnect the NVMe over Fabrics connection upon transmitting the AUTH_Failure1 message.",
    "tables": [],
    "figures": [
      {
        "id": "figure_744_128",
        "page": 744,
        "bbox": [
          115.0,
          128.0,
          882.0,
          323.0
        ],
        "detected_title": "Figure 789: AUTH_Negotiate message format",
        "title": "Figure 789: AUTH_Negotiate message format",
        "image_path": "Figure_8_3_5_4_1_AUTH_Negotiate_Message_1.png",
        "merged_count": 2
      },
      {
        "id": "figure_745_128",
        "page": 745,
        "bbox": [
          285.0,
          128.0,
          711.0,
          174.0
        ],
        "detected_title": "Figure 790: Secure channel protocol identifiers",
        "has_intervening_text": true,
        "title": "Figure 790: Secure channel protocol identifiers",
        "image_path": "Figure_8_3_5_4_1_AUTH_Negotiate_Message_2.png"
      }
    ]
  },
  "statistics": {
    "table_count": 0,
    "figure_count": 2
  }
}