{
  "section_index": 351,
  "section_id": "5.2.8.1",
  "title": "5.2.8.1 Command Completion",
  "level": 4,
  "pages": {
    "start": 221,
    "end": 223,
    "count": 3
  },
  "content": {
    "text": "Upon completion of the Firmware Commit command, the controller posts a completion queue entry to the\nAdmin Completion Queue indicating the status for the command.\nFor Firmware Commit commands that specify activation of a new firmware image at the next Controller\nLevel Reset (i.e., the CA field was set to 001b or 010b) and complete with a status code value of 0h (i.e.,\nSuccess Completion), a Controller Level Reset initiated by any of the methods defined in section 3.7.2\nactivates the specified firmware.\nIf the controller detects overlapping firmware/boot partition image update command sequences (refer to\nsection 1.5.42) of more than one firmware image and/or Boot Partition or the use of more than one controller\nand/or Management Endpoint to update a single firmware image, then the results of that detection are\nreported in Dword 0 of the completion queue entry as defined in Figure 186. Refer to section 3.11 and\nsection 8.1.3.2.\nIf:\na) the Commit Action field is cleared to 000b (i.e., update the firmware image in the specified firmware\nslot but do not activate);\nb) the Firmware Slot field is set to the active firmware slot (refer to Figure 212); and\nc) the controller supports greater than one firmware slot for a host to store firmware images,\nthen the controller may abort the command with a status code of Command Sequence Error. A host may\navoid this result by using a different firmware slot.\nFirmware Commit command specific status values (i.e., SCT field set to 1h) are shown in Figure 187.",
    "tables": [
      {
        "id": "table_221_843",
        "page": 221,
        "bbox": [
          117.0,
          843.0,
          879.0,
          874.0
        ],
        "image_path": "Table_5_2_8_1_Command_Completion_1.png",
        "title": "Table_5_2_8_1_Command_Completion_1",
        "merged_count": 2,
        "table_md": "| Bits | Description |\n| :--- | :--- |\n| 31:02 | Reserved |\n| Bits | Description |\n| 01:00 | Multiple Update Detected (MUD): This field indicates if a controller detected overlapping firmware/boot partition image update command sequences of Boot Partitions and/or firmware images (refer to section 3.11 and section 8.1.3.2). If the MUD bit in the Firmware Update field of the Identify Controller data structure is cleared to '0', then this field shall be cleared to 00b. <br> This field is valid if the command is successful or aborted. |\n| Bits | Description |\n| 1 | Management Endpoint FW Overlap (MEFWO): If this bit is set to '1', then the controller detected an overlapping firmware/boot partition image update command sequence due to processing a command from a Management Endpoint. If this bit is cleared to '0', then the controller did not detect an overlapping firmware/boot partition image update command sequence due to processing a command from a Management Endpoint. |\n| 0 | Admin Submission Queue FW Overlap (ASQFWO): If this bit is set to '1', then the controller detected an overlapping firmware/boot partition image update command sequence due to processing a command from an Admin Submission Queue on a controller. If this bit is cleared to '0', then the controller did not detect an overlapping firmware/boot partition image update command sequence due to processing a command from an Admin Submission Queue on a controller. |"
      },
      {
        "id": "table_222_450",
        "page": 222,
        "bbox": [
          114.0,
          450.0,
          901.0,
          875.0
        ],
        "has_intervening_text": true,
        "image_path": "Table_5_2_8_1_Command_Completion_2.png",
        "title": "Table_5_2_8_1_Command_Completion_2",
        "merged_count": 2,
        "table_md": "| Value | Definition |\n| :--- | :--- |\n| 06h | **Invalid Firmware Slot:** The firmware slot indicated is invalid or read only. This error is indicated if the firmware slot exceeds the number supported. |\n| 07h | **Invalid Firmware Image:** The firmware image specified for activation is:<br>• invalid and not loaded by the controller; or<br>• the specified firmware slot does not contain a firmware image. |\n| 08h | **Firmware Activation Requires Conventional Reset:** The firmware commit was successful; however, activation of the firmware image requires a Conventional Reset. (refer to the NVMe over PCIe Transport Specification). If a Function Level Reset (refer to the NVMe over PCIe Transport Specification) or a Controller Reset occurs prior to a Conventional Reset, the controller shall continue operation with the currently executing firmware image. |\n| 10h | **Firmware Activation Requires NVM Subsystem Reset:** The firmware commit was successful; however, activation of the firmware image requires an NVM Subsystem Reset. If any other type of Controller Level Reset occurs prior to an NVM Subsystem Reset, the controller shall continue operation with the currently executing firmware image. |\n| 11h | **Firmware Activation Requires Controller Level Reset:** The firmware commit was successful; however, the firmware image specified does not support being activated without a Controller Level Reset. The firmware image shall be activated at the next Controller Level Reset. This status code should be returned only if the Commit Action field in the Firmware Commit command is set to 011b (i.e., activate immediately). |\n| 12h | **Firmware Activation Requires Maximum Time Violation:** The firmware commit was successful; however, the firmware image was not activated. Activation of the specified firmware image requires more time than the amount indicated in the Maximum Time for Firmware Activation (MTFA) field in the Identity Controller data structure (refer to Figure 328). To activate the firmware image committed to the specified firmware slot, a Firmware Commit command specifying a Commit Action set to 010b may be issued as described in section 3.11. |\n| 13h | **Firmware Activation Prohibited:** The image specified is being prohibited from activation by the controller for vendor specific reasons (e.g., controller does not support down revision firmware). |\n| 14h | **Overlapping Range:** This error is indicated if the controller detects that the firmware image has overlapping ranges. |\n| 1Eh | **Boot Partition Write Prohibited:** This error is indicated if a command attempts to modify a Boot Partition while write locked (refer to section 8.1.3.3). |\n| Value | Definition |\n| 1Fh | **Manufacturing Default Personality Required:** The command was aborted and each supported personality is required to be changed to the manufacturing default (refer to the Manufacturing Default Personality in section 8.1.6.1) for the firmware image to be committed. |"
      }
    ],
    "figures": []
  },
  "statistics": {
    "table_count": 2,
    "figure_count": 0
  }
}