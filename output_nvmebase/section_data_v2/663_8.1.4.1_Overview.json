{
  "section_index": 663,
  "section_id": "8.1.4.1",
  "title": "8.1.4.1 Overview",
  "level": 4,
  "pages": {
    "start": 555,
    "end": 556,
    "count": 2
  },
  "content": {
    "text": "Capacity Management is a capability for organizing physical media into Endurance Groups and NVM Sets.\nThere are two different forms of Capacity Management, Fixed Capacity Management and Variable Capacity\nManagement. A controller that supports Capacity Management shall support at least one form.\nCapacity Management commands shall not be supported by Exported NVM Subsystems.\nThe host uses Fixed Capacity Management to create Endurance Groups and NVM Sets by selecting a\nconfiguration which explicitly allocates Media Units (refer to section 8.1.4.2) to Endurance Groups and NVM\nSets.\nThe host uses Variable Capacity Management to:\n•\ncreate a single Endurance Group by specifying the desired capacity;\n•\ncreate a single NVM Set by specifying the desired capacity;\n•\ndelete a single Endurance Group; and\n•\ndelete a single NVM Set.\nThe Capacity Adjustment Factor is the ratio between the capacity consumed by an Endurance Group from\nthe Unallocated NVM Capacity field in the Identify Controller data structure and the total NVM capacity in\nthat Endurance Group, i.e.:\n(E.g., the value 200 indicates that creation of an Endurance Group with a total NVM capacity of 5 GiB\nconsumes 10 GiB of the Unallocated NVM Capacity indicated by the controller).\nIf an Endurance Group is created, then the controller performs the following actions as an atomic operation:\na) the value indicated by the Unallocated NVM Capacity (UNVMCAP) field of the Identify Controller\ndata structure is changed based on the requested capacity, the Capacity Adjustment Factor of the\ncreated Endurance Group, and the granularity at which the controller allocates NVM capacity; and\nb) the Endurance Group Identifier is added to the Endurance Group List.\nIf an Endurance Group is deleted, then the controller performs the following actions in sequence:\n1) the Endurance Group Identifier is removed from the Endurance Group List;\n2) if the Media Unit Status log page is supported, then the Endurance Group Identifier field is cleared\nto 0h in all Media Unit Status Descriptors, if any, that indicate the deleted Endurance Group;\n3) every NVM Set in the Endurance Group is deleted; and\n4) the value indicated by the Unallocated NVM Capacity (UNVMCAP) field of the Identify Controller\ndata structure is increased by the value that was indicated by the Total Endurance Group Capacity\n(TEGCAP) field of the Endurance Group Information log page of the deleted Endurance Group.\nIf any of the entities modified by the above sequence are accessed after the sequence begins and before\nit completes, then the results are indeterminate.\nIf an NVM Set is created, then the controller performs the following actions as an atomic operation:\na) the NVM Set Identifier is added to the NVM Set List; and\nb) the Unallocated Endurance Group Capacity indicated by the Endurance Group Information log\npage (refer to Figure 222) is decreased by the amount of capacity allocated to the NVM Set; the\ncontroller may allocate NVM capacity in units such that the requested size for an NVM Set may be\nrounded up to the next unit boundary.\nIf an NVM Set is deleted, then the following actions are performed in sequence:\n1) the NVM Set Identifier is removed from the NVM Set List;\n2) if the Media Unit Status log page is supported, then the NVM Set Identifier field is cleared to 0h in\nall Media Unit Status Descriptors, if any, that indicated the deleted NVM Set;\n3) for each namespace in the deleted NVM Set:\na. all commands targeting the namespace are handled as described for namespace deletion\nin section 8.1.16;\nb. the namespace identifier is removed from the Allocated Namespace ID list;\nc. the namespace is deleted;\nd. for each controller to which the namespace was attached when that namespace was\ndeleted:\ni. the namespace identifier is added to the Changed Attached Namespace List log\npage for that controller; and\nii. an Attached Namespace Attribute Changed asynchronous event is generated by\nthat controller as described in section 8.1.16.2;\ne. the namespace identifier is added to the Changed Allocated Namespace List log page for\neach controller in the NVM subsystem; and\nf.\nan Allocated Namespace Attribute Changed asynchronous event is generated for each\ncontroller that has Allocated Namespace Attribute Notices enabled as described in section\n8.1.16.2;\nand\n4) the Unallocated Endurance Group Capacity indicated by the Endurance Group Information log\npage is increased by the amount of capacity formerly allocated to the NVM Set.\nIf any of the entities modified by the above sequence are accessed after the sequence begins and before\nit completes, then the results are indeterminate.\nIf an NVM Set is created or deleted, the value indicated by the Unallocated NVM Capacity (UNVMCAP)\nfield of the Identify Controller data structure is not changed.",
    "tables": [],
    "figures": []
  },
  "statistics": {
    "table_count": 0,
    "figure_count": 0
  }
}